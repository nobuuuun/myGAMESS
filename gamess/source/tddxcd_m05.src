C 23 JUN 10 - FZ  - META-GGA FUNCTIONALS FOR TDDFT:
C                   REVTPSS, TPSS, TPSSH, TPSSM, PKZB, M05, M05-2X,
C                   VS98, M06-LX, M06-HF, M06, M06-2X, M08-HX, M08-SO
C
C*MODULE TDDXCD  *DECK TD_M05X
      SUBROUTINE TD_M05X(EX0,EX,DRHOI_,DTAUI_,
     *               XYZWGT,SCALE,RHOMIN,ILENG,NPTGRD,IRU,IST,IEND)
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
C
      COMMON /XDERIX/ NXDIM(3),KRA,KRB,KGA,KGB,KTA,KTB,KRARA,KRAGA,
     *                KRATA,KGAGA,KGATA,KTATA,KRBRB,KRBGB,KRBTB,KGBGB,
     *                KGBTB,KTBTB,KRARARA,KRARAGA,KRARATA,KRAGAGA,
     *                KRAGATA,KRATATA,KGAGAGA,KGAGATA,KGATATA,KTATATA,
     *                KRBRBRB,KRBRBGB,KRBRBTB,KRBGBGB,KRBGBTB,KRBTBTB,
     *                KGBGBGB,KGBGBTB,KGBTBTB,KTBTBTB
      DIMENSION DRHOI_(NPTGRD,4,IRU)
      DIMENSION DTAUI_(NPTGRD,IRU)
      DIMENSION EX0(*)
      DIMENSION EX(ILENG,*)
      DIMENSION XYZWGT(*)
      DATA ZERO/0.0D+0/
      DATA TWO /2.0D+0/
C
      EXF    = ZERO
C     EXF    = INITIALIZE THE ENERGY OF THE CORRELATION FUNCTION TO ZERO
C
      DO IPT=IST,IEND
         IIPT=IPT-IST+1
         RHOA=DRHOI_(IPT,1,1)
         RHOB=DRHOI_(IPT,1,IRU)
         TA=DTAUI_(IPT,1)
         TB=DTAUI_(IPT,IRU)
C             IN THE CLOSED SHELL CASE RHOB =RHOA SINCE IRU=1
C             IN THE OPENED SHELL CASE RHOB!=RHOA SINCE IRU=2
         RHOT=RHOA + RHOB
         IF(RHOT/TWO.GT.RHOMIN) THEN
           DXA = DRHOI_(IPT,2,1)
           DYA = DRHOI_(IPT,3,1)
           DZA = DRHOI_(IPT,4,1)
           DXB = DRHOI_(IPT,2,IRU)
           DYB = DRHOI_(IPT,3,IRU)
           DZB = DRHOI_(IPT,4,IRU)
           GRADA  = DXA**TWO + DYA**TWO + DZA**TWO
           GRADB  = DXB**TWO + DYB**TWO + DZB**TWO
C
      T1 = 1.2599210498948732D+0
      T2 = 6.299605249474366D-1
      T3 = 7.131826587600489D-3*T2*GRADA*RHOA**((-8.0D+0)/
     #3.0D+0)+1.0D+0
      T4 = 1.804D+0-8.04D-1/T3
      T5 = RHOA**(4.0D+0/3.0D+0)
      T6 = RHOA**(5.0D+0/3.0D+0)
      T7 = 1.0D+0/TA
      T8 = 4.557799872345597D+0*T6*T7
      T9 = T8-1.0D+0
      T10 = T9**11
      T11 = T8+1.0D+0
      T12 = 1.0D+0/T11**11
      T13 = T9**10
      T14 = 1.0D+0/T11**10
      T15 = T9**9
      T16 = 1.0D+0/T11**9
      T17 = T9**8
      T18 = 1.0D+0/T11**8
      T19 = T9**7
      T20 = 1.0D+0/T11**7
      T21 = T9**6
      T22 = 1.0D+0/T11**6
      T23 = T9**5
      T24 = 1.0D+0/T11**5
      T25 = T9**4
      T26 = 1.0D+0/T11**4
      T27 = T9**3
      T28 = 1.0D+0/T11**3
      T29 = T9**2
      T30 = 1.0D+0/T11**2
      T31 = 1.0D+0/T11
      T32 = 8.150999999999999D-2*T9*T31-4.3956D-1*T29*T30-
     #3.22422D+0*T27*T28+2.0181900000000003D+0*T25*T26+8.79431D+0*T23*
     #T24-2.95D-3*T21*T22+9.82029D+0*T19*T20-4.82351D+0*T17*T18-
     #4.8175739999999995D+1*T15*T16+3.6480199999999996D+0*T13*T14+
     #3.402248D+1*T10*T12+1.0D+0
      T33 = 7.131826587600489D-3*T2*GRADB*RHOB**((-8.0D+0)/
     #3.0D+0)+1.0D+0
      T34 = 1.804D+0-8.04D-1/T33
      T35 = RHOB**(4.0D+0/3.0D+0)
      T36 = RHOB**(5.0D+0/3.0D+0)
      T37 = 1.0D+0/TB
      T38 = 4.557799872345597D+0*T36*T37
      T39 = T38-1.0D+0
      T40 = T39**11
      T41 = T38+1.0D+0
      T42 = 1.0D+0/T41**11
      T43 = T39**10
      T44 = 1.0D+0/T41**10
      T45 = T39**9
      T46 = 1.0D+0/T41**9
      T47 = T39**8
      T48 = 1.0D+0/T41**8
      T49 = T39**7
      T50 = 1.0D+0/T41**7
      T51 = T39**6
      T52 = 1.0D+0/T41**6
      T53 = T39**5
      T54 = 1.0D+0/T41**5
      T55 = T39**4
      T56 = 1.0D+0/T41**4
      T57 = T39**3
      T58 = 1.0D+0/T41**3
      T59 = T39**2
      T60 = 1.0D+0/T41**2
      T61 = 1.0D+0/T41
      T62 = 8.150999999999999D-2*T39*T61-4.3956D-1*T59*T60-
     #3.22422D+0*T57*T58+2.0181900000000003D+0*T55*T56+8.79431D+0*T53*
     #T54-2.95D-3*T51*T52+9.82029D+0*T49*T50-4.82351D+0*T47*T48-
     #4.8175739999999995D+1*T45*T46+3.6480199999999996D+0*T43*T44+
     #3.402248D+1*T40*T42+1.0D+0
      T63 = 1.0D+0/T1
      T64 = 1.0D+0/T3**2
      T65 = RHOA**(7.0D+0/3.0D+0)
      T66 = 1.0D+0/T65
      T67 = RHOA**(1.0D+0/3.0D+0)
      T68 = RHOA**(2.0D+0/3.0D+0)
      T69 = 1.0D+0/T11**12
      T70 = 6.191771126581493D-1*T68*T31*T7-
     #7.297265485618918D+0*T68*T9*T30*T7-6.679865914910983D+1*T68*T29*
     #T28*T7+1.3480012168453165D+2*T68*T27*T26*T7+2.7269916746560224D+2*
     #T68*T25*T24*T7-3.3415699672429755D+2*T68*T23*T22*T7+
     #5.223218143608629D+2*T68*T21*T20*T7-8.153152694280648D+2*T68*T19*
     #T18*T7-3.0005028141688833D+3*T68*T17*T16*T7+3.570746475837556D+3*
     #T68*T15*T14*T7+2.565791256844242D+3*T68*T13*T12*T7-
     #2.8429070083494784D+3*T68*T10*T69*T7
      T71 = 1.0D+0/T33**2
      T72 = RHOB**(7.0D+0/3.0D+0)
      T73 = 1.0D+0/T72
      T74 = RHOB**(1.0D+0/3.0D+0)
      T75 = RHOB**(2.0D+0/3.0D+0)
      T76 = 1.0D+0/T41**12
      T77 = 6.191771126581493D-1*T75*T61*T37-
     #7.297265485618918D+0*T75*T39*T60*T37-6.679865914910983D+1*T75*T59*
     #T58*T37+1.3480012168453165D+2*T75*T57*T56*T37+
     #2.7269916746560224D+2*T75*T55*T54*T37-3.3415699672429755D+2*T75*
     #T53*T52*T37+5.223218143608629D+2*T75*T51*T50*T37-
     #8.153152694280648D+2*T75*T49*T48*T37-3.0005028141688833D+3*T75*
     #T47*T46*T37+3.570746475837556D+3*T75*T45*T44*T37+
     #2.565791256844242D+3*T75*T43*T42*T37-2.8429070083494784D+3*T75*
     #T40*T76*T37
      T78 = 1.0D+0/T5
      T79 = 1.0D+0/T35
      T80 = 1.0D+0/TA**2
      T81 = -3.715062675948896D-1*T6*T31*T80+
     #4.378359291371351D+0*T6*T9*T30*T80+4.007919548946589D+1*T6*T29*
     #T28*T80-8.0880073010719D+1*T6*T27*T26*T80-1.636195004793614D+2*T6*
     #T25*T24*T80+2.0049419803457855D+2*T6*T23*T22*T80-
     #3.1339308861651766D+2*T6*T21*T20*T80+4.891891616568388D+2*T6*T19*
     #T18*T80+1.8003016885013304D+3*T6*T17*T16*T80-
     #2.1424478855025336D+3*T6*T15*T14*T80-1.539474754106545D+3*T6*T13*
     #T12*T80+1.705744205009687D+3*T6*T10*T69*T80
      T82 = 1.0D+0/TB**2
      T83 = -3.715062675948896D-1*T36*T61*T82+
     #4.378359291371351D+0*T36*T39*T60*T82+4.007919548946589D+1*T36*T59*
     #T58*T82-8.0880073010719D+1*T36*T57*T56*T82-1.636195004793614D+2*
     #T36*T55*T54*T82+2.0049419803457855D+2*T36*T53*T52*T82-
     #3.1339308861651766D+2*T36*T51*T50*T82+4.891891616568388D+2*T36*
     #T49*T48*T82+1.8003016885013304D+3*T36*T47*T46*T82-
     #2.1424478855025336D+3*T36*T45*T44*T82-1.539474754106545D+3*T36*
     #T43*T42*T82+1.705744205009687D+3*T36*T40*T76*T82
      T84 = 1.0D+0/T3**3
      T85 = RHOA**(1.0D+1/3.0D+0)
      T86 = 1.0D+0/T11**13
      T87 = 1.0D+0/T67
      T88 = 1.0D+0/T33**3
      T89 = RHOB**(1.0D+1/3.0D+0)
      T90 = 1.0D+0/T41**13
      T91 = 1.0D+0/T74
      T92 = 1.0D+0/TA**3
      T93 = 1.0D+0/TB**3
      T94 = 1.0D+0/TA**4
      T95 = 1.0D+0/TB**4
      ENERGY = -7.385587663820223D-1*T1*T34*T35*T62-
     #7.385587663820223D-1*T1*T4*T5*T32
      DFDRA = -7.385587663820223D-1*T1*T4*T5*T70-
     #9.847450218426964D-1*T1*T4*T67*T32+1.1293033411886227D-2*T63*
     #GRADA*T64*T66*T32
      DFDRB = -7.385587663820223D-1*T1*T34*T35*T77-
     #9.847450218426964D-1*T1*T34*T74*T62+1.1293033411886227D-2*T63*
     #GRADB*T71*T73*T62
      DFDGA = -4.234887529457336D-3*T63*T64*T78*T32
      DFDGB = -4.234887529457336D-3*T63*T71*T79*T62
      DFDTA = -7.385587663820223D-1*T1*T4*T5*T81
      DFDTB = -7.385587663820223D-1*T1*T34*T35*T83
      D2FDRARA = 2.1477321584413564D-4*T32*T84*GRADA**2/RHOA**6-
     #1.1293033411886227D-2*T32*T63*T64*GRADA/T85-1.969490043685393D+0*
     #T1*T4*T67*T70+2.2586066823772455D-2*T63*GRADA*T64*T66*T70-
     #7.385587663820223D-1*T1*T4*T5*(4.1278474177209956D-1*T87*T31*T7-
     #4.8648436570792786D+0*T87*T9*T30*T7-4.4532439432739873D+1*T87*T29*
     #T28*T7+8.986674778968776D+1*T87*T27*T26*T7+1.8179944497706818D+2*
     #T87*T25*T24*T7-2.2277133114953168D+2*T87*T23*T22*T7+
     #3.482145429072419D+2*T87*T21*T20*T7-5.435435129520431D+2*T87*T19*
     #T18*T7-2.0003352094459226D+3*T87*T17*T16*T7+2.3804976505583708D+3*
     #T87*T15*T14*T7+1.710527504562828D+3*T87*T13*T12*T7-
     #1.8952713388996523D+3*T87*T10*T69*T7-6.013593510643077D+1*T5*T30*
     #T80-9.039848148128132D+2*T5*T9*T28*T80+4.5942344877429964D+3*T5*
     #T29*T26*T80+4.190108355050288D+3*T5*T27*T24*T80-
     #2.3049407897307198D+4*T5*T25*T22*T80+3.903659015830653D+4*T5*T23*
     #T20*T80-7.112795818027563D+4*T5*T21*T18*T80-1.3279530016627855D+5*
     #T5*T19*T16*T80+4.4925658762713666D+5*T5*T17*T14*T80-
     #7.633974614734613D+4*T5*T15*T12*T80-4.5194901148202293D+5*T5*T13*
     #T69*T80+2.591480239949131D+5*T5*T10*T86*T80)-
     #3.2824834061423214D-1*T1*T32*T4/T68
      D2FDRBRB = 2.1477321584413564D-4*T62*T88*GRADB**2/RHOB**6-
     #1.1293033411886227D-2*T62*T63*T71*GRADB/T89-1.969490043685393D+0*
     #T1*T34*T74*T77+2.2586066823772455D-2*T63*GRADB*T71*T73*T77-
     #3.2824834061423214D-1*T1*T34*T62/T75-7.385587663820223D-1*T1*T34*
     #T35*(4.1278474177209956D-1*T91*T61*T37-4.8648436570792786D+0*T91*
     #T39*T60*T37-4.4532439432739873D+1*T91*T59*T58*T37+
     #8.986674778968776D+1*T91*T57*T56*T37+1.8179944497706818D+2*T91*
     #T55*T54*T37-2.2277133114953168D+2*T91*T53*T52*T37+
     #3.482145429072419D+2*T91*T51*T50*T37-5.435435129520431D+2*T91*T49*
     #T48*T37-2.0003352094459226D+3*T91*T47*T46*T37+
     #2.3804976505583708D+3*T91*T45*T44*T37+1.710527504562828D+3*T91*
     #T43*T42*T37-1.8952713388996523D+3*T91*T40*T76*T37-
     #6.013593510643077D+1*T35*T60*T82-9.039848148128132D+2*T35*T39*T58*
     #T82+4.5942344877429964D+3*T35*T59*T56*T82+4.190108355050288D+3*
     #T35*T57*T54*T82-2.3049407897307198D+4*T35*T55*T52*T82+
     #3.903659015830653D+4*T35*T53*T50*T82-7.112795818027563D+4*T35*T51*
     #T48*T82-1.3279530016627855D+5*T35*T49*T46*T82+
     #4.4925658762713666D+5*T35*T47*T44*T82-7.633974614734613D+4*T35*
     #T45*T42*T82-4.5194901148202293D+5*T35*T43*T76*T82+
     #2.591480239949131D+5*T35*T40*T90*T82)
      D2FDRAGA = -8.053995594155088D-5*T32*T84*GRADA/RHOA**5-
     #4.234887529457336D-3*T63*T64*T78*T70+5.646516705943113D-3*T63*T64*
     #T66*T32
      D2FDRBGB = -8.053995594155088D-5*T62*T88*GRADB/RHOB**5-
     #4.234887529457336D-3*T63*T71*T79*T77+5.646516705943113D-3*T63*T71*
     #T73*T62
      D2FDGAGA = 3.020248347808158D-5*T32*T84/RHOA**4
      D2FDGBGB = 3.020248347808158D-5*T62*T88/RHOB**4
      D2FDRATA = -9.847450218426964D-1*T1*T4*T67*T81+
     #1.1293033411886227D-2*T63*GRADA*T64*T66*T81-7.385587663820223D-1*
     #T1*T4*T5*(-6.191771126581493D-1*T68*T31*T80+7.297265485618918D+0*
     #T68*T9*T30*T80+6.679865914910983D+1*T68*T29*T28*T80-
     #1.3480012168453165D+2*T68*T27*T26*T80-2.7269916746560224D+2*T68*
     #T25*T24*T80+3.3415699672429755D+2*T68*T23*T22*T80-
     #5.223218143608629D+2*T68*T21*T20*T80+8.153152694280648D+2*T68*T19*
     #T18*T80+3.0005028141688833D+3*T68*T17*T16*T80-
     #3.570746475837556D+3*T68*T15*T14*T80-2.565791256844242D+3*T68*T13*
     #T12*T80+2.8429070083494784D+3*T68*T10*T69*T80+
     #3.608156106385846D+1*T65*T30*T92+5.423908888876878D+2*T65*T9*T28*
     #T92-2.7565406926457975D+3*T65*T29*T26*T92-2.514065013030173D+3*
     #T65*T27*T24*T92+1.382964473838432D+4*T65*T25*T22*T92-
     #2.3421954094983916D+4*T65*T23*T20*T92+4.2676774908165377D+4*T65*
     #T21*T18*T92+7.967718009976714D+4*T65*T19*T16*T92-
     #2.69553952576282D+5*T65*T17*T14*T92+4.5803847688407695D+4*T65*T15*
     #T12*T92+2.711694068892137D+5*T65*T13*T69*T92-
     #1.5548881439694787D+5*T65*T10*T86*T92)
      D2FDRBTB = -9.847450218426964D-1*T1*T34*T74*T83+
     #1.1293033411886227D-2*T63*GRADB*T71*T73*T83-7.385587663820223D-1*
     #T1*T34*T35*(-6.191771126581493D-1*T75*T61*T82+
     #7.297265485618918D+0*T75*T39*T60*T82+6.679865914910983D+1*T75*T59*
     #T58*T82-1.3480012168453165D+2*T75*T57*T56*T82-
     #2.7269916746560224D+2*T75*T55*T54*T82+3.3415699672429755D+2*T75*
     #T53*T52*T82-5.223218143608629D+2*T75*T51*T50*T82+
     #8.153152694280648D+2*T75*T49*T48*T82+3.0005028141688833D+3*T75*
     #T47*T46*T82-3.570746475837556D+3*T75*T45*T44*T82-
     #2.565791256844242D+3*T75*T43*T42*T82+2.8429070083494784D+3*T75*
     #T40*T76*T82+3.608156106385846D+1*T72*T60*T93+5.423908888876878D+2*
     #T72*T39*T58*T93-2.7565406926457975D+3*T72*T59*T56*T93-
     #2.514065013030173D+3*T72*T57*T54*T93+1.382964473838432D+4*T72*T55*
     #T52*T93-2.3421954094983916D+4*T72*T53*T50*T93+
     #4.2676774908165377D+4*T72*T51*T48*T93+7.967718009976714D+4*T72*
     #T49*T46*T93-2.69553952576282D+5*T72*T47*T44*T93+
     #4.5803847688407695D+4*T72*T45*T42*T93+2.711694068892137D+5*T72*
     #T43*T76*T93-1.5548881439694787D+5*T72*T40*T90*T93)
      D2FDGATA = -4.234887529457336D-3*T63*T64*T78*T81
      D2FDGBTB = -4.234887529457336D-3*T63*T71*T79*T83
      D2FDTATA = -7.385587663820223D-1*T1*T4*T5*
     #(7.430125351897792D-1*T6*T31*T92-8.756718582742702D+0*T6*T9*T30*
     #T92-8.015839097893178D+1*T6*T29*T28*T92+1.61760146021438D+2*T6*
     #T27*T26*T92+3.272390009587228D+2*T6*T25*T24*T92-
     #4.009883960691571D+2*T6*T23*T22*T92+6.267861772330353D+2*T6*T21*
     #T20*T92-9.783783233136776D+2*T6*T19*T18*T92-3.600603377002661D+3*
     #T6*T17*T16*T92+4.284895771005067D+3*T6*T15*T14*T92+
     #3.07894950821309D+3*T6*T13*T12*T92-3.411488410019374D+3*T6*T10*
     #T69*T92-2.1648936638315072D+1*T85*T30*T94-3.254345333326127D+2*
     #T85*T9*T28*T94+1.6539244155874783D+3*T85*T29*T26*T94+
     #1.5084390078181042D+3*T85*T27*T24*T94-8.297786843030593D+3*T85*
     #T25*T22*T94+1.4053172456990348D+4*T85*T23*T20*T94-
     #2.560606494489922D+4*T85*T21*T18*T94-4.7806308059860286D+4*T85*
     #T19*T16*T94+1.6173237154576922D+5*T85*T17*T14*T94-
     #2.748230861304462D+4*T85*T15*T12*T94-1.6270164413352822D+5*T85*
     #T13*T69*T94+9.329328863816871D+4*T85*T10*T86*T94)
      D2FDTBTB = -7.385587663820223D-1*T1*T34*T35*
     #(7.430125351897792D-1*T36*T61*T93-8.756718582742702D+0*T36*T39*
     #T60*T93-8.015839097893178D+1*T36*T59*T58*T93+1.61760146021438D+2*
     #T36*T57*T56*T93+3.272390009587228D+2*T36*T55*T54*T93-
     #4.009883960691571D+2*T36*T53*T52*T93+6.267861772330353D+2*T36*T51*
     #T50*T93-9.783783233136776D+2*T36*T49*T48*T93-3.600603377002661D+3*
     #T36*T47*T46*T93+4.284895771005067D+3*T36*T45*T44*T93+
     #3.07894950821309D+3*T36*T43*T42*T93-3.411488410019374D+3*T36*T40*
     #T76*T93-2.1648936638315072D+1*T89*T60*T95-3.254345333326127D+2*
     #T89*T39*T58*T95+1.6539244155874783D+3*T89*T59*T56*T95+
     #1.5084390078181042D+3*T89*T57*T54*T95-8.297786843030593D+3*T89*
     #T55*T52*T95+1.4053172456990348D+4*T89*T53*T50*T95-
     #2.560606494489922D+4*T89*T51*T48*T95-4.7806308059860286D+4*T89*
     #T49*T46*T95+1.6173237154576922D+5*T89*T47*T44*T95-
     #2.748230861304462D+4*T89*T45*T42*T95-1.6270164413352822D+5*T89*
     #T43*T76*T95+9.329328863816871D+4*T89*T40*T90*T95)
C
C     FUNCTIONAL EXCHANGE ENERGY
C
C
C     SECOND FUNCTIONAL DERIVATIVE
C
C
C     STORE FUNCTIONAL EXCHANGE ENERGY
C
            EXF             = EXF             + SCALE*ENERGY*XYZWGT(IPT)
            EX0(IIPT)       = EX0(IIPT)       + SCALE*ENERGY
C
C     STORE FIRST FUNCTIONAL DERIVATIVE
C
            EX (IIPT,KRA)   = EX (IIPT,KRA)   + SCALE*DFDRA
            EX (IIPT,KRB)   = EX (IIPT,KRB)   + SCALE*DFDRB
            EX (IIPT,KGA)   = EX (IIPT,KGA)   + SCALE*DFDGA
            EX (IIPT,KGB)   = EX (IIPT,KGB)   + SCALE*DFDGB
            EX (IIPT,KTA)   = EX (IIPT,KTA)   + SCALE*DFDTA
            EX (IIPT,KTB)   = EX (IIPT,KTB)   + SCALE*DFDTB
C
C     STORE SECOND FUNCTIONAL DERIVATIVE
C
            EX (IIPT,KRARA) = EX (IIPT,KRARA) + SCALE*D2FDRARA
            EX (IIPT,KRAGA) = EX (IIPT,KRAGA) + SCALE*D2FDRAGA
            EX (IIPT,KRATA) = EX (IIPT,KRATA) + SCALE*D2FDRATA
            EX (IIPT,KRBRB) = EX (IIPT,KRBRB) + SCALE*D2FDRBRB
            EX (IIPT,KRBGB) = EX (IIPT,KRBGB) + SCALE*D2FDRBGB
            EX (IIPT,KRBTB) = EX (IIPT,KRBTB) + SCALE*D2FDRBTB
            EX (IIPT,KGAGA) = EX (IIPT,KGAGA) + SCALE*D2FDGAGA
            EX (IIPT,KGATA) = EX (IIPT,KGATA) + SCALE*D2FDGATA
            EX (IIPT,KGBGB) = EX (IIPT,KGBGB) + SCALE*D2FDGBGB
            EX (IIPT,KGBTB) = EX (IIPT,KGBTB) + SCALE*D2FDGBTB
            EX (IIPT,KTATA) = EX (IIPT,KTATA) + SCALE*D2FDTATA
            EX (IIPT,KTBTB) = EX (IIPT,KTBTB) + SCALE*D2FDTBTB
C
C     END OF CODE GENERATION
C
        END IF
      END DO
      RETURN
      END
C*MODULE TDDXCD  *DECK TD_M05C
      SUBROUTINE TD_M05C(EC0,EC,DRHOI_,DTAUI_,XYZWGT,SCALE,
     *                       RHOMIN,ILENG,NPTGRD,IRU,IST,IEND)
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
C
      COMMON /CDERIX/ NCDIM(3),IRA,IRB,IGA,IGB,IGC,ITA,ITB,IRARA,IRARB,
     *                IRAGA,IRAGB,IRAGC,IRATA,IRATB,IRBRB,IRBGA,IRBGB,
     *                IRBGC,IRBTA,IRBTB,IGAGA,IGAGB,IGAGC,IGATA,IGATB,
     *                IGBGB,IGBGC,IGBTA,IGBTB,IGCGC,IGCTA,IGCTB,ITATA,
     *                ITATB,ITBTB,IRARARA,IRARARB,IRARAGA,IRARAGB,
     *                IRARAGC,IRARATA,IRARATB,IRARBRB,IRARBGA,IRARBGB,
     *                IRARBGC,IRARBTA,IRARBTB,IRAGAGA,IRAGAGB,IRAGAGC,
     *                IRAGATA,IRAGATB,IRAGBGB,IRAGBGC,IRAGBTA,IRAGBTB,
     *                IRAGCGC,IRAGCTA,IRAGCTB,IRATATA,IRATATB,IRATBTB,
     *                IRBRBRB,IRBRBGA,IRBRBGB,IRBRBGC,IRBRBTA,IRBRBTB,
     *                IRBGAGA,IRBGAGB,IRBGAGC,IRBGATA,IRBGATB,IRBGBGB,
     *                IRBGBGC,IRBGBTA,IRBGBTB,IRBGCGC,IRBGCTA,IRBGCTB,
     *                IRBTATA,IRBTATB,IRBTBTB,IGAGAGA,IGAGAGB,IGAGAGC,
     *                IGAGATA,IGAGATB,IGAGBGB,IGAGBGC,IGAGBTA,IGAGBTB,
     *                IGAGCGC,IGAGCTA,IGAGCTB,IGATATA,IGATATB,IGATBTB,
     *                IGBGBGB,IGBGBGC,IGBGBTA,IGBGBTB,IGBGCGC,IGBGCTA,
     *                IGBGCTB,IGBTATA,IGBTATB,IGBTBTB,IGCGCGC,IGCGCTA,
     *                IGCGCTB,IGCTATA,IGCTATB,IGCTBTB,ITATATA,ITATATB,
     *                ITATBTB,ITBTBTB
C
      DIMENSION EC(ILENG,*)
      DIMENSION EC0(*)
      DIMENSION DRHOI_(NPTGRD,4,IRU)
      DIMENSION DTAUI_(NPTGRD,IRU)
      DIMENSION XYZWGT(*)
      DATA ZERO/0.0D+0/
      DATA TWO /2.0D+0/
C
      ECF=ZERO
      DO IPT=IST,IEND
         IIPT=IPT-IST+1
         RHOA=DRHOI_(IPT,1,1)
         RHOB=DRHOI_(IPT,1,IRU)
         TA=DTAUI_(IPT,1)
         TB=DTAUI_(IPT,IRU)
C             IN THE CLOSED SHELL CASE RHOB =RHOA SINCE IRU=1
C             IN THE OPENED SHELL CASE RHOB!=RHOA SINCE IRU=2
         RHOT=RHOA + RHOB
         IF(RHOT/TWO.GT.RHOMIN) THEN
           DXA = DRHOI_(IPT,2,1)
           DYA = DRHOI_(IPT,3,1)
           DZA = DRHOI_(IPT,4,1)
           DXB = DRHOI_(IPT,2,IRU)
           DYB = DRHOI_(IPT,3,IRU)
           DZB = DRHOI_(IPT,4,IRU)
           GRADA  = DXA**TWO + DYA**TWO + DZA**TWO
           GRADB  = DXB**TWO + DYB**TWO + DZB**TWO
C---       GRADAB = DXA*DXB+DYA*DYB+DZA*DZB
C
C     FUNCTIONAL ENERGY
C
      T1 = 1.0D+0*RHOA**((-8.0D+0)/3.0D+0)
      T2 = 1.0D+0*RHOB**((-8.0D+0)/3.0D+0)
      T3 = GRADB*T2+GRADA*T1
      T4 = T3**4
      T5 = 3.1D-3*T3+1.0D+0
      T6 = 1.0D+0/T5**4
      T7 = T3**3
      T8 = 1.0D+0/T5**3
      T9 = T3**2
      T10 = 1.0D+0/T5**2
      T11 = 1.0D+0/T5
      T12 = 1.1735639D-2*T3*T11-1.360065821D-4*T9*T10-
     #2.2241632899D-7*T7*T8+1.6572501228109998D-9*T4*T6+1.0D+0
      T13 = SQRT(RHOA)
      T14 = 1.0D+0*RHOA**((-1.0D+0)/3.0D+0)
      T15 = 1.1120374863094687D+1*RHOA**((-1.0D+0)/6.0D+0)+
     #2.4058712912881913D-1*RHOA**((-2.0D+0)/3.0D+0)+
     #3.8447462374472113D+0*T14+1.6447337755676092D+0/T13
      T16 = 3.216395899738507D+1/T15+1.0D+0
      T17 = LOG(T16)
      T18 = 1.274696188700087D-1*T14+1.0D+0
      T19 = SQRT(RHOB)
      T20 = 1.0D+0*RHOB**((-1.0D+0)/3.0D+0)
      T21 = 1.1120374863094687D+1*RHOB**((-1.0D+0)/6.0D+0)+
     #2.4058712912881913D-1*RHOB**((-2.0D+0)/3.0D+0)+
     #3.8447462374472113D+0*T20+1.6447337755676092D+0/T19
      T22 = 3.216395899738507D+1/T21+1.0D+0
      T23 = LOG(T22)
      T24 = 1.274696188700087D-1*T20+1.0D+0
      T25 = RHOB+RHOA
      T26 = 1.0D+0*T25**((-1.0D+0)/3.0D+0)
      T27 = 1.3256889990520176D-1*T26+1.0D+0
      T28 = 1.0D+0*T25**((-2.0D+0)/3.0D+0)
      T29 = SQRT(T25)
      T30 = 1.0D+0/T29
      T31 = 1.0D+0*T25**((-1.0D+0)/6.0D+0)
      T32 = 5.982550435771079D+0*T31+2.2255694211506874D+0*T26+
     #8.004286349993636D-1*T30+1.8970043257475583D-1*T28
      T33 = 1.6081979498692536D+1/T32+1.0D+0
      T34 = LOG(T33)
      T35 = -6.21814D-2*T27*T34
      T36 = 1.923661050931536D+0
      T37 = RHOA-1.0D+0*RHOB
      T38 = T37**4
      T39 = 1.0D+0/T25**4
      T40 = 1.0D+0-1.0D+0*T38*T39
      T41 = 6.901399211255825D-2*T26+1.0D+0
      T42 = 1.0D+0/T25
      T43 = 1.0D+0-1.0D+0*T37*T42
      T44 = T37*T42+1.0D+0
      T45 = T44**(4.0D+0/3.0D+0)+T43**(4.0D+0/3.0D+0)-2.0D+0
      T46 = 8.157414703487641D+0*T31+2.247591863577616D+0*T26+
     #4.3009724712766434D-1*T30+1.9115125951273373D-1*T28
      T47 = 2.9608749977793436D+1/T46+1.0D+0
      T48 = LOG(T47)
      T49 = 1.9751672738097256D-2*T36*T40*T41*T45*T48
      T50 = 1.274696188700087D-1*T26+1.0D+0
      T51 = 1.1120374863094687D+1*T31+3.8447462374472113D+0*T26+
     #1.6447337755676092D+0*T30+2.4058712912881913D-1*T28
      T52 = 3.216395899738507D+1/T51+1.0D+0
      T53 = LOG(T52)
      T54 = 6.21814D-2*T27*T34-3.10907D-2*T50*T53
      T55 = T36*T38*T39*T45*T54
      T56 = T25*(T55+T49+T35)+3.10907D-2*T23*T24*RHOB+
     #3.10907D-2*T17*T18*RHOA
      T57 = GRADA**4
      T58 = 6.0D-2*GRADA*T1+1.0D+0
      T59 = 1.0D+0/T58**4
      T60 = 1.0D+0*RHOA**((-3.2D+1)/3.0D+0)
      T61 = GRADA**3
      T62 = 1.0D+0/T58**3
      T63 = 1.0D+0/RHOA**8
      T64 = GRADA**2
      T65 = 1.0D+0/T58**2
      T66 = 1.0D+0*RHOA**((-1.6D+1)/3.0D+0)
      T67 = 1.0D+0/T58
      T68 = 2.2640639999999998D-1*GRADA*T67*T1-9.3760668D-2*T64*
     #T65*T66+6.631012079999999D-3*T61*T62*T63-1.19581272D-4*T57*T59*
     #T60+1.0D+0
      T69 = 1.0D+0/RHOA
      T70 = 1.0D+0/TA
      T71 = 1.0D+0-1.25D-1*T69*T70*GRADA
      T72 = GRADB**4
      T73 = 6.0D-2*GRADB*T2+1.0D+0
      T74 = 1.0D+0/T73**4
      T75 = 1.0D+0*RHOB**((-3.2D+1)/3.0D+0)
      T76 = GRADB**3
      T77 = 1.0D+0/T73**3
      T78 = 1.0D+0/RHOB**8
      T79 = GRADB**2
      T80 = 1.0D+0/T73**2
      T81 = 1.0D+0*RHOB**((-1.6D+1)/3.0D+0)
      T82 = 1.0D+0/T73
      T83 = 2.2640639999999998D-1*GRADB*T82*T2-9.3760668D-2*T79*
     #T80*T81+6.631012079999999D-3*T76*T77*T78-1.19581272D-4*T72*T74*
     #T75+1.0D+0
      T84 = 1.0D+0/RHOB
      T85 = 1.0D+0/TB
      T86 = 1.0D+0-1.25D-1*T84*T85*GRADB
      T87 = 1.0D+0/T16
      T88 = 1.0D+0*RHOA**((-4.0D+0)/3.0D+0)
      T89 = -1.8533958105157808D+0*RHOA**((-7.0D+0)/6.0D+0)-
     #1.6039141941921276D-1*RHOA**((-5.0D+0)/3.0D+0)-
     #1.2815820791490704D+0*T88-8.223668877838046D-1/T13**3
      T90 = 1.0D+0/T15**2
      T91 = 1.0D+0*T25**((-5.0D+0)/3.0D+0)
      T92 = 1.0D+0/T29**3
      T93 = 1.0D+0*T25**((-4.0D+0)/3.0D+0)
      T94 = 1.0D+0*T25**((-7.0D+0)/6.0D+0)
      T95 = -9.970917392951799D-1*T94-7.418564737168958D-1*T93-
     #4.002143174996818D-1*T92-1.264669550498372D-1*T91
      T96 = 1.0D+0/T32**2
      T97 = 1.0D+0/T33
      T98 = 1.0D+0*T95*T27*T96*T97
      T99 = -1.3595691172479402D+0*T94-7.491972878592053D-1*T93-
     #2.1504862356383217D-1*T92-1.2743417300848914D-1*T91
      T100 = 1.0D+0/T46**2
      T101 = 1.0D+0/T47
      T102 = -5.848223397455204D-1*T36*T40*T99*T41*T100*T45*T101
      T103 = 2.747773264188437D-3*T93*T34
      T104 = 1.0D+0/T25**2
      T105 = T37*T104
      T106 = -1.0D+0*T42
      T107 = T106+T105
      T108 = T43**(1.0D+0/3.0D+0)
      T109 = -1.0D+0*T104*T37
      T110 = T42+T109
      T111 = T44**(1.0D+0/3.0D+0)
      T112 = 1.3333333333333333D+0*T110*T111+
     #1.3333333333333333D+0*T107*T108
      T113 = 1.9751672738097256D-2*T36*T40*T41*T112*T48
      T114 = -4.543805955189586D-4*T36*T93*T40*T45*T48
      T115 = 1.0D+0/T25**5
      T116 = 4.0D+0*T115*T38
      T117 = T37**3
      T118 = T116-4.0D+0*T117*T39
      T119 = 1.9751672738097256D-2*T36*T118*T41*T45*T48
      T120 = -1.8533958105157808D+0*T94-1.2815820791490704D+0*
     #T93-8.223668877838046D-1*T92-1.6039141941921276D-1*T91
      T121 = 1.0D+0/T51**2
      T122 = 1.0D+0/T52
      T123 = 1.3210398931339262D-3*T93*T53-2.747773264188437D-3*
     #T93*T34+1.0D+0*T120*T50*T121*T122-1.0D+0*T95*T27*T96*T97
      T124 = T36*T38*T39*T45*T123
      T125 = T36*T38*T39*T112*T54
      T126 = -4.0D+0*T115*T36*T38*T45*T54
      T127 = -1.0D+0*T87*T89*T18*T90*RHOA+T25*(T98+4.0D+0*T117*
     #T36*T39*T45*T54+T126+T125+T124+T119+T114+T113+T103+T102)+T55+T49+
     #T35+3.10907D-2*T17*T18-1.3210398931339262D-3*T17*T14
      T128 = 1.0D+0*RHOA**((-1.1000000000000001D+1)/3.0D+0)
      T129 = 1.0D+0/T5**5
      T130 = -3.129503733333333D-2*GRADA*T128*T11+
     #8.223830536D-4*GRADA*T128*T3*T10-4.693115254666663D-7*GRADA*T128*
     #T9*T8-2.3193259602269334D-8*GRADA*T128*T7*T6+
     #5.479973739428372D-11*GRADA*T128*T4*T129
      T131 = GRADA**5
      T132 = 1.0D+0/T58**5
      T133 = 1.0D+0*RHOA**((-4.3D+1)/3.0D+0)
      T134 = 1.0D+0*RHOA**((-3.5D+1)/3.0D+0)
      T135 = 1.0D+0/RHOA**9
      T136 = 1.0D+0*RHOA**((-1.9D+1)/3.0D+0)
      T137 = -6.037503999999999D-1*GRADA*T67*T128+5.3628192D-1*
     #T64*T65*T136-8.305151040000001D-2*T61*T62*T135+
     #4.4584193663999994D-3*T57*T59*T134-7.653201407999999D-5*T131*T132*
     #T133
      T138 = 1.0D+0/T22
      T139 = 1.0D+0*RHOB**((-4.0D+0)/3.0D+0)
      T140 = -1.8533958105157808D+0*RHOB**((-7.0D+0)/6.0D+0)-
     #1.6039141941921276D-1*RHOB**((-5.0D+0)/3.0D+0)-
     #8.223668877838046D-1/T19**3-1.2815820791490704D+0*T139
      T141 = 1.0D+0/T21**2
      T142 = T42+T105
      T143 = T106+T109
      T144 = 1.3333333333333333D+0*T111*T143+
     #1.3333333333333333D+0*T108*T142
      T145 = 1.9751672738097256D-2*T36*T40*T41*T144*T48
      T146 = 4.0D+0*T117*T39+T116
      T147 = 1.9751672738097256D-2*T36*T146*T41*T45*T48
      T148 = T36*T38*T39*T144*T54
      T149 = -1.0D+0*T138*T140*T24*T141*RHOB+T25*(T98-4.0D+0*
     #T117*T36*T39*T45*T54+T148+T147+T145+T126+T124+T114+T103+T102)+T55+
     #T49+T35+3.10907D-2*T23*T24-1.3210398931339262D-3*T23*T20
      T150 = 1.0D+0*RHOB**((-1.1000000000000001D+1)/3.0D+0)
      T151 = -3.129503733333333D-2*GRADB*T11*T150+
     #8.223830536D-4*GRADB*T3*T10*T150-4.693115254666663D-7*GRADB*T9*T8*
     #T150-2.3193259602269334D-8*GRADB*T7*T6*T150+5.479973739428372D-11*
     #GRADB*T4*T129*T150
      T152 = GRADB**5
      T153 = 1.0D+0/T73**5
      T154 = 1.0D+0*RHOB**((-4.3D+1)/3.0D+0)
      T155 = 1.0D+0*RHOB**((-3.5D+1)/3.0D+0)
      T156 = 1.0D+0/RHOB**9
      T157 = 1.0D+0*RHOB**((-1.9D+1)/3.0D+0)
      T158 = -6.037503999999999D-1*GRADB*T82*T150+5.3628192D-1*
     #T79*T80*T157-8.305151040000001D-2*T76*T77*T156+
     #4.4584193663999994D-3*T72*T74*T155-7.653201407999999D-5*T152*T153*
     #T154
      T159 = 1.1735639D-2*T1*T11-3.083936451D-4*T1*T3*T10+
     #1.7599182205000002D-7*T1*T9*T8+8.697472350851D-9*T1*T7*T6-
     #2.05499015228564D-11*T1*T4*T129
      T160 = 1.0D+0*RHOA**((-4.0D+1)/3.0D+0)
      T161 = 2.2640639999999998D-1*T67*T1-2.0110572000000002D-1*
     #GRADA*T65*T66+3.11443164D-2*T64*T62*T63-1.6719072624D-3*T61*T59*
     #T60+2.869950528D-5*T57*T132*T160
      T162 = 1.1735639D-2*T11*T2-3.083936451D-4*T3*T10*T2+
     #1.7599182205000002D-7*T9*T8*T2+8.697472350851D-9*T7*T6*T2-
     #2.05499015228564D-11*T4*T129*T2
      T163 = 1.0D+0*RHOB**((-4.0D+1)/3.0D+0)
      T164 = 2.2640639999999998D-1*T82*T2-2.0110572000000002D-1*
     #GRADB*T80*T81+3.11443164D-2*T79*T77*T78-1.6719072624D-3*T76*T74*
     #T75+2.869950528D-5*T72*T153*T163
      T165 = 1.0D+0/TA**2
      T166 = 1.0D+0/TB**2
      T167 = 1.0D+0/T16**2
      T168 = T89**2
      T169 = 1.0D+0/T15**4
      T170 = 1.0D+0/T15**3
      T171 = 1.0D+0*RHOA**((-7.0D+0)/3.0D+0)
      T172 = 2.1622951122684114D+0*RHOA**((-1.3D+1)/6.0D+0)+
     #1.7087761055320938D+0*T171+1.2335503316757071D+0/T13**5+
     #2.673190323653546D-1*T1
      T173 = 2.0D+0*T95*T27*T96*T97
      T174 = -1.1696446794910409D+0*T36*T40*T99*T41*T100*T45*
     #T101
      T175 = 5.495546528376875D-3*T93*T34
      T176 = -9.087611910379172D-4*T36*T93*T40*T45*T48
      T177 = 2.0D+0*T123*T36*T38*T39*T45
      T178 = -8.0D+0*T115*T36*T38*T45*T54
      T179 = T95**2
      T180 = 1.0D+0/T32**4
      T181 = 1.0D+0/T33**2
      T182 = 1.6081979498692536D+1*T179*T27*T180*T181
      T183 = 1.0D+0/T32**3
      T184 = -2.0D+0*T179*T27*T183*T97
      T185 = -8.837926660346784D-2*T93*T95*T96*T97
      T186 = 1.0D+0*T25**((-8.0D+0)/3.0D+0)
      T187 = 1.0D+0/T29**5
      T188 = 1.0D+0*T25**((-7.0D+0)/3.0D+0)
      T189 = 1.0D+0*T25**((-1.3D+1)/6.0D+0)
      T190 = 1.1632736958443765D+0*T189+9.89141964955861D-1*
     #T188+6.003214762495227D-1*T187+2.1077825841639536D-1*T186
      T191 = 1.0D+0*T190*T27*T96*T97
      T192 = T99**2
      T193 = -1.7315858438953285D+1*T192*T36*T40*T41*T45/(T46**
     #4*T47**2)
      T194 = 1.1696446794910409D+0*T101*T192*T36*T40*T41*T45/
     #T46**3
      T195 = 2.690728289496347D-2*T36*T93*T40*T99*T100*T45*T101
      T196 = -5.848223397455204D-1*T36*T40*
     #(1.5861639701225969D+0*T189+9.98929717145607D-1*T188+
     #3.2257293534574827D-1*T187+2.1239028834748191D-1*T186)*T41*T100*
     #T45*T101
      T197 = -3.663697685584583D-3*T188*T34
      T198 = 1.0D+0*T43**((-2.0D+0)/3.0D+0)
      T199 = 1.0D+0/T25**3
      T200 = -2.0D+0*T199*T37
      T201 = 2.0D+0*T104
      T202 = 1.0D+0*T44**((-2.0D+0)/3.0D+0)
      T203 = 2.0D+0*T199*T37
      T204 = -2.0D+0*T104
      T205 = 1.3333333333333333D+0*T111*(T204+T203)+
     #4.444444444444444D-1*T110**2*T202+1.3333333333333333D+0*T108*
     #(T201+T200)+4.444444444444444D-1*T107**2*T198
      T206 = 6.058407940252781D-4*T36*T188*T40*T45*T48
      T207 = 1.0D+0/T25**6
      T208 = -2.0D+1*T207*T38
      T209 = T37**2
      T210 = -1.2D+1*T209*T39
      T211 = T120**2
      T212 = T36*T38*T39*T45*(8.837926660346784D-2*T93*T95*T96*
     #T97-1.0D+0*T190*T27*T96*T97+2.0D+0*T179*T27*T183*T97-
     #1.7613865241785684D-3*T188*T53+3.216395899738507D+1*T211*T50/(T51*
     #*4*T52**2)-2.0D+0*T122*T211*T50/T51**3+3.663697685584583D-3*T188*
     #T34-1.6081979498692536D+1*T179*T27*T180*T181+1.0D+0*
     #(2.1622951122684114D+0*T189+1.7087761055320938D+0*T188+
     #1.2335503316757071D+0*T187+2.673190323653546D-1*T186)*T50*T121*
     #T122-8.497974591333913D-2*T93*T120*T121*T122)
      T213 = -8.0D+0*T115*T123*T36*T38*T45
      T214 = 2.0D+1*T207*T36*T38*T45*T54
      T215 = 1.2D+1*T209*T36*T39*T45*T54
      T216 = 1.0D+0*RHOA**((-2.2000000000000003D+1)/3.0D+0)
      T217 = 1.0D+0/T5**6
      T218 = 1.0D+0*RHOA**((-1.3999999999999999D+1)/3.0D+0)
      T219 = -3.10907D-2*T17*T137*T18*T71
      T220 = 1.0D+0/T58**6
      T221 = 2.6666666666666666D+0*T111*T199*T37-
     #2.6666666666666666D+0*T108*T199*T37+4.444444444444444D-1*T110*
     #T143*T202+4.444444444444444D-1*T107*T142*T198
      T222 = 1.0D+0/T22**2
      T223 = T140**2
      T224 = 1.0D+0/T21**4
      T225 = 1.0D+0/T21**3
      T226 = 1.0D+0*RHOB**((-7.0D+0)/3.0D+0)
      T227 = 2.1622951122684114D+0*RHOB**((-1.3D+1)/6.0D+0)+
     #1.7087761055320938D+0*T226+2.673190323653546D-1*T2+
     #1.2335503316757071D+0/T19**5
      T228 = 1.3333333333333333D+0*T108*(T204+T200)+
     #4.444444444444444D-1*T143**2*T202+1.3333333333333333D+0*T111*
     #(T201+T203)+4.444444444444444D-1*T142**2*T198
      T229 = 1.0D+0*RHOB**((-2.2000000000000003D+1)/3.0D+0)
      T230 = 1.0D+0*RHOB**((-1.3999999999999999D+1)/3.0D+0)
      T231 = -3.10907D-2*T23*T158*T24*T86
      T232 = 1.0D+0/T73**6
      ENERGY = -3.10907D-2*T23*T83*T24*RHOB*T86-3.10907D-2*T17*
     #T68*T18*RHOA*T71+T12*T56
      DFDRA = 1.0D+0*T87*T68*T89*T18*T90*RHOA*T71-3.10907D-2*
     #T17*T137*T18*RHOA*T71+1.3210398931339262D-3*T17*T68*T14*T71-
     #3.10907D-2*T17*T68*T18*T71-3.8863375D-3*GRADA*T17*T68*T18*T69*T70+
     #T130*T56+T12*T127
      DFDRB = 1.0D+0*T138*T83*T140*T24*T141*RHOB*T86-3.10907D-2*
     #T23*T158*T24*RHOB*T86+1.3210398931339262D-3*T23*T83*T20*T86-
     #3.10907D-2*T23*T83*T24*T86-3.8863375D-3*GRADB*T23*T83*T24*T84*T85+
     #T151*T56+T12*T149
      DFDGA = -3.10907D-2*T17*T161*T18*RHOA*T71+3.8863375D-3*
     #T17*T68*T18*T70+T159*T56
      DFDGC = 0.0D+0
      DFDGB = -3.10907D-2*T23*T164*T24*RHOB*T86+3.8863375D-3*
     #T23*T83*T24*T85+T162*T56
      DFDTA = -3.8863375D-3*GRADA*T17*T68*T18*T165
      DFDTB = -3.8863375D-3*GRADB*T23*T83*T24*T166
      D2FDRARA = T12*(-1.0D+0*T87*T172*T18*T90*RHOA+2.0D+0*T87*
     #T168*T18*T170*RHOA-3.216395899738507D+1*T167*T168*T18*T169*RHOA-
     #2.0D+0*T87*T89*T18*T90-8.806932620892842D-4*T17*T88+T25*(-3.2D+1*
     #T115*T117*T36*T45*T54+8.0D+0*T112*T117*T36*T39*T54-8.0D+0*T112*
     #T115*T36*T38*T54+T36*T38*T39*T205*T54+1.9751672738097256D-2*(T210+
     #T208+3.2D+1*T115*T117)*T36*T41*T45*T48-9.087611910379172D-4*T36*
     #T93*T118*T45*T48+1.9751672738097256D-2*T36*T40*T41*T205*T48+
     #3.950334547619451D-2*T36*T118*T41*T112*T48-9.087611910379172D-4*
     #T36*T93*T40*T112*T48+8.0D+0*T117*T123*T36*T39*T45+2.0D+0*T112*
     #T123*T36*T38*T39+T215+T214+T213+T212+T206+T197+T196+T195+T194+
     #T193+T191+T185+T184+T182-1.1696446794910409D+0*T36*T118*T99*T41*
     #T100*T45*T101-1.1696446794910409D+0*T36*T40*T99*T41*T100*T112*
     #T101)+8.0D+0*T117*T36*T39*T45*T54+2.0D+0*T112*T36*T38*T39*T54+
     #3.950334547619451D-2*T36*T118*T41*T45*T48+3.950334547619451D-2*
     #T36*T40*T41*T112*T48+T178+T177+T176+T175+T174+T173+
     #8.497974591333913D-2*T87*T89*T90*T14)-3.10907D-2*T17*T18*T71*
     #(9.19073808D-1*T61*T62/RHOA**10-9.187961759999999D-2*T57*T59*RHOA*
     #*((-3.8D+1)/3.0D+0)+3.9503472629759995D-3*T131*T132*RHOA**
     #((-4.5999999999999996D+1)/3.0D+0)-6.122561126399997D-5*T220*GRADA*
     #*6/RHOA**18+2.2137514666666663D+0*GRADA*T67*T218-
     #3.4930522239999995D+0*T64*T65*T216)*RHOA+2.0D+0*T87*T137*T89*T18*
     #T90*RHOA*T71+1.0D+0*T87*T68*T172*T18*T90*RHOA*T71-2.0D+0*T87*T68*
     #T168*T18*T170*RHOA*T71+3.216395899738507D+1*T167*T68*T168*T18*
     #T169*RHOA*T71+2.0D+0*T87*T68*T89*T18*T90*T71+8.806932620892842D-4*
     #T17*T68*T88*T71-8.497974591333913D-2*T87*T68*T89*T90*T14*T71+
     #2.6420797862678524D-3*T17*T137*T14*T71+2.5D-1*GRADA*T87*T68*T89*
     #T18*T90*T69*T70-7.772675D-3*GRADA*T17*T137*T18*T69*T70+
     #3.302599732834816D-4*GRADA*T17*T68*T171*T70+(1.147484702222222D-1*
     #GRADA*T218*T11-3.0154045298666665D-3*GRADA*T218*T3*T10-
     #2.4517271182222217D-3*T64*T216*T10+1.7208089267111099D-6*GRADA*
     #T218*T9*T8+1.6099727955342216D-5*T64*T216*T3*T8+
     #8.504195187498754D-8*GRADA*T218*T7*T6+1.7390715098658133D-7*T64*
     #T216*T9*T6-2.0093237044570697D-10*GRADA*T218*T4*T129-
     #1.3514543163873988D-9*T64*T216*T7*T129+2.2650558122970602D-12*T64*
     #T216*T4*T217)*T56+2*T219+2.0D+0*T127*T130
      D2FDRARB = (-2.4517271182222217D-3*GRADA*GRADB*T128*T10*
     #T150+1.6099727955342216D-5*GRADA*GRADB*T128*T3*T8*T150+
     #1.7390715098658133D-7*GRADA*GRADB*T128*T9*T6*T150-
     #1.3514543163873988D-9*GRADA*GRADB*T128*T7*T129*T150+
     #2.2650558122970602D-12*GRADA*GRADB*T128*T4*T217*T150)*T56+T12*
     #(T25*(-1.2D+1*T209*T36*T39*T45*T54+4.0D+0*T117*T144*T36*T39*T54-
     #4.0D+0*T112*T117*T36*T39*T54-4.0D+0*T115*T144*T36*T38*T54-4.0D+0*
     #T112*T115*T36*T38*T54+T36*T38*T39*T221*T54+1.9751672738097256D-2*
     #T36*(1.2D+1*T209*T39+T208)*T41*T45*T48-4.543805955189586D-4*T36*
     #T93*T146*T45*T48-4.543805955189586D-4*T36*T93*T118*T45*T48+
     #1.9751672738097256D-2*T36*T40*T41*T221*T48+1.9751672738097256D-2*
     #T36*T118*T41*T144*T48-4.543805955189586D-4*T36*T93*T40*T144*T48+
     #1.9751672738097256D-2*T36*T146*T41*T112*T48-4.543805955189586D-4*
     #T36*T93*T40*T112*T48+T214+T213+T212+T206+T197+T196+T195+T194+T193+
     #T191+T185+T184+T182+T36*T38*T39*T144*T123+T36*T38*T39*T112*T123-
     #5.848223397455204D-1*T36*T146*T99*T41*T100*T45*T101-
     #5.848223397455204D-1*T36*T118*T99*T41*T100*T45*T101-
     #5.848223397455204D-1*T36*T40*T99*T41*T100*T144*T101-
     #5.848223397455204D-1*T36*T40*T99*T41*T100*T112*T101)+T178+T177+
     #T176+T175+T174+T173+T148+T147+T145+T125+T119+T113)+T130*T149+T151*
     #T127
      D2FDRBRB = T12*(2.0D+0*T138*T223*T24*T225*RHOB-
     #3.216395899738507D+1*T222*T223*T24*T224*RHOB-1.0D+0*T138*T227*T24*
     #T141*RHOB+T25*(3.2D+1*T115*T117*T36*T45*T54-8.0D+0*T117*T144*T36*
     #T39*T54-8.0D+0*T115*T144*T36*T38*T54+T36*T38*T39*T228*T54+
     #1.9751672738097256D-2*(T210+T208-3.2D+1*T115*T117)*T36*T41*T45*
     #T48-9.087611910379172D-4*T36*T93*T146*T45*T48+
     #1.9751672738097256D-2*T36*T40*T41*T228*T48+3.950334547619451D-2*
     #T36*T146*T41*T144*T48-9.087611910379172D-4*T36*T93*T40*T144*T48-
     #8.0D+0*T117*T123*T36*T39*T45+2.0D+0*T123*T144*T36*T38*T39+T215+
     #T214+T213+T212+T206+T197+T196+T195+T194+T193+T191+T185+T184+T182-
     #1.1696446794910409D+0*T36*T146*T99*T41*T100*T45*T101-
     #1.1696446794910409D+0*T36*T40*T99*T41*T100*T144*T101)-8.0D+0*T117*
     #T36*T39*T45*T54+2.0D+0*T144*T36*T38*T39*T54+3.950334547619451D-2*
     #T36*T146*T41*T45*T48+3.950334547619451D-2*T36*T40*T41*T144*T48+
     #8.497974591333913D-2*T138*T140*T141*T20+T178+T177+T176+T175+T174+
     #T173-2.0D+0*T138*T140*T24*T141-8.806932620892842D-4*T23*T139)-
     #3.10907D-2*T23*T24*T86*(9.19073808D-1*T76*T77/RHOB**10-
     #9.187961759999999D-2*T72*T74*RHOB**((-3.8D+1)/3.0D+0)+
     #3.9503472629759995D-3*T152*T153*RHOB**((-4.5999999999999996D+1)/
     #3.0D+0)-6.122561126399997D-5*T232*GRADB**6/RHOB**18+
     #2.2137514666666663D+0*GRADB*T82*T230-3.4930522239999995D+0*T79*
     #T80*T229)*RHOB-2.0D+0*T138*T83*T223*T24*T225*RHOB*T86+
     #3.216395899738507D+1*T222*T83*T223*T24*T224*RHOB*T86+1.0D+0*T138*
     #T83*T227*T24*T141*RHOB*T86+2.0D+0*T138*T158*T140*T24*T141*RHOB*
     #T86+2.6420797862678524D-3*T23*T158*T20*T86-8.497974591333913D-2*
     #T138*T83*T140*T141*T20*T86+2.0D+0*T138*T83*T140*T24*T141*T86+
     #8.806932620892842D-4*T23*T83*T139*T86-7.772675D-3*GRADB*T23*T158*
     #T24*T84*T85+2.5D-1*GRADB*T138*T83*T140*T24*T141*T84*T85+
     #3.302599732834816D-4*GRADB*T23*T83*T226*T85+(1.147484702222222D-1*
     #GRADB*T11*T230-3.0154045298666665D-3*GRADB*T3*T10*T230+
     #1.7208089267111099D-6*GRADB*T9*T8*T230+8.504195187498754D-8*GRADB*
     #T7*T6*T230-2.0093237044570697D-10*GRADB*T4*T129*T230-
     #2.4517271182222217D-3*T79*T10*T229+1.6099727955342216D-5*T79*T3*
     #T8*T229+1.7390715098658133D-7*T79*T9*T6*T229-
     #1.3514543163873988D-9*T79*T7*T129*T229+2.2650558122970602D-12*T79*
     #T4*T217*T229)*T56+2*T231+2.0D+0*T149*T151
      D2FDRAGA = -3.10907D-2*T17*T18*T71*(2.2959604223999994D-5*
     #T131*T220/RHOA**17+1.1087888639999999D+0*GRADA*T65*T136-
     #3.135083616D-1*T64*T62*T135+3.278294933759999D-2*T61*T59*T134-
     #1.452680718336D-3*T57*T132*T133-6.037503999999999D-1*T67*T128)*
     #RHOA+1.0D+0*T87*T161*T89*T18*T90*RHOA*T71-3.10907D-2*T17*T161*T18*
     #T71+1.3210398931339262D-3*T17*T161*T14*T71-1.25D-1*T87*T68*T89*
     #T18*T90*T70-1.651299866417408D-4*T17*T68*T88*T70-3.8863375D-3*
     #GRADA*T17*T161*T18*T69*T70+3.8863375D-3*T17*T137*T18*T70+
     #(-3.129503733333333D-2*T128*T11+8.223830536D-4*T128*T3*T10+
     #9.193976693333333D-4*GRADA*T136*T10-4.693115254666663D-7*T128*T9*
     #T8-6.037397983253332D-6*GRADA*T136*T3*T8-2.3193259602269334D-8*
     #T128*T7*T6-6.521518161996799D-8*GRADA*T136*T9*T6+
     #5.479973739428372D-11*T128*T4*T129+5.067953686452746D-10*GRADA*
     #T136*T7*T129-8.493959296113976D-13*GRADA*T136*T4*T217)*T56+T159*
     #T127
      D2FDRAGC = 0.0D+0
      D2FDRAGB = (9.193976693333333D-4*GRADA*T128*T10*T2-
     #6.037397983253332D-6*GRADA*T128*T3*T8*T2-6.521518161996799D-8*
     #GRADA*T128*T9*T6*T2+5.067953686452746D-10*GRADA*T128*T7*T129*T2-
     #8.493959296113976D-13*GRADA*T128*T4*T217*T2)*T56+T162*T127
      D2FDRBGA = (9.193976693333333D-4*GRADB*T1*T10*T150-
     #6.037397983253332D-6*GRADB*T1*T3*T8*T150-6.521518161996799D-8*
     #GRADB*T1*T9*T6*T150+5.067953686452746D-10*GRADB*T1*T7*T129*T150-
     #8.493959296113976D-13*GRADB*T1*T4*T217*T150)*T56+T159*T149
      D2FDRBGC = 0.0D+0
      D2FDRBGB = -3.10907D-2*T23*T24*T86*(2.2959604223999994D-5*
     #T152*T232/RHOB**17+1.1087888639999999D+0*GRADB*T80*T157-
     #3.135083616D-1*T79*T77*T156+3.278294933759999D-2*T76*T74*T155-
     #1.452680718336D-3*T72*T153*T154-6.037503999999999D-1*T82*T150)*
     #RHOB+1.0D+0*T138*T164*T140*T24*T141*RHOB*T86-3.10907D-2*T23*T164*
     #T24*T86+1.3210398931339262D-3*T23*T164*T20*T86-3.8863375D-3*GRADB*
     #T23*T164*T24*T84*T85+3.8863375D-3*T23*T158*T24*T85-1.25D-1*T138*
     #T83*T140*T24*T141*T85-1.651299866417408D-4*T23*T83*T139*T85+
     #(-3.129503733333333D-2*T11*T150+8.223830536D-4*T3*T10*T150-
     #4.693115254666663D-7*T9*T8*T150-2.3193259602269334D-8*T7*T6*T150+
     #5.479973739428372D-11*T4*T129*T150+9.193976693333333D-4*GRADB*T10*
     #T157-6.037397983253332D-6*GRADB*T3*T8*T157-6.521518161996799D-8*
     #GRADB*T9*T6*T157+5.067953686452746D-10*GRADB*T7*T129*T157-
     #8.493959296113976D-13*GRADB*T4*T217*T157)*T56+T162*T149
      D2FDGAGA = -3.10907D-2*T17*T18*T71*(-8.609851583999999D-6*
     #T220*T57/RHOA**16-2.1469010400000002D-1*T65*T66+
     #8.642131920000001D-2*GRADA*T62*T63-1.06216987392D-2*T64*T59*T60+
     #5.16055764096D-4*T61*T132*T160)*RHOA+7.772675D-3*T17*T161*T18*T70+
     #(-3.4477412599999996D-4*T66*T10+2.26402424372D-6*T66*T3*T8+
     #2.4455693107487997D-8*T66*T9*T6-1.90048263241978D-10*T66*T7*T129+
     #3.185234736042742D-13*T66*T4*T217)*T56
      D2FDGAGC = 0.0D+0
      D2FDGAGB = (-3.4477412599999996D-4*T1*T10*T2+
     #2.26402424372D-6*T1*T3*T8*T2+2.4455693107487997D-8*T1*T9*T6*T2-
     #1.90048263241978D-10*T1*T7*T129*T2+3.185234736042742D-13*T1*T4*
     #T217*T2)*T56
      D2FDGCGC = 0.0D+0
      D2FDGBGC = 0.0D+0
      D2FDGBGB = -3.10907D-2*T23*T24*T86*(-8.609851583999999D-6*
     #T232*T72/RHOB**16-2.1469010400000002D-1*T80*T81+
     #8.642131920000001D-2*GRADB*T77*T78-1.06216987392D-2*T79*T74*T75+
     #5.16055764096D-4*T76*T153*T163)*RHOB+7.772675D-3*T23*T164*T24*T85+
     #(-3.4477412599999996D-4*T10*T81+2.26402424372D-6*T3*T8*T81+
     #2.4455693107487997D-8*T9*T6*T81-1.90048263241978D-10*T7*T129*T81+
     #3.185234736042742D-13*T4*T217*T81)*T56
      D2FDRATA = -3.8863375D-3*GRADA*T17*T137*T18*T165+
     #1.651299866417408D-4*GRADA*T17*T68*T88*T165+1.25D-1*GRADA*T87*T68*
     #T89*T18*T90*T165
      D2FDRBTA = 0.0D+0
      D2FDRATB = 0.0D+0
      D2FDRBTB = -3.8863375D-3*GRADB*T23*T158*T24*T166+
     #1.651299866417408D-4*GRADB*T23*T83*T139*T166+1.25D-1*GRADB*T138*
     #T83*T140*T24*T141*T166
      D2FDGATA = -3.8863375D-3*T17*T68*T18*T165-3.8863375D-3*
     #GRADA*T17*T161*T18*T165
      D2FDGCTA = 0.0D+0
      D2FDGBTA = 0.0D+0
      D2FDGATB = 0.0D+0
      D2FDGCTB = 0.0D+0
      D2FDGBTB = -3.8863375D-3*T23*T83*T24*T166-3.8863375D-3*
     #GRADB*T23*T164*T24*T166
      D2FDTATA = 7.772675D-3*T17*T18*T68*GRADA/TA**3
      D2FDTATB = 0.0D+0
      D2FDTBTB = 7.772675D-3*T23*T24*T83*GRADB/TB**3
C
C     STORE FUNCTIONAL ENERGY
C
            ECF             = ECF             + SCALE*ENERGY*XYZWGT(IPT)
            EC0(IIPT)       = EC0(IIPT)       + SCALE*ENERGY
C
C     STORE FIRST FUNCTIONAL DERIVATIVE
C
            EC (IIPT,IRA)   = EC (IIPT,IRA)   + SCALE*DFDRA
            EC (IIPT,IRB)   = EC (IIPT,IRB)   + SCALE*DFDRB
            EC (IIPT,IGA)   = EC (IIPT,IGA)   + SCALE*DFDGA
            EC (IIPT,IGB)   = EC (IIPT,IGB)   + SCALE*DFDGB
            EC (IIPT,IGC)   = EC (IIPT,IGC)   + SCALE*DFDGC
            EC (IIPT,ITA)   = EC (IIPT,ITA)   + SCALE*DFDTA
            EC (IIPT,ITB)   = EC (IIPT,ITB)   + SCALE*DFDTB
C
C     STORE SECOND FUNCTIONAL DERIVATIVE
C
            EC (IIPT,IRARA) = EC (IIPT,IRARA) + SCALE*D2FDRARA
            EC (IIPT,IRARB) = EC (IIPT,IRARB) + SCALE*D2FDRARB
            EC (IIPT,IRAGA) = EC (IIPT,IRAGA) + SCALE*D2FDRAGA
            EC (IIPT,IRAGB) = EC (IIPT,IRAGB) + SCALE*D2FDRAGB
            EC (IIPT,IRAGC) = EC (IIPT,IRAGC) + SCALE*D2FDRAGC
            EC (IIPT,IRATA) = EC (IIPT,IRATA) + SCALE*D2FDRATA
            EC (IIPT,IRATB) = EC (IIPT,IRATB) + SCALE*D2FDRATB
            EC (IIPT,IRBRB) = EC (IIPT,IRBRB) + SCALE*D2FDRBRB
            EC (IIPT,IRBGA) = EC (IIPT,IRBGA) + SCALE*D2FDRBGA
            EC (IIPT,IRBGB) = EC (IIPT,IRBGB) + SCALE*D2FDRBGB
            EC (IIPT,IRBGC) = EC (IIPT,IRBGC) + SCALE*D2FDRBGC
            EC (IIPT,IRBTA) = EC (IIPT,IRBTA) + SCALE*D2FDRBTA
            EC (IIPT,IRBTB) = EC (IIPT,IRBTB) + SCALE*D2FDRBTB
            EC (IIPT,IGAGA) = EC (IIPT,IGAGA) + SCALE*D2FDGAGA
            EC (IIPT,IGAGB) = EC (IIPT,IGAGB) + SCALE*D2FDGAGB
            EC (IIPT,IGAGC) = EC (IIPT,IGAGC) + SCALE*D2FDGAGC
            EC (IIPT,IGATA) = EC (IIPT,IGATA) + SCALE*D2FDGATA
            EC (IIPT,IGATB) = EC (IIPT,IGATB) + SCALE*D2FDGATB
            EC (IIPT,IGBGB) = EC (IIPT,IGBGB) + SCALE*D2FDGBGB
            EC (IIPT,IGBGC) = EC (IIPT,IGBGC) + SCALE*D2FDGBGC
            EC (IIPT,IGBTA) = EC (IIPT,IGBTA) + SCALE*D2FDGBTA
            EC (IIPT,IGBTB) = EC (IIPT,IGBTB) + SCALE*D2FDGBTB
            EC (IIPT,IGCGC) = EC (IIPT,IGCGC) + SCALE*D2FDGCGC
            EC (IIPT,IGCTA) = EC (IIPT,IGCTA) + SCALE*D2FDGCTA
            EC (IIPT,IGCTB) = EC (IIPT,IGCTB) + SCALE*D2FDGCTB
            EC (IIPT,ITATA) = EC (IIPT,ITATA) + SCALE*D2FDTATA
            EC (IIPT,ITATB) = EC (IIPT,ITATB) + SCALE*D2FDTATB
            EC (IIPT,ITBTB) = EC (IIPT,ITBTB) + SCALE*D2FDTBTB
C
C     END OF CODE GENERATION
C
        END IF
      END DO
      RETURN
      END
C*MODULE TDDXCD  *DECK TD_M05_2XX
      SUBROUTINE TD_M05_2XX(EX0,EX,DRHOI_,DTAUI_,
     *               XYZWGT,SCALE,RHOMIN,ILENG,NPTGRD,IRU,IST,IEND)
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
C
      COMMON /XDERIX/ NXDIM(3),KRA,KRB,KGA,KGB,KTA,KTB,KRARA,KRAGA,
     *                KRATA,KGAGA,KGATA,KTATA,KRBRB,KRBGB,KRBTB,KGBGB,
     *                KGBTB,KTBTB,KRARARA,KRARAGA,KRARATA,KRAGAGA,
     *                KRAGATA,KRATATA,KGAGAGA,KGAGATA,KGATATA,KTATATA,
     *                KRBRBRB,KRBRBGB,KRBRBTB,KRBGBGB,KRBGBTB,KRBTBTB,
     *                KGBGBGB,KGBGBTB,KGBTBTB,KTBTBTB
      DIMENSION DRHOI_(NPTGRD,4,IRU)
      DIMENSION DTAUI_(NPTGRD,IRU)
      DIMENSION EX0(*)
      DIMENSION EX(ILENG,*)
      DIMENSION XYZWGT(*)
      DATA ZERO/0.0D+0/
      DATA TWO /2.0D+0/
C
      EXF    = ZERO
C     EXF    = INITIALIZE THE ENERGY OF THE CORRELATION FUNCTION TO ZERO
C
      DO IPT=IST,IEND
         IIPT=IPT-IST+1
         RHOA=DRHOI_(IPT,1,1)
         RHOB=DRHOI_(IPT,1,IRU)
         TA=DTAUI_(IPT,1)
         TB=DTAUI_(IPT,IRU)
C             IN THE CLOSED SHELL CASE RHOB =RHOA SINCE IRU=1
C             IN THE OPENED SHELL CASE RHOB!=RHOA SINCE IRU=2
         RHOT=RHOA + RHOB
         IF(RHOT/TWO.GT.RHOMIN) THEN
           DXA = DRHOI_(IPT,2,1)
           DYA = DRHOI_(IPT,3,1)
           DZA = DRHOI_(IPT,4,1)
           DXB = DRHOI_(IPT,2,IRU)
           DYB = DRHOI_(IPT,3,IRU)
           DZB = DRHOI_(IPT,4,IRU)
           GRADA  = DXA**TWO + DYA**TWO + DZA**TWO
           GRADB  = DXB**TWO + DYB**TWO + DZB**TWO
C
      T1 = 1.2599210498948732D+0
      T2 = 6.299605249474366D-1
      T3 = 7.131826587600489D-3*T2*GRADA*RHOA**((-8.0D+0)/
     #3.0D+0)+1.0D+0
      T4 = 1.804D+0-8.04D-1/T3
      T5 = RHOA**(4.0D+0/3.0D+0)
      T6 = RHOA**(5.0D+0/3.0D+0)
      T7 = 1.0D+0/TA
      T8 = 4.557799872345597D+0*T6*T7
      T9 = T8-1.0D+0
      T10 = T9**11
      T11 = T8+1.0D+0
      T12 = 1.0D+0/T11**11
      T13 = T9**10
      T14 = 1.0D+0/T11**10
      T15 = T9**9
      T16 = 1.0D+0/T11**9
      T17 = T9**8
      T18 = 1.0D+0/T11**8
      T19 = T9**7
      T20 = 1.0D+0/T11**7
      T21 = T9**6
      T22 = 1.0D+0/T11**6
      T23 = T9**5
      T24 = 1.0D+0/T11**5
      T25 = T9**4
      T26 = 1.0D+0/T11**4
      T27 = T9**3
      T28 = 1.0D+0/T11**3
      T29 = T9**2
      T30 = 1.0D+0/T11**2
      T31 = 1.0D+0/T11
      T32 = -5.6833D-1*T9*T31-1.30057D+0*T29*T30+
     #5.500700000000001D+0*T27*T28+9.064019999999999D+0*T25*T26-
     #3.221075D+1*T23*T24-2.373298D+1*T21*T22+7.022996D+1*T19*T20+
     #2.988614D+1*T17*T18-6.025777999999999D+1*T15*T16-1.322205D+1*T13*
     #T14+1.5236940000000002D+1*T10*T12+1.0D+0
      T33 = 7.131826587600489D-3*T2*GRADB*RHOB**((-8.0D+0)/
     #3.0D+0)+1.0D+0
      T34 = 1.804D+0-8.04D-1/T33
      T35 = RHOB**(4.0D+0/3.0D+0)
      T36 = RHOB**(5.0D+0/3.0D+0)
      T37 = 1.0D+0/TB
      T38 = 4.557799872345597D+0*T36*T37
      T39 = T38-1.0D+0
      T40 = T39**11
      T41 = T38+1.0D+0
      T42 = 1.0D+0/T41**11
      T43 = T39**10
      T44 = 1.0D+0/T41**10
      T45 = T39**9
      T46 = 1.0D+0/T41**9
      T47 = T39**8
      T48 = 1.0D+0/T41**8
      T49 = T39**7
      T50 = 1.0D+0/T41**7
      T51 = T39**6
      T52 = 1.0D+0/T41**6
      T53 = T39**5
      T54 = 1.0D+0/T41**5
      T55 = T39**4
      T56 = 1.0D+0/T41**4
      T57 = T39**3
      T58 = 1.0D+0/T41**3
      T59 = T39**2
      T60 = 1.0D+0/T41**2
      T61 = 1.0D+0/T41
      T62 = -5.6833D-1*T39*T61-1.30057D+0*T59*T60+
     #5.500700000000001D+0*T57*T58+9.064019999999999D+0*T55*T56-
     #3.221075D+1*T53*T54-2.373298D+1*T51*T52+7.022996D+1*T49*T50+
     #2.988614D+1*T47*T48-6.025777999999999D+1*T45*T46-1.322205D+1*T43*
     #T44+1.5236940000000002D+1*T40*T42+1.0D+0
      T63 = 1.0D+0/T1
      T64 = 1.0D+0/T3**2
      T65 = RHOA**(7.0D+0/3.0D+0)
      T66 = 1.0D+0/T65
      T67 = RHOA**(1.0D+0/3.0D+0)
      T68 = RHOA**(2.0D+0/3.0D+0)
      T69 = 1.0D+0/T11**12
      T70 = -4.317224002416955D+0*T68*T31*T7-
     #1.5441901930838087D+1*T68*T9*T30*T7+1.4511457472231218D+2*T68*T29*
     #T28*T7+1.5005781253719577D+2*T68*T27*T26*T7-1.498831196644219D+3*
     #T68*T25*T24*T7+1.4171620317415978D+2*T68*T23*T22*T7+
     #4.816132930576898D+3*T68*T21*T20*T7-1.918230597407723D+3*T68*T19*
     #T18*T7-5.935844130902803D+3*T68*T17*T16*T7+3.1152525665083175D+3*
     #T68*T15*T14*T7+2.2775845551296398D+3*T68*T13*T12*T7-
     #1.2731935917605214D+3*T68*T10*T69*T7
      T71 = 1.0D+0/T33**2
      T72 = RHOB**(7.0D+0/3.0D+0)
      T73 = 1.0D+0/T72
      T74 = RHOB**(1.0D+0/3.0D+0)
      T75 = RHOB**(2.0D+0/3.0D+0)
      T76 = 1.0D+0/T41**12
      T77 = -4.317224002416955D+0*T75*T61*T37-
     #1.5441901930838087D+1*T75*T39*T60*T37+1.4511457472231218D+2*T75*
     #T59*T58*T37+1.5005781253719577D+2*T75*T57*T56*T37-
     #1.498831196644219D+3*T75*T55*T54*T37+1.4171620317415978D+2*T75*
     #T53*T52*T37+4.816132930576898D+3*T75*T51*T50*T37-
     #1.918230597407723D+3*T75*T49*T48*T37-5.935844130902803D+3*T75*T47*
     #T46*T37+3.1152525665083175D+3*T75*T45*T44*T37+
     #2.2775845551296398D+3*T75*T43*T42*T37-1.2731935917605214D+3*T75*
     #T40*T76*T37
      T78 = 1.0D+0/T5
      T79 = 1.0D+0/T35
      T80 = 1.0D+0/TA**2
      T81 = 2.590334401450173D+0*T6*T31*T80+
     #9.265141158502853D+0*T6*T9*T30*T80-8.706874483338729D+1*T6*T29*
     #T28*T80-9.003468752231746D+1*T6*T27*T26*T80+8.992987179865314D+2*
     #T6*T25*T24*T80-8.502972190449611D+1*T6*T23*T22*T80-
     #2.8896797583461387D+3*T6*T21*T20*T80+1.1509383584446335D+3*T6*T19*
     #T18*T80+3.561506478541682D+3*T6*T17*T16*T80-1.8691515399049902D+3*
     #T6*T15*T14*T80-1.3665507330777837D+3*T6*T13*T12*T80+
     #7.639161550563127D+2*T6*T10*T69*T80
      T82 = 1.0D+0/TB**2
      T83 = 2.590334401450173D+0*T36*T61*T82+
     #9.265141158502853D+0*T36*T39*T60*T82-8.706874483338729D+1*T36*T59*
     #T58*T82-9.003468752231746D+1*T36*T57*T56*T82+8.992987179865314D+2*
     #T36*T55*T54*T82-8.502972190449611D+1*T36*T53*T52*T82-
     #2.8896797583461387D+3*T36*T51*T50*T82+1.1509383584446335D+3*T36*
     #T49*T48*T82+3.561506478541682D+3*T36*T47*T46*T82-
     #1.8691515399049902D+3*T36*T45*T44*T82-1.3665507330777837D+3*T36*
     #T43*T42*T82+7.639161550563127D+2*T36*T40*T76*T82
      T84 = 1.0D+0/T3**3
      T85 = RHOA**(1.0D+1/3.0D+0)
      T86 = 1.0D+0/T11**13
      T87 = 1.0D+0/T67
      T88 = 1.0D+0/T33**3
      T89 = RHOB**(1.0D+1/3.0D+0)
      T90 = 1.0D+0/T41**13
      T91 = 1.0D+0/T74
      T92 = 1.0D+0/TA**3
      T93 = 1.0D+0/TB**3
      T94 = 1.0D+0/TA**4
      T95 = 1.0D+0/TB**4
      ENERGY = -7.385587663820223D-1*T1*T34*T35*T62-
     #7.385587663820223D-1*T1*T4*T5*T32
      DFDRA = -7.385587663820223D-1*T1*T4*T5*T70-
     #9.847450218426964D-1*T1*T4*T67*T32+1.1293033411886227D-2*T63*
     #GRADA*T64*T66*T32
      DFDRB = -7.385587663820223D-1*T1*T34*T35*T77-
     #9.847450218426964D-1*T1*T34*T74*T62+1.1293033411886227D-2*T63*
     #GRADB*T71*T73*T62
      DFDGA = -4.234887529457336D-3*T63*T64*T78*T32
      DFDGB = -4.234887529457336D-3*T63*T71*T79*T62
      DFDTA = -7.385587663820223D-1*T1*T4*T5*T81
      DFDTB = -7.385587663820223D-1*T1*T34*T35*T83
      D2FDRARA = 2.1477321584413564D-4*T32*T84*GRADA**2/RHOA**6-
     #1.1293033411886227D-2*T32*T63*T64*GRADA/T85-1.969490043685393D+0*
     #T1*T4*T67*T70+2.2586066823772455D-2*T63*GRADA*T64*T66*T70-
     #7.385587663820223D-1*T1*T4*T5*(-2.8781493349446363D+0*T87*T31*T7-
     #1.0294601287225391D+1*T87*T9*T30*T7+9.674304981487478D+1*T87*T29*
     #T28*T7+1.0003854169146384D+2*T87*T27*T26*T7-9.992207977628125D+2*
     #T87*T25*T24*T7+9.447746878277318D+1*T87*T23*T22*T7+
     #3.2107552870512646D+3*T87*T21*T20*T7-1.2788203982718155D+3*T87*
     #T19*T18*T7-3.9572294206018693D+3*T87*T17*T16*T7+
     #2.0768350443388778D+3*T87*T15*T14*T7+1.5183897034197597D+3*T87*
     #T13*T12*T7-8.487957278403475D+2*T87*T10*T69*T7-
     #8.45067594034062D+1*T5*T30*T80+2.439280962646624D+3*T5*T9*T28*T80+
     #1.1265144340825146D+2*T5*T29*T26*T80-5.010204077039406D+4*T5*T27*
     #T24*T80+6.231072274557589D+4*T5*T25*T22*T80+2.1305055963446323D+5*
     #T5*T23*T20*T80-3.580952809954001D+5*T5*T21*T18*T80-
     #2.441530460013043D+5*T5*T19*T16*T80+6.187963105807209D+5*T5*T17*
     #T14*T80-6.363205258882881D+4*T5*T15*T12*T80-2.967018300514311D+5*
     #T5*T13*T69*T80+1.1605923179994673D+5*T5*T10*T86*T80)-
     #3.2824834061423214D-1*T1*T32*T4/T68
      D2FDRBRB = 2.1477321584413564D-4*T62*T88*GRADB**2/RHOB**6-
     #1.1293033411886227D-2*T62*T63*T71*GRADB/T89-1.969490043685393D+0*
     #T1*T34*T74*T77+2.2586066823772455D-2*T63*GRADB*T71*T73*T77-
     #3.2824834061423214D-1*T1*T34*T62/T75-7.385587663820223D-1*T1*T34*
     #T35*(-2.8781493349446363D+0*T91*T61*T37-1.0294601287225391D+1*T91*
     #T39*T60*T37+9.674304981487478D+1*T91*T59*T58*T37+
     #1.0003854169146384D+2*T91*T57*T56*T37-9.992207977628125D+2*T91*
     #T55*T54*T37+9.447746878277318D+1*T91*T53*T52*T37+
     #3.2107552870512646D+3*T91*T51*T50*T37-1.2788203982718155D+3*T91*
     #T49*T48*T37-3.9572294206018693D+3*T91*T47*T46*T37+
     #2.0768350443388778D+3*T91*T45*T44*T37+1.5183897034197597D+3*T91*
     #T43*T42*T37-8.487957278403475D+2*T91*T40*T76*T37-
     #8.45067594034062D+1*T35*T60*T82+2.439280962646624D+3*T35*T39*T58*
     #T82+1.1265144340825146D+2*T35*T59*T56*T82-5.010204077039406D+4*
     #T35*T57*T54*T82+6.231072274557589D+4*T35*T55*T52*T82+
     #2.1305055963446323D+5*T35*T53*T50*T82-3.580952809954001D+5*T35*
     #T51*T48*T82-2.441530460013043D+5*T35*T49*T46*T82+
     #6.187963105807209D+5*T35*T47*T44*T82-6.363205258882881D+4*T35*T45*
     #T42*T82-2.967018300514311D+5*T35*T43*T76*T82+
     #1.1605923179994673D+5*T35*T40*T90*T82)
      D2FDRAGA = -8.053995594155088D-5*T32*T84*GRADA/RHOA**5-
     #4.234887529457336D-3*T63*T64*T78*T70+5.646516705943113D-3*T63*T64*
     #T66*T32
      D2FDRBGB = -8.053995594155088D-5*T62*T88*GRADB/RHOB**5-
     #4.234887529457336D-3*T63*T71*T79*T77+5.646516705943113D-3*T63*T71*
     #T73*T62
      D2FDGAGA = 3.020248347808158D-5*T32*T84/RHOA**4
      D2FDGBGB = 3.020248347808158D-5*T62*T88/RHOB**4
      D2FDRATA = -9.847450218426964D-1*T1*T4*T67*T81+
     #1.1293033411886227D-2*T63*GRADA*T64*T66*T81-7.385587663820223D-1*
     #T1*T4*T5*(4.317224002416955D+0*T68*T31*T80+1.5441901930838087D+1*
     #T68*T9*T30*T80-1.4511457472231218D+2*T68*T29*T28*T80-
     #1.5005781253719577D+2*T68*T27*T26*T80+1.498831196644219D+3*T68*
     #T25*T24*T80-1.4171620317415978D+2*T68*T23*T22*T80-
     #4.816132930576898D+3*T68*T21*T20*T80+1.918230597407723D+3*T68*T19*
     #T18*T80+5.935844130902803D+3*T68*T17*T16*T80-
     #3.1152525665083175D+3*T68*T15*T14*T80-2.2775845551296398D+3*T68*
     #T13*T12*T80+1.2731935917605214D+3*T68*T10*T69*T80+
     #5.070405564204372D+1*T65*T30*T92-1.4635685775879742D+3*T65*T9*T28*
     #T92-6.759086604495133D+1*T65*T29*T26*T92+3.0061224462236436D+4*
     #T65*T27*T24*T92-3.7386433647345535D+4*T65*T25*T22*T92-
     #1.278303357806779D+5*T65*T23*T20*T92+2.1485716859724002D+5*T65*
     #T21*T18*T92+1.4649182760078255D+5*T65*T19*T16*T92-
     #3.7127778634843256D+5*T65*T17*T14*T92+3.817923155329727D+4*T65*
     #T15*T12*T92+1.780210980308586D+5*T65*T13*T69*T92-
     #6.963553907996801D+4*T65*T10*T86*T92)
      D2FDRBTB = -9.847450218426964D-1*T1*T34*T74*T83+
     #1.1293033411886227D-2*T63*GRADB*T71*T73*T83-7.385587663820223D-1*
     #T1*T34*T35*(4.317224002416955D+0*T75*T61*T82+
     #1.5441901930838087D+1*T75*T39*T60*T82-1.4511457472231218D+2*T75*
     #T59*T58*T82-1.5005781253719577D+2*T75*T57*T56*T82+
     #1.498831196644219D+3*T75*T55*T54*T82-1.4171620317415978D+2*T75*
     #T53*T52*T82-4.816132930576898D+3*T75*T51*T50*T82+
     #1.918230597407723D+3*T75*T49*T48*T82+5.935844130902803D+3*T75*T47*
     #T46*T82-3.1152525665083175D+3*T75*T45*T44*T82-
     #2.2775845551296398D+3*T75*T43*T42*T82+1.2731935917605214D+3*T75*
     #T40*T76*T82+5.070405564204372D+1*T72*T60*T93-
     #1.4635685775879742D+3*T72*T39*T58*T93-6.759086604495133D+1*T72*
     #T59*T56*T93+3.0061224462236436D+4*T72*T57*T54*T93-
     #3.7386433647345535D+4*T72*T55*T52*T93-1.278303357806779D+5*T72*
     #T53*T50*T93+2.1485716859724002D+5*T72*T51*T48*T93+
     #1.4649182760078255D+5*T72*T49*T46*T93-3.7127778634843256D+5*T72*
     #T47*T44*T93+3.817923155329727D+4*T72*T45*T42*T93+
     #1.780210980308586D+5*T72*T43*T76*T93-6.963553907996801D+4*T72*T40*
     #T90*T93)
      D2FDGATA = -4.234887529457336D-3*T63*T64*T78*T81
      D2FDGBTB = -4.234887529457336D-3*T63*T71*T79*T83
      D2FDTATA = -7.385587663820223D-1*T1*T4*T5*
     #(-5.180668802900346D+0*T6*T31*T92-1.8530282317005706D+1*T6*T9*T30*
     #T92+1.741374896667746D+2*T6*T29*T28*T92+1.800693750446349D+2*T6*
     #T27*T26*T92-1.7985974359730628D+3*T6*T25*T24*T92+
     #1.7005944380899224D+2*T6*T23*T22*T92+5.779359516692277D+3*T6*T21*
     #T20*T92-2.301876716889267D+3*T6*T19*T18*T92-7.123012957083364D+3*
     #T6*T17*T16*T92+3.7383030798099803D+3*T6*T15*T14*T92+
     #2.7331014661555675D+3*T6*T13*T12*T92-1.5278323101126254D+3*T6*T10*
     #T69*T92-3.0422433385226233D+1*T85*T30*T94+8.781411465527842D+2*
     #T85*T9*T28*T94+4.0554519626970886D+1*T85*T29*T26*T94-
     #1.8036734677341865D+4*T85*T27*T24*T94+2.2431860188407327D+4*T85*
     #T25*T22*T94+7.669820146840673D+4*T85*T23*T20*T94-
     #1.28914301158344D+5*T85*T21*T18*T94-8.789509656046957D+4*T85*T19*
     #T16*T94+2.2276667180905957D+5*T85*T17*T14*T94-
     #2.2907538931978372D+4*T85*T15*T12*T94-1.0681265881851516D+5*T85*
     #T13*T69*T94+4.178132344798081D+4*T85*T10*T86*T94)
      D2FDTBTB = -7.385587663820223D-1*T1*T34*T35*
     #(-5.180668802900346D+0*T36*T61*T93-1.8530282317005706D+1*T36*T39*
     #T60*T93+1.741374896667746D+2*T36*T59*T58*T93+1.800693750446349D+2*
     #T36*T57*T56*T93-1.7985974359730628D+3*T36*T55*T54*T93+
     #1.7005944380899224D+2*T36*T53*T52*T93+5.779359516692277D+3*T36*
     #T51*T50*T93-2.301876716889267D+3*T36*T49*T48*T93-
     #7.123012957083364D+3*T36*T47*T46*T93+3.7383030798099803D+3*T36*
     #T45*T44*T93+2.7331014661555675D+3*T36*T43*T42*T93-
     #1.5278323101126254D+3*T36*T40*T76*T93-3.0422433385226233D+1*T89*
     #T60*T95+8.781411465527842D+2*T89*T39*T58*T95+
     #4.0554519626970886D+1*T89*T59*T56*T95-1.8036734677341865D+4*T89*
     #T57*T54*T95+2.2431860188407327D+4*T89*T55*T52*T95+
     #7.669820146840673D+4*T89*T53*T50*T95-1.28914301158344D+5*T89*T51*
     #T48*T95-8.789509656046957D+4*T89*T49*T46*T95+
     #2.2276667180905957D+5*T89*T47*T44*T95-2.2907538931978372D+4*T89*
     #T45*T42*T95-1.0681265881851516D+5*T89*T43*T76*T95+
     #4.178132344798081D+4*T89*T40*T90*T95)
C
C     FUNCTIONAL EXCHANGE ENERGY
C
C
C     SECOND FUNCTIONAL DERIVATIVE
C
C
C     STORE FUNCTIONAL EXCHANGE ENERGY
C
            EXF             = EXF             + SCALE*ENERGY*XYZWGT(IPT)
            EX0(IIPT)       = EX0(IIPT)       + SCALE*ENERGY
C
C     STORE FIRST FUNCTIONAL DERIVATIVE
C
            EX (IIPT,KRA)   = EX (IIPT,KRA)   + SCALE*DFDRA
            EX (IIPT,KRB)   = EX (IIPT,KRB)   + SCALE*DFDRB
            EX (IIPT,KGA)   = EX (IIPT,KGA)   + SCALE*DFDGA
            EX (IIPT,KGB)   = EX (IIPT,KGB)   + SCALE*DFDGB
            EX (IIPT,KTA)   = EX (IIPT,KTA)   + SCALE*DFDTA
            EX (IIPT,KTB)   = EX (IIPT,KTB)   + SCALE*DFDTB
C
C     STORE SECOND FUNCTIONAL DERIVATIVE
C
            EX (IIPT,KRARA) = EX (IIPT,KRARA) + SCALE*D2FDRARA
            EX (IIPT,KRAGA) = EX (IIPT,KRAGA) + SCALE*D2FDRAGA
            EX (IIPT,KRATA) = EX (IIPT,KRATA) + SCALE*D2FDRATA
            EX (IIPT,KRBRB) = EX (IIPT,KRBRB) + SCALE*D2FDRBRB
            EX (IIPT,KRBGB) = EX (IIPT,KRBGB) + SCALE*D2FDRBGB
            EX (IIPT,KRBTB) = EX (IIPT,KRBTB) + SCALE*D2FDRBTB
            EX (IIPT,KGAGA) = EX (IIPT,KGAGA) + SCALE*D2FDGAGA
            EX (IIPT,KGATA) = EX (IIPT,KGATA) + SCALE*D2FDGATA
            EX (IIPT,KGBGB) = EX (IIPT,KGBGB) + SCALE*D2FDGBGB
            EX (IIPT,KGBTB) = EX (IIPT,KGBTB) + SCALE*D2FDGBTB
            EX (IIPT,KTATA) = EX (IIPT,KTATA) + SCALE*D2FDTATA
            EX (IIPT,KTBTB) = EX (IIPT,KTBTB) + SCALE*D2FDTBTB
C
C     END OF CODE GENERATION
C
        END IF
      END DO
      RETURN
      END
C*MODULE TDDXCD  *DECK TD_M05_2XC
      SUBROUTINE TD_M05_2XC(EC0,EC,DRHOI_,DTAUI_,XYZWGT,SCALE,
     *                       RHOMIN,ILENG,NPTGRD,IRU,IST,IEND)
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
C
      COMMON /CDERIX/ NCDIM(3),IRA,IRB,IGA,IGB,IGC,ITA,ITB,IRARA,IRARB,
     *                IRAGA,IRAGB,IRAGC,IRATA,IRATB,IRBRB,IRBGA,IRBGB,
     *                IRBGC,IRBTA,IRBTB,IGAGA,IGAGB,IGAGC,IGATA,IGATB,
     *                IGBGB,IGBGC,IGBTA,IGBTB,IGCGC,IGCTA,IGCTB,ITATA,
     *                ITATB,ITBTB,IRARARA,IRARARB,IRARAGA,IRARAGB,
     *                IRARAGC,IRARATA,IRARATB,IRARBRB,IRARBGA,IRARBGB,
     *                IRARBGC,IRARBTA,IRARBTB,IRAGAGA,IRAGAGB,IRAGAGC,
     *                IRAGATA,IRAGATB,IRAGBGB,IRAGBGC,IRAGBTA,IRAGBTB,
     *                IRAGCGC,IRAGCTA,IRAGCTB,IRATATA,IRATATB,IRATBTB,
     *                IRBRBRB,IRBRBGA,IRBRBGB,IRBRBGC,IRBRBTA,IRBRBTB,
     *                IRBGAGA,IRBGAGB,IRBGAGC,IRBGATA,IRBGATB,IRBGBGB,
     *                IRBGBGC,IRBGBTA,IRBGBTB,IRBGCGC,IRBGCTA,IRBGCTB,
     *                IRBTATA,IRBTATB,IRBTBTB,IGAGAGA,IGAGAGB,IGAGAGC,
     *                IGAGATA,IGAGATB,IGAGBGB,IGAGBGC,IGAGBTA,IGAGBTB,
     *                IGAGCGC,IGAGCTA,IGAGCTB,IGATATA,IGATATB,IGATBTB,
     *                IGBGBGB,IGBGBGC,IGBGBTA,IGBGBTB,IGBGCGC,IGBGCTA,
     *                IGBGCTB,IGBTATA,IGBTATB,IGBTBTB,IGCGCGC,IGCGCTA,
     *                IGCGCTB,IGCTATA,IGCTATB,IGCTBTB,ITATATA,ITATATB,
     *                ITATBTB,ITBTBTB
C
      DIMENSION EC(ILENG,*)
      DIMENSION EC0(*)
      DIMENSION DRHOI_(NPTGRD,4,IRU)
      DIMENSION DTAUI_(NPTGRD,IRU)
      DIMENSION XYZWGT(*)
      DATA ZERO/0.0D+0/
      DATA TWO /2.0D+0/
C
      ECF=ZERO
      DO IPT=IST,IEND
         IIPT=IPT-IST+1
         RHOA=DRHOI_(IPT,1,1)
         RHOB=DRHOI_(IPT,1,IRU)
         TA=DTAUI_(IPT,1)
         TB=DTAUI_(IPT,IRU)
C             IN THE CLOSED SHELL CASE RHOB =RHOA SINCE IRU=1
C             IN THE OPENED SHELL CASE RHOB!=RHOA SINCE IRU=2
         RHOT=RHOA + RHOB
         IF(RHOT/TWO.GT.RHOMIN) THEN
           DXA = DRHOI_(IPT,2,1)
           DYA = DRHOI_(IPT,3,1)
           DZA = DRHOI_(IPT,4,1)
           DXB = DRHOI_(IPT,2,IRU)
           DYB = DRHOI_(IPT,3,IRU)
           DZB = DRHOI_(IPT,4,IRU)
           GRADA  = DXA**TWO + DYA**TWO + DZA**TWO
           GRADB  = DXB**TWO + DYB**TWO + DZB**TWO
C---       GRADAB = DXA*DXB+DYA*DYB+DZA*DZB
C
C     FUNCTIONAL ENERGY
C
      T1 = 1.0D+0*RHOA**((-8.0D+0)/3.0D+0)
      T2 = 1.0D+0*RHOB**((-8.0D+0)/3.0D+0)
      T3 = GRADB*T2+GRADA*T1
      T4 = T3**4
      T5 = 3.1D-3*T3+1.0D+0
      T6 = 1.0D+0/T5**4
      T7 = T3**3
      T8 = 1.0D+0/T5**3
      T9 = T3**2
      T10 = 1.0D+0/T5**2
      T11 = 1.0D+0/T5
      T12 = 3.388207D-3*T3*T11-3.64383331D-5*T9*T10+
     #8.42519271D-8*T7*T8-9.77924698589D-10*T4*T6+1.0D+0
      T13 = SQRT(RHOA)
      T14 = 1.0D+0*RHOA**((-1.0D+0)/3.0D+0)
      T15 = 1.1120374863094687D+1*RHOA**((-1.0D+0)/6.0D+0)+
     #2.4058712912881913D-1*RHOA**((-2.0D+0)/3.0D+0)+
     #3.8447462374472113D+0*T14+1.6447337755676092D+0/T13
      T16 = 3.216395899738507D+1/T15+1.0D+0
      T17 = LOG(T16)
      T18 = 1.274696188700087D-1*T14+1.0D+0
      T19 = SQRT(RHOB)
      T20 = 1.0D+0*RHOB**((-1.0D+0)/3.0D+0)
      T21 = 1.1120374863094687D+1*RHOB**((-1.0D+0)/6.0D+0)+
     #2.4058712912881913D-1*RHOB**((-2.0D+0)/3.0D+0)+
     #3.8447462374472113D+0*T20+1.6447337755676092D+0/T19
      T22 = 3.216395899738507D+1/T21+1.0D+0
      T23 = LOG(T22)
      T24 = 1.274696188700087D-1*T20+1.0D+0
      T25 = RHOB+RHOA
      T26 = 1.0D+0*T25**((-1.0D+0)/3.0D+0)
      T27 = 1.3256889990520176D-1*T26+1.0D+0
      T28 = 1.0D+0*T25**((-2.0D+0)/3.0D+0)
      T29 = SQRT(T25)
      T30 = 1.0D+0/T29
      T31 = 1.0D+0*T25**((-1.0D+0)/6.0D+0)
      T32 = 5.982550435771079D+0*T31+2.2255694211506874D+0*T26+
     #8.004286349993636D-1*T30+1.8970043257475583D-1*T28
      T33 = 1.6081979498692536D+1/T32+1.0D+0
      T34 = LOG(T33)
      T35 = -6.21814D-2*T27*T34
      T36 = 1.923661050931536D+0
      T37 = RHOA-1.0D+0*RHOB
      T38 = T37**4
      T39 = 1.0D+0/T25**4
      T40 = 1.0D+0-1.0D+0*T38*T39
      T41 = 6.901399211255825D-2*T26+1.0D+0
      T42 = 1.0D+0/T25
      T43 = 1.0D+0-1.0D+0*T37*T42
      T44 = T37*T42+1.0D+0
      T45 = T44**(4.0D+0/3.0D+0)+T43**(4.0D+0/3.0D+0)-2.0D+0
      T46 = 8.157414703487641D+0*T31+2.247591863577616D+0*T26+
     #4.3009724712766434D-1*T30+1.9115125951273373D-1*T28
      T47 = 2.9608749977793436D+1/T46+1.0D+0
      T48 = LOG(T47)
      T49 = 1.9751672738097256D-2*T36*T40*T41*T45*T48
      T50 = 1.274696188700087D-1*T26+1.0D+0
      T51 = 1.1120374863094687D+1*T31+3.8447462374472113D+0*T26+
     #1.6447337755676092D+0*T30+2.4058712912881913D-1*T28
      T52 = 3.216395899738507D+1/T51+1.0D+0
      T53 = LOG(T52)
      T54 = 6.21814D-2*T27*T34-3.10907D-2*T50*T53
      T55 = T36*T38*T39*T45*T54
      T56 = T25*(T55+T49+T35)+3.10907D-2*T23*T24*RHOB+
     #3.10907D-2*T17*T18*RHOA
      T57 = GRADA**4
      T58 = 6.0D-2*GRADA*T1+1.0D+0
      T59 = 1.0D+0/T58**4
      T60 = 1.0D+0*RHOA**((-3.2D+1)/3.0D+0)
      T61 = GRADA**3
      T62 = 1.0D+0/T58**3
      T63 = 1.0D+0/RHOA**8
      T64 = GRADA**2
      T65 = 1.0D+0/T58**2
      T66 = 1.0D+0*RHOA**((-1.6D+1)/3.0D+0)
      T67 = 1.0D+0/T58
      T68 = -1.83258D-1*GRADA*T67*T1+2.7426744D-2*T64*T65*T66+
     #3.189564D-4*T61*T62*T63-1.5453050399999999D-4*T57*T59*T60+1.0D+0
      T69 = 1.0D+0/RHOA
      T70 = 1.0D+0/TA
      T71 = 1.0D+0-1.25D-1*T69*T70*GRADA
      T72 = GRADB**4
      T73 = 6.0D-2*GRADB*T2+1.0D+0
      T74 = 1.0D+0/T73**4
      T75 = 1.0D+0*RHOB**((-3.2D+1)/3.0D+0)
      T76 = GRADB**3
      T77 = 1.0D+0/T73**3
      T78 = 1.0D+0/RHOB**8
      T79 = GRADB**2
      T80 = 1.0D+0/T73**2
      T81 = 1.0D+0*RHOB**((-1.6D+1)/3.0D+0)
      T82 = 1.0D+0/T73
      T83 = -1.83258D-1*GRADB*T82*T2+2.7426744D-2*T79*T80*T81+
     #3.189564D-4*T76*T77*T78-1.5453050399999999D-4*T72*T74*T75+1.0D+0
      T84 = 1.0D+0/RHOB
      T85 = 1.0D+0/TB
      T86 = 1.0D+0-1.25D-1*T84*T85*GRADB
      T87 = 1.0D+0/T16
      T88 = 1.0D+0*RHOA**((-4.0D+0)/3.0D+0)
      T89 = -1.8533958105157808D+0*RHOA**((-7.0D+0)/6.0D+0)-
     #1.6039141941921276D-1*RHOA**((-5.0D+0)/3.0D+0)-
     #1.2815820791490704D+0*T88-8.223668877838046D-1/T13**3
      T90 = 1.0D+0/T15**2
      T91 = 1.0D+0*T25**((-5.0D+0)/3.0D+0)
      T92 = 1.0D+0/T29**3
      T93 = 1.0D+0*T25**((-4.0D+0)/3.0D+0)
      T94 = 1.0D+0*T25**((-7.0D+0)/6.0D+0)
      T95 = -9.970917392951799D-1*T94-7.418564737168958D-1*T93-
     #4.002143174996818D-1*T92-1.264669550498372D-1*T91
      T96 = 1.0D+0/T32**2
      T97 = 1.0D+0/T33
      T98 = 1.0D+0*T95*T27*T96*T97
      T99 = -1.3595691172479402D+0*T94-7.491972878592053D-1*T93-
     #2.1504862356383217D-1*T92-1.2743417300848914D-1*T91
      T100 = 1.0D+0/T46**2
      T101 = 1.0D+0/T47
      T102 = -5.848223397455204D-1*T36*T40*T99*T41*T100*T45*T101
      T103 = 2.747773264188437D-3*T93*T34
      T104 = 1.0D+0/T25**2
      T105 = T37*T104
      T106 = -1.0D+0*T42
      T107 = T106+T105
      T108 = T43**(1.0D+0/3.0D+0)
      T109 = -1.0D+0*T104*T37
      T110 = T42+T109
      T111 = T44**(1.0D+0/3.0D+0)
      T112 = 1.3333333333333333D+0*T110*T111+
     #1.3333333333333333D+0*T107*T108
      T113 = 1.9751672738097256D-2*T36*T40*T41*T112*T48
      T114 = -4.543805955189586D-4*T36*T93*T40*T45*T48
      T115 = 1.0D+0/T25**5
      T116 = 4.0D+0*T115*T38
      T117 = T37**3
      T118 = T116-4.0D+0*T117*T39
      T119 = 1.9751672738097256D-2*T36*T118*T41*T45*T48
      T120 = -1.8533958105157808D+0*T94-1.2815820791490704D+0*
     #T93-8.223668877838046D-1*T92-1.6039141941921276D-1*T91
      T121 = 1.0D+0/T51**2
      T122 = 1.0D+0/T52
      T123 = 1.3210398931339262D-3*T93*T53-2.747773264188437D-3*
     #T93*T34+1.0D+0*T120*T50*T121*T122-1.0D+0*T95*T27*T96*T97
      T124 = T36*T38*T39*T45*T123
      T125 = T36*T38*T39*T112*T54
      T126 = -4.0D+0*T115*T36*T38*T45*T54
      T127 = -1.0D+0*T87*T89*T18*T90*RHOA+T25*(T98+4.0D+0*T117*
     #T36*T39*T45*T54+T126+T125+T124+T119+T114+T113+T103+T102)+T55+T49+
     #T35+3.10907D-2*T17*T18-1.3210398931339262D-3*T17*T14
      T128 = 1.0D+0*RHOA**((-1.1000000000000001D+1)/3.0D+0)
      T129 = 1.0D+0/T5**5
      T130 = -9.035218666666666D-3*GRADA*T128*T11+
     #2.223469544D-4*GRADA*T128*T3*T10-1.2764625240533334D-6*GRADA*T128*
     #T9*T8+1.2520644577029333D-8*GRADA*T128*T7*T6-
     #3.233671003334293D-11*GRADA*T128*T4*T129
      T131 = GRADA**5
      T132 = 1.0D+0/T58**5
      T133 = 1.0D+0*RHOA**((-4.3D+1)/3.0D+0)
      T134 = 1.0D+0*RHOA**((-3.5D+1)/3.0D+0)
      T135 = 1.0D+0/RHOA**9
      T136 = 1.0D+0*RHOA**((-1.9D+1)/3.0D+0)
      T137 = 4.88688D-1*GRADA*T67*T128-1.7559724799999998D-1*
     #T64*T65*T136+6.224906879999998D-3*T61*T62*T135+
     #1.8014244479999997D-3*T57*T59*T134-9.889952255999999D-5*T131*T132*
     #T133
      T138 = 1.0D+0/T22
      T139 = 1.0D+0*RHOB**((-4.0D+0)/3.0D+0)
      T140 = -1.8533958105157808D+0*RHOB**((-7.0D+0)/6.0D+0)-
     #1.6039141941921276D-1*RHOB**((-5.0D+0)/3.0D+0)-
     #8.223668877838046D-1/T19**3-1.2815820791490704D+0*T139
      T141 = 1.0D+0/T21**2
      T142 = T42+T105
      T143 = T106+T109
      T144 = 1.3333333333333333D+0*T111*T143+
     #1.3333333333333333D+0*T108*T142
      T145 = 1.9751672738097256D-2*T36*T40*T41*T144*T48
      T146 = 4.0D+0*T117*T39+T116
      T147 = 1.9751672738097256D-2*T36*T146*T41*T45*T48
      T148 = T36*T38*T39*T144*T54
      T149 = -1.0D+0*T138*T140*T24*T141*RHOB+T25*(T98-4.0D+0*
     #T117*T36*T39*T45*T54+T148+T147+T145+T126+T124+T114+T103+T102)+T55+
     #T49+T35+3.10907D-2*T23*T24-1.3210398931339262D-3*T23*T20
      T150 = 1.0D+0*RHOB**((-1.1000000000000001D+1)/3.0D+0)
      T151 = -9.035218666666666D-3*GRADB*T11*T150+
     #2.223469544D-4*GRADB*T3*T10*T150-1.2764625240533334D-6*GRADB*T9*
     #T8*T150+1.2520644577029333D-8*GRADB*T7*T6*T150-
     #3.233671003334293D-11*GRADB*T4*T129*T150
      T152 = GRADB**5
      T153 = 1.0D+0/T73**5
      T154 = 1.0D+0*RHOB**((-4.3D+1)/3.0D+0)
      T155 = 1.0D+0*RHOB**((-3.5D+1)/3.0D+0)
      T156 = 1.0D+0/RHOB**9
      T157 = 1.0D+0*RHOB**((-1.9D+1)/3.0D+0)
      T158 = 4.88688D-1*GRADB*T82*T150-1.7559724799999998D-1*
     #T79*T80*T157+6.224906879999998D-3*T76*T77*T156+
     #1.8014244479999997D-3*T72*T74*T155-9.889952255999999D-5*T152*T153*
     #T154
      T159 = 3.388207D-3*T1*T11-8.33801079D-5*T1*T3*T10+
     #4.7867344652D-7*T1*T9*T8-4.6952417163859994D-9*T1*T7*T6+
     #1.2126266262503599D-11*T1*T4*T129
      T160 = 1.0D+0*RHOA**((-4.0D+1)/3.0D+0)
      T161 = -1.83258D-1*T67*T1+6.5848968D-2*GRADA*T65*T66-
     #2.33434008D-3*T64*T62*T63-6.75534168D-4*T61*T59*T60+
     #3.708732096D-5*T57*T132*T160
      T162 = 3.388207D-3*T11*T2-8.33801079D-5*T3*T10*T2+
     #4.7867344652D-7*T9*T8*T2-4.6952417163859994D-9*T7*T6*T2+
     #1.2126266262503599D-11*T4*T129*T2
      T163 = 1.0D+0*RHOB**((-4.0D+1)/3.0D+0)
      T164 = -1.83258D-1*T82*T2+6.5848968D-2*GRADB*T80*T81-
     #2.33434008D-3*T79*T77*T78-6.75534168D-4*T76*T74*T75+
     #3.708732096D-5*T72*T153*T163
      T165 = 1.0D+0/TA**2
      T166 = 1.0D+0/TB**2
      T167 = 1.0D+0/T16**2
      T168 = T89**2
      T169 = 1.0D+0/T15**4
      T170 = 1.0D+0/T15**3
      T171 = 1.0D+0*RHOA**((-7.0D+0)/3.0D+0)
      T172 = 2.1622951122684114D+0*RHOA**((-1.3D+1)/6.0D+0)+
     #1.7087761055320938D+0*T171+1.2335503316757071D+0/T13**5+
     #2.673190323653546D-1*T1
      T173 = 2.0D+0*T95*T27*T96*T97
      T174 = -1.1696446794910409D+0*T36*T40*T99*T41*T100*T45*
     #T101
      T175 = 5.495546528376875D-3*T93*T34
      T176 = -9.087611910379172D-4*T36*T93*T40*T45*T48
      T177 = 2.0D+0*T123*T36*T38*T39*T45
      T178 = -8.0D+0*T115*T36*T38*T45*T54
      T179 = T95**2
      T180 = 1.0D+0/T32**4
      T181 = 1.0D+0/T33**2
      T182 = 1.6081979498692536D+1*T179*T27*T180*T181
      T183 = 1.0D+0/T32**3
      T184 = -2.0D+0*T179*T27*T183*T97
      T185 = -8.837926660346784D-2*T93*T95*T96*T97
      T186 = 1.0D+0*T25**((-8.0D+0)/3.0D+0)
      T187 = 1.0D+0/T29**5
      T188 = 1.0D+0*T25**((-7.0D+0)/3.0D+0)
      T189 = 1.0D+0*T25**((-1.3D+1)/6.0D+0)
      T190 = 1.1632736958443765D+0*T189+9.89141964955861D-1*
     #T188+6.003214762495227D-1*T187+2.1077825841639536D-1*T186
      T191 = 1.0D+0*T190*T27*T96*T97
      T192 = T99**2
      T193 = -1.7315858438953285D+1*T192*T36*T40*T41*T45/(T46**
     #4*T47**2)
      T194 = 1.1696446794910409D+0*T101*T192*T36*T40*T41*T45/
     #T46**3
      T195 = 2.690728289496347D-2*T36*T93*T40*T99*T100*T45*T101
      T196 = -5.848223397455204D-1*T36*T40*
     #(1.5861639701225969D+0*T189+9.98929717145607D-1*T188+
     #3.2257293534574827D-1*T187+2.1239028834748191D-1*T186)*T41*T100*
     #T45*T101
      T197 = -3.663697685584583D-3*T188*T34
      T198 = 1.0D+0*T43**((-2.0D+0)/3.0D+0)
      T199 = 1.0D+0/T25**3
      T200 = -2.0D+0*T199*T37
      T201 = 2.0D+0*T104
      T202 = 1.0D+0*T44**((-2.0D+0)/3.0D+0)
      T203 = 2.0D+0*T199*T37
      T204 = -2.0D+0*T104
      T205 = 1.3333333333333333D+0*T111*(T204+T203)+
     #4.444444444444444D-1*T110**2*T202+1.3333333333333333D+0*T108*
     #(T201+T200)+4.444444444444444D-1*T107**2*T198
      T206 = 6.058407940252781D-4*T36*T188*T40*T45*T48
      T207 = 1.0D+0/T25**6
      T208 = -2.0D+1*T207*T38
      T209 = T37**2
      T210 = -1.2D+1*T209*T39
      T211 = T120**2
      T212 = T36*T38*T39*T45*(8.837926660346784D-2*T93*T95*T96*
     #T97-1.0D+0*T190*T27*T96*T97+2.0D+0*T179*T27*T183*T97-
     #1.7613865241785684D-3*T188*T53+3.216395899738507D+1*T211*T50/(T51*
     #*4*T52**2)-2.0D+0*T122*T211*T50/T51**3+3.663697685584583D-3*T188*
     #T34-1.6081979498692536D+1*T179*T27*T180*T181+1.0D+0*
     #(2.1622951122684114D+0*T189+1.7087761055320938D+0*T188+
     #1.2335503316757071D+0*T187+2.673190323653546D-1*T186)*T50*T121*
     #T122-8.497974591333913D-2*T93*T120*T121*T122)
      T213 = -8.0D+0*T115*T123*T36*T38*T45
      T214 = 2.0D+1*T207*T36*T38*T45*T54
      T215 = 1.2D+1*T209*T36*T39*T45*T54
      T216 = 1.0D+0*RHOA**((-2.2000000000000003D+1)/3.0D+0)
      T217 = 1.0D+0/T5**6
      T218 = 1.0D+0*RHOA**((-1.3999999999999999D+1)/3.0D+0)
      T219 = -3.10907D-2*T17*T137*T18*T71
      T220 = 1.0D+0/T58**6
      T221 = 2.6666666666666666D+0*T111*T199*T37-
     #2.6666666666666666D+0*T108*T199*T37+4.444444444444444D-1*T110*
     #T143*T202+4.444444444444444D-1*T107*T142*T198
      T222 = 1.0D+0/T22**2
      T223 = T140**2
      T224 = 1.0D+0/T21**4
      T225 = 1.0D+0/T21**3
      T226 = 1.0D+0*RHOB**((-7.0D+0)/3.0D+0)
      T227 = 2.1622951122684114D+0*RHOB**((-1.3D+1)/6.0D+0)+
     #1.7087761055320938D+0*T226+2.673190323653546D-1*T2+
     #1.2335503316757071D+0/T19**5
      T228 = 1.3333333333333333D+0*T108*(T204+T200)+
     #4.444444444444444D-1*T143**2*T202+1.3333333333333333D+0*T111*
     #(T201+T203)+4.444444444444444D-1*T142**2*T198
      T229 = 1.0D+0*RHOB**((-2.2000000000000003D+1)/3.0D+0)
      T230 = 1.0D+0*RHOB**((-1.3999999999999999D+1)/3.0D+0)
      T231 = -3.10907D-2*T23*T158*T24*T86
      T232 = 1.0D+0/T73**6
      ENERGY = -3.10907D-2*T23*T83*T24*RHOB*T86-3.10907D-2*T17*
     #T68*T18*RHOA*T71+T12*T56
      DFDRA = 1.0D+0*T87*T68*T89*T18*T90*RHOA*T71-3.10907D-2*
     #T17*T137*T18*RHOA*T71+1.3210398931339262D-3*T17*T68*T14*T71-
     #3.10907D-2*T17*T68*T18*T71-3.8863375D-3*GRADA*T17*T68*T18*T69*T70+
     #T130*T56+T12*T127
      DFDRB = 1.0D+0*T138*T83*T140*T24*T141*RHOB*T86-3.10907D-2*
     #T23*T158*T24*RHOB*T86+1.3210398931339262D-3*T23*T83*T20*T86-
     #3.10907D-2*T23*T83*T24*T86-3.8863375D-3*GRADB*T23*T83*T24*T84*T85+
     #T151*T56+T12*T149
      DFDGA = -3.10907D-2*T17*T161*T18*RHOA*T71+3.8863375D-3*
     #T17*T68*T18*T70+T159*T56
      DFDGC = 0.0D+0
      DFDGB = -3.10907D-2*T23*T164*T24*RHOB*T86+3.8863375D-3*
     #T23*T83*T24*T85+T162*T56
      DFDTA = -3.8863375D-3*GRADA*T17*T68*T18*T165
      DFDTB = -3.8863375D-3*GRADB*T23*T83*T24*T166
      D2FDRARA = T12*(-1.0D+0*T87*T172*T18*T90*RHOA+2.0D+0*T87*
     #T168*T18*T170*RHOA-3.216395899738507D+1*T167*T168*T18*T169*RHOA-
     #2.0D+0*T87*T89*T18*T90-8.806932620892842D-4*T17*T88+T25*(-3.2D+1*
     #T115*T117*T36*T45*T54+8.0D+0*T112*T117*T36*T39*T54-8.0D+0*T112*
     #T115*T36*T38*T54+T36*T38*T39*T205*T54+1.9751672738097256D-2*(T210+
     #T208+3.2D+1*T115*T117)*T36*T41*T45*T48-9.087611910379172D-4*T36*
     #T93*T118*T45*T48+1.9751672738097256D-2*T36*T40*T41*T205*T48+
     #3.950334547619451D-2*T36*T118*T41*T112*T48-9.087611910379172D-4*
     #T36*T93*T40*T112*T48+8.0D+0*T117*T123*T36*T39*T45+2.0D+0*T112*
     #T123*T36*T38*T39+T215+T214+T213+T212+T206+T197+T196+T195+T194+
     #T193+T191+T185+T184+T182-1.1696446794910409D+0*T36*T118*T99*T41*
     #T100*T45*T101-1.1696446794910409D+0*T36*T40*T99*T41*T100*T112*
     #T101)+8.0D+0*T117*T36*T39*T45*T54+2.0D+0*T112*T36*T38*T39*T54+
     #3.950334547619451D-2*T36*T118*T41*T45*T48+3.950334547619451D-2*
     #T36*T40*T41*T112*T48+T178+T177+T176+T175+T174+T173+
     #8.497974591333913D-2*T87*T89*T90*T14)-3.10907D-2*T17*T18*T71*
     #(-1.1221528127999997D-1*T61*T62/RHOA**10-1.8028663257599997D-2*
     #T57*T59*RHOA**((-3.8D+1)/3.0D+0)+2.5704714700799997D-3*T131*T132*
     #RHOA**((-4.5999999999999996D+1)/3.0D+0)-7.911961804799996D-5*T220*
     #GRADA**6/RHOA**18-1.791856D+0*GRADA*T67*T218+
     #1.1903059839999999D+0*T64*T65*T216)*RHOA+2.0D+0*T87*T137*T89*T18*
     #T90*RHOA*T71+1.0D+0*T87*T68*T172*T18*T90*RHOA*T71-2.0D+0*T87*T68*
     #T168*T18*T170*RHOA*T71+3.216395899738507D+1*T167*T68*T168*T18*
     #T169*RHOA*T71+2.0D+0*T87*T68*T89*T18*T90*T71+8.806932620892842D-4*
     #T17*T68*T88*T71-8.497974591333913D-2*T87*T68*T89*T90*T14*T71+
     #2.6420797862678524D-3*T17*T137*T14*T71+2.5D-1*GRADA*T87*T68*T89*
     #T18*T90*T69*T70-7.772675D-3*GRADA*T17*T137*T18*T69*T70+
     #3.302599732834816D-4*GRADA*T17*T68*T171*T70+(3.31291351111111D-2*
     #GRADA*T218*T11-8.152721661333333D-4*GRADA*T218*T3*T10-
     #6.676163527111111D-4*T64*T216*T10+4.680362588195555D-6*GRADA*T218*
     #T9*T8+1.0483936441031111D-5*T64*T216*T3*T8-4.590903011577422D-8*
     #GRADA*T218*T7*T6-1.3182142721275733D-7*T64*T216*T9*T6+
     #1.1856793678892405D-10*GRADA*T218*T4*T129+7.589408877027611D-10*
     #T64*T216*T7*T129-1.3365840147115077D-12*T64*T216*T4*T217)*T56+2*
     #T219+2.0D+0*T127*T130
      D2FDRARB = (-6.676163527111111D-4*GRADA*GRADB*T128*T10*
     #T150+1.0483936441031111D-5*GRADA*GRADB*T128*T3*T8*T150-
     #1.3182142721275733D-7*GRADA*GRADB*T128*T9*T6*T150+
     #7.589408877027611D-10*GRADA*GRADB*T128*T7*T129*T150-
     #1.3365840147115077D-12*GRADA*GRADB*T128*T4*T217*T150)*T56+T12*
     #(T25*(-1.2D+1*T209*T36*T39*T45*T54+4.0D+0*T117*T144*T36*T39*T54-
     #4.0D+0*T112*T117*T36*T39*T54-4.0D+0*T115*T144*T36*T38*T54-4.0D+0*
     #T112*T115*T36*T38*T54+T36*T38*T39*T221*T54+1.9751672738097256D-2*
     #T36*(1.2D+1*T209*T39+T208)*T41*T45*T48-4.543805955189586D-4*T36*
     #T93*T146*T45*T48-4.543805955189586D-4*T36*T93*T118*T45*T48+
     #1.9751672738097256D-2*T36*T40*T41*T221*T48+1.9751672738097256D-2*
     #T36*T118*T41*T144*T48-4.543805955189586D-4*T36*T93*T40*T144*T48+
     #1.9751672738097256D-2*T36*T146*T41*T112*T48-4.543805955189586D-4*
     #T36*T93*T40*T112*T48+T214+T213+T212+T206+T197+T196+T195+T194+T193+
     #T191+T185+T184+T182+T36*T38*T39*T144*T123+T36*T38*T39*T112*T123-
     #5.848223397455204D-1*T36*T146*T99*T41*T100*T45*T101-
     #5.848223397455204D-1*T36*T118*T99*T41*T100*T45*T101-
     #5.848223397455204D-1*T36*T40*T99*T41*T100*T144*T101-
     #5.848223397455204D-1*T36*T40*T99*T41*T100*T112*T101)+T178+T177+
     #T176+T175+T174+T173+T148+T147+T145+T125+T119+T113)+T130*T149+T151*
     #T127
      D2FDRBRB = T12*(2.0D+0*T138*T223*T24*T225*RHOB-
     #3.216395899738507D+1*T222*T223*T24*T224*RHOB-1.0D+0*T138*T227*T24*
     #T141*RHOB+T25*(3.2D+1*T115*T117*T36*T45*T54-8.0D+0*T117*T144*T36*
     #T39*T54-8.0D+0*T115*T144*T36*T38*T54+T36*T38*T39*T228*T54+
     #1.9751672738097256D-2*(T210+T208-3.2D+1*T115*T117)*T36*T41*T45*
     #T48-9.087611910379172D-4*T36*T93*T146*T45*T48+
     #1.9751672738097256D-2*T36*T40*T41*T228*T48+3.950334547619451D-2*
     #T36*T146*T41*T144*T48-9.087611910379172D-4*T36*T93*T40*T144*T48-
     #8.0D+0*T117*T123*T36*T39*T45+2.0D+0*T123*T144*T36*T38*T39+T215+
     #T214+T213+T212+T206+T197+T196+T195+T194+T193+T191+T185+T184+T182-
     #1.1696446794910409D+0*T36*T146*T99*T41*T100*T45*T101-
     #1.1696446794910409D+0*T36*T40*T99*T41*T100*T144*T101)-8.0D+0*T117*
     #T36*T39*T45*T54+2.0D+0*T144*T36*T38*T39*T54+3.950334547619451D-2*
     #T36*T146*T41*T45*T48+3.950334547619451D-2*T36*T40*T41*T144*T48+
     #8.497974591333913D-2*T138*T140*T141*T20+T178+T177+T176+T175+T174+
     #T173-2.0D+0*T138*T140*T24*T141-8.806932620892842D-4*T23*T139)-
     #3.10907D-2*T23*T24*T86*(-1.1221528127999997D-1*T76*T77/RHOB**10-
     #1.8028663257599997D-2*T72*T74*RHOB**((-3.8D+1)/3.0D+0)+
     #2.5704714700799997D-3*T152*T153*RHOB**((-4.5999999999999996D+1)/
     #3.0D+0)-7.911961804799996D-5*T232*GRADB**6/RHOB**18-1.791856D+0*
     #GRADB*T82*T230+1.1903059839999999D+0*T79*T80*T229)*RHOB-2.0D+0*
     #T138*T83*T223*T24*T225*RHOB*T86+3.216395899738507D+1*T222*T83*
     #T223*T24*T224*RHOB*T86+1.0D+0*T138*T83*T227*T24*T141*RHOB*T86+
     #2.0D+0*T138*T158*T140*T24*T141*RHOB*T86+2.6420797862678524D-3*T23*
     #T158*T20*T86-8.497974591333913D-2*T138*T83*T140*T141*T20*T86+
     #2.0D+0*T138*T83*T140*T24*T141*T86+8.806932620892842D-4*T23*T83*
     #T139*T86-7.772675D-3*GRADB*T23*T158*T24*T84*T85+2.5D-1*GRADB*T138*
     #T83*T140*T24*T141*T84*T85+3.302599732834816D-4*GRADB*T23*T83*T226*
     #T85+(3.31291351111111D-2*GRADB*T11*T230-8.152721661333333D-4*
     #GRADB*T3*T10*T230+4.680362588195555D-6*GRADB*T9*T8*T230-
     #4.590903011577422D-8*GRADB*T7*T6*T230+1.1856793678892405D-10*
     #GRADB*T4*T129*T230-6.676163527111111D-4*T79*T10*T229+
     #1.0483936441031111D-5*T79*T3*T8*T229-1.3182142721275733D-7*T79*T9*
     #T6*T229+7.589408877027611D-10*T79*T7*T129*T229-
     #1.3365840147115077D-12*T79*T4*T217*T229)*T56+2*T231+2.0D+0*T149*
     #T151
      D2FDRAGA = -3.10907D-2*T17*T18*T71*(2.966985676799999D-5*
     #T131*T220/RHOA**17-3.80515776D-1*GRADA*T65*T136+3.97463904D-2*T64*
     #T62*T135+6.085214553599999D-3*T61*T59*T134-9.268394803199997D-4*
     #T57*T132*T133+4.88688D-1*T67*T128)*RHOA+1.0D+0*T87*T161*T89*T18*
     #T90*RHOA*T71-3.10907D-2*T17*T161*T18*T71+1.3210398931339262D-3*
     #T17*T161*T14*T71-1.25D-1*T87*T68*T89*T18*T90*T70-
     #1.651299866417408D-4*T17*T68*T88*T70-3.8863375D-3*GRADA*T17*T161*
     #T18*T69*T70+3.8863375D-3*T17*T137*T18*T70+(-9.035218666666666D-3*
     #T128*T11+2.223469544D-4*T128*T3*T10+2.5035613226666664D-4*GRADA*
     #T136*T10-1.2764625240533334D-6*T128*T9*T8-3.9314761653866664D-6*
     #GRADA*T136*T3*T8+1.2520644577029333D-8*T128*T7*T6+
     #4.9433035204784D-8*GRADA*T136*T9*T6-3.233671003334293D-11*T128*T4*
     #T129-2.846028328885354D-10*GRADA*T136*T7*T129+
     #5.012190055168153D-13*GRADA*T136*T4*T217)*T56+T159*T127
      D2FDRAGC = 0.0D+0
      D2FDRAGB = (2.5035613226666664D-4*GRADA*T128*T10*T2-
     #3.9314761653866664D-6*GRADA*T128*T3*T8*T2+4.9433035204784D-8*
     #GRADA*T128*T9*T6*T2-2.846028328885354D-10*GRADA*T128*T7*T129*T2+
     #5.012190055168153D-13*GRADA*T128*T4*T217*T2)*T56+T162*T127
      D2FDRBGA = (2.5035613226666664D-4*GRADB*T1*T10*T150-
     #3.9314761653866664D-6*GRADB*T1*T3*T8*T150+4.9433035204784D-8*
     #GRADB*T1*T9*T6*T150-2.846028328885354D-10*GRADB*T1*T7*T129*T150+
     #5.012190055168153D-13*GRADB*T1*T4*T217*T150)*T56+T159*T149
      D2FDRBGC = 0.0D+0
      D2FDRBGB = -3.10907D-2*T23*T24*T86*(2.966985676799999D-5*
     #T152*T232/RHOB**17-3.80515776D-1*GRADB*T80*T157+3.97463904D-2*T79*
     #T77*T156+6.085214553599999D-3*T76*T74*T155-9.268394803199997D-4*
     #T72*T153*T154+4.88688D-1*T82*T150)*RHOB+1.0D+0*T138*T164*T140*T24*
     #T141*RHOB*T86-3.10907D-2*T23*T164*T24*T86+1.3210398931339262D-3*
     #T23*T164*T20*T86-3.8863375D-3*GRADB*T23*T164*T24*T84*T85+
     #3.8863375D-3*T23*T158*T24*T85-1.25D-1*T138*T83*T140*T24*T141*T85-
     #1.651299866417408D-4*T23*T83*T139*T85+(-9.035218666666666D-3*T11*
     #T150+2.223469544D-4*T3*T10*T150-1.2764625240533334D-6*T9*T8*T150+
     #1.2520644577029333D-8*T7*T6*T150-3.233671003334293D-11*T4*T129*
     #T150+2.5035613226666664D-4*GRADB*T10*T157-3.9314761653866664D-6*
     #GRADB*T3*T8*T157+4.9433035204784D-8*GRADB*T9*T6*T157-
     #2.846028328885354D-10*GRADB*T7*T129*T157+5.012190055168153D-13*
     #GRADB*T4*T217*T157)*T56+T162*T149
      D2FDGAGA = -3.10907D-2*T17*T18*T71*
     #(-1.1126196287999998D-5*T220*T57/RHOA**16+7.6844448D-2*T65*T66-
     #1.2570556319999998D-2*GRADA*T62*T63-1.6064212896D-3*T64*T59*T60+
     #3.1047748416D-4*T61*T132*T160)*RHOA+7.772675D-3*T17*T161*T18*T70+
     #(-9.38835496D-5*T66*T10+1.4743035620199998D-6*T66*T3*T8-
     #1.8537388201794D-8*T66*T9*T6+1.0672606233320078D-10*T66*T7*T129-
     #1.879571270688058D-13*T66*T4*T217)*T56
      D2FDGAGC = 0.0D+0
      D2FDGAGB = (-9.38835496D-5*T1*T10*T2+
     #1.4743035620199998D-6*T1*T3*T8*T2-1.8537388201794D-8*T1*T9*T6*T2+
     #1.0672606233320078D-10*T1*T7*T129*T2-1.879571270688058D-13*T1*T4*
     #T217*T2)*T56
      D2FDGCGC = 0.0D+0
      D2FDGBGC = 0.0D+0
      D2FDGBGB = -3.10907D-2*T23*T24*T86*
     #(-1.1126196287999998D-5*T232*T72/RHOB**16+7.6844448D-2*T80*T81-
     #1.2570556319999998D-2*GRADB*T77*T78-1.6064212896D-3*T79*T74*T75+
     #3.1047748416D-4*T76*T153*T163)*RHOB+7.772675D-3*T23*T164*T24*T85+
     #(-9.38835496D-5*T10*T81+1.4743035620199998D-6*T3*T8*T81-
     #1.8537388201794D-8*T9*T6*T81+1.0672606233320078D-10*T7*T129*T81-
     #1.879571270688058D-13*T4*T217*T81)*T56
      D2FDRATA = -3.8863375D-3*GRADA*T17*T137*T18*T165+
     #1.651299866417408D-4*GRADA*T17*T68*T88*T165+1.25D-1*GRADA*T87*T68*
     #T89*T18*T90*T165
      D2FDRBTA = 0.0D+0
      D2FDRATB = 0.0D+0
      D2FDRBTB = -3.8863375D-3*GRADB*T23*T158*T24*T166+
     #1.651299866417408D-4*GRADB*T23*T83*T139*T166+1.25D-1*GRADB*T138*
     #T83*T140*T24*T141*T166
      D2FDGATA = -3.8863375D-3*T17*T68*T18*T165-3.8863375D-3*
     #GRADA*T17*T161*T18*T165
      D2FDGCTA = 0.0D+0
      D2FDGBTA = 0.0D+0
      D2FDGATB = 0.0D+0
      D2FDGCTB = 0.0D+0
      D2FDGBTB = -3.8863375D-3*T23*T83*T24*T166-3.8863375D-3*
     #GRADB*T23*T164*T24*T166
      D2FDTATA = 7.772675D-3*T17*T18*T68*GRADA/TA**3
      D2FDTATB = 0.0D+0
      D2FDTBTB = 7.772675D-3*T23*T24*T83*GRADB/TB**3
C
C     STORE FUNCTIONAL ENERGY
C
            ECF             = ECF             + SCALE*ENERGY*XYZWGT(IPT)
            EC0(IIPT)       = EC0(IIPT)       + SCALE*ENERGY
C
C     STORE FIRST FUNCTIONAL DERIVATIVE
C
            EC (IIPT,IRA)   = EC (IIPT,IRA)   + SCALE*DFDRA
            EC (IIPT,IRB)   = EC (IIPT,IRB)   + SCALE*DFDRB
            EC (IIPT,IGA)   = EC (IIPT,IGA)   + SCALE*DFDGA
            EC (IIPT,IGB)   = EC (IIPT,IGB)   + SCALE*DFDGB
            EC (IIPT,IGC)   = EC (IIPT,IGC)   + SCALE*DFDGC
            EC (IIPT,ITA)   = EC (IIPT,ITA)   + SCALE*DFDTA
            EC (IIPT,ITB)   = EC (IIPT,ITB)   + SCALE*DFDTB
C
C     STORE SECOND FUNCTIONAL DERIVATIVE
C
            EC (IIPT,IRARA) = EC (IIPT,IRARA) + SCALE*D2FDRARA
            EC (IIPT,IRARB) = EC (IIPT,IRARB) + SCALE*D2FDRARB
            EC (IIPT,IRAGA) = EC (IIPT,IRAGA) + SCALE*D2FDRAGA
            EC (IIPT,IRAGB) = EC (IIPT,IRAGB) + SCALE*D2FDRAGB
            EC (IIPT,IRAGC) = EC (IIPT,IRAGC) + SCALE*D2FDRAGC
            EC (IIPT,IRATA) = EC (IIPT,IRATA) + SCALE*D2FDRATA
            EC (IIPT,IRATB) = EC (IIPT,IRATB) + SCALE*D2FDRATB
            EC (IIPT,IRBRB) = EC (IIPT,IRBRB) + SCALE*D2FDRBRB
            EC (IIPT,IRBGA) = EC (IIPT,IRBGA) + SCALE*D2FDRBGA
            EC (IIPT,IRBGB) = EC (IIPT,IRBGB) + SCALE*D2FDRBGB
            EC (IIPT,IRBGC) = EC (IIPT,IRBGC) + SCALE*D2FDRBGC
            EC (IIPT,IRBTA) = EC (IIPT,IRBTA) + SCALE*D2FDRBTA
            EC (IIPT,IRBTB) = EC (IIPT,IRBTB) + SCALE*D2FDRBTB
            EC (IIPT,IGAGA) = EC (IIPT,IGAGA) + SCALE*D2FDGAGA
            EC (IIPT,IGAGB) = EC (IIPT,IGAGB) + SCALE*D2FDGAGB
            EC (IIPT,IGAGC) = EC (IIPT,IGAGC) + SCALE*D2FDGAGC
            EC (IIPT,IGATA) = EC (IIPT,IGATA) + SCALE*D2FDGATA
            EC (IIPT,IGATB) = EC (IIPT,IGATB) + SCALE*D2FDGATB
            EC (IIPT,IGBGB) = EC (IIPT,IGBGB) + SCALE*D2FDGBGB
            EC (IIPT,IGBGC) = EC (IIPT,IGBGC) + SCALE*D2FDGBGC
            EC (IIPT,IGBTA) = EC (IIPT,IGBTA) + SCALE*D2FDGBTA
            EC (IIPT,IGBTB) = EC (IIPT,IGBTB) + SCALE*D2FDGBTB
            EC (IIPT,IGCGC) = EC (IIPT,IGCGC) + SCALE*D2FDGCGC
            EC (IIPT,IGCTA) = EC (IIPT,IGCTA) + SCALE*D2FDGCTA
            EC (IIPT,IGCTB) = EC (IIPT,IGCTB) + SCALE*D2FDGCTB
            EC (IIPT,ITATA) = EC (IIPT,ITATA) + SCALE*D2FDTATA
            EC (IIPT,ITATB) = EC (IIPT,ITATB) + SCALE*D2FDTATB
            EC (IIPT,ITBTB) = EC (IIPT,ITBTB) + SCALE*D2FDTBTB
C
C     END OF CODE GENERATION
C
        END IF
      END DO
      RETURN
      END
