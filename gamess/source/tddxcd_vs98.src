C*MODULE TDDXCD  *DECK TD_VS98X
      SUBROUTINE TD_VS98X(EX0,EX,DRHOI_,DTAUI_,
     *               XYZWGT,SCALE,RHOMIN,ILENG,NPTGRD,IRU,IST,IEND)
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
C
      COMMON /XDERIX/ NXDIM(3),KRA,KRB,KGA,KGB,KTA,KTB,KRARA,KRAGA,
     *                KRATA,KGAGA,KGATA,KTATA,KRBRB,KRBGB,KRBTB,KGBGB,
     *                KGBTB,KTBTB,KRARARA,KRARAGA,KRARATA,KRAGAGA,
     *                KRAGATA,KRATATA,KGAGAGA,KGAGATA,KGATATA,KTATATA,
     *                KRBRBRB,KRBRBGB,KRBRBTB,KRBGBGB,KRBGBTB,KRBTBTB,
     *                KGBGBGB,KGBGBTB,KGBTBTB,KTBTBTB
      DIMENSION DRHOI_(NPTGRD,4,IRU)
      DIMENSION DTAUI_(NPTGRD,IRU)
      DIMENSION EX0(*)
      DIMENSION EX(ILENG,*)
      DIMENSION XYZWGT(*)
      DATA ZERO/0.0D+0/
      DATA TWO /2.0D+0/
C
      EXF    = ZERO
C     EXF    = INITIALIZE THE ENERGY OF THE CORRELATION FUNCTION TO ZERO
C
      DO IPT=IST,IEND
         IIPT=IPT-IST+1
         RHOA=DRHOI_(IPT,1,1)
         RHOB=DRHOI_(IPT,1,IRU)
         TA=DTAUI_(IPT,1)
         TB=DTAUI_(IPT,IRU)
C             IN THE CLOSED SHELL CASE RHOB =RHOA SINCE IRU=1
C             IN THE OPENED SHELL CASE RHOB!=RHOA SINCE IRU=2
         RHOT=RHOA + RHOB
         IF(RHOT/TWO.GT.RHOMIN) THEN
           DXA = DRHOI_(IPT,2,1)
           DYA = DRHOI_(IPT,3,1)
           DZA = DRHOI_(IPT,4,1)
           DXB = DRHOI_(IPT,2,IRU)
           DYB = DRHOI_(IPT,3,IRU)
           DZB = DRHOI_(IPT,4,IRU)
           GRADA  = DXA**TWO + DYA**TWO + DZA**TWO
           GRADB  = DXB**TWO + DYB**TWO + DZB**TWO
C
      T1 = RHOA**(4.0D+0/3.0D+0)
      T2 = GRADA**2
      T3 = 1.0D+0*RHOA**((-1.6D+1)/3.0D+0)
      T4 = 1.0D+0*RHOA**((-8.0D+0)/3.0D+0)
      T5 = 1.0D+0*RHOA**((-5.0D+0)/3.0D+0)
      T6 = 2.0D+0*T5*TA
      T7 = T6-9.11559972D+0
      T8 = 3.574822D-4*T7**2-1.282732D-4*GRADA*T4*T7-
     #2.3545180000000002D-5*T2*T3
      T9 = 1.8672599999999998D-3*(T6+GRADA*T4-9.11559972D+0)+
     #1.0D+0
      T10 = 1.0D+0/T9**3
      T11 = 6.250325999999999D-3*T7-3.5567879999999996D-3*GRADA*
     #T4
      T12 = 1.0D+0/T9**2
      T13 = -9.800683D-1/T9+T11*T12+T8*T10
      T14 = RHOB**(4.0D+0/3.0D+0)
      T15 = GRADB**2
      T16 = 1.0D+0*RHOB**((-1.6D+1)/3.0D+0)
      T17 = 1.0D+0*RHOB**((-8.0D+0)/3.0D+0)
      T18 = 1.0D+0*RHOB**((-5.0D+0)/3.0D+0)
      T19 = 2.0D+0*T18*TB
      T20 = T19-9.11559972D+0
      T21 = 3.574822D-4*T20**2-1.282732D-4*GRADB*T17*T20-
     #2.3545180000000002D-5*T15*T16
      T22 = 1.8672599999999998D-3*(T19+GRADB*T17-9.11559972D+0)+
     #1.0D+0
      T23 = 1.0D+0/T22**3
      T24 = 6.250325999999999D-3*T20-3.5567879999999996D-3*
     #GRADB*T17
      T25 = 1.0D+0/T22**2
      T26 = T24*T25+T21*T23-9.800683D-1/T22
      T27 = 1.0D+0*RHOA**((-1.1000000000000001D+1)/3.0D+0)
      T28 = -3.3333333333333337D+0*T4*TA-2.6666666666666666D+0*
     #T27*GRADA
      T29 = 1.0D+0/T9**4
      T30 = 1.0D+0*RHOA**((-1.9D+1)/3.0D+0)
      T31 = -2.383214666666667D-3*T4*TA*T7+
     #3.4206186666666666D-4*GRADA*T27*T7+4.275773333333333D-4*GRADA*T3*
     #TA+1.2557429333333334D-4*T2*T30
      T32 = 9.484767999999999D-3*GRADA*T27-
     #2.0834419999999998D-2*T4*TA
      T33 = T32*T12+1.830042333858D-3*T28*T12+T31*T10-
     #3.7345199999999995D-3*T28*T11*T10-5.60178D-3*T28*T8*T29
      T34 = RHOA**(1.0D+0/3.0D+0)
      T35 = 1.0D+0*RHOB**((-1.1000000000000001D+1)/3.0D+0)
      T36 = -3.3333333333333337D+0*T17*TB-2.6666666666666666D+0*
     #T35*GRADB
      T37 = 1.0D+0/T22**4
      T38 = 1.0D+0*RHOB**((-1.9D+1)/3.0D+0)
      T39 = -2.383214666666667D-3*T17*TB*T20+
     #3.4206186666666666D-4*GRADB*T35*T20+4.275773333333333D-4*GRADB*
     #T16*TB+1.2557429333333334D-4*T15*T38
      T40 = 9.484767999999999D-3*GRADB*T35-
     #2.0834419999999998D-2*T17*TB
      T41 = T40*T25+1.830042333858D-3*T36*T25+T39*T23-
     #3.7345199999999995D-3*T36*T24*T23-5.60178D-3*T36*T21*T37
      T42 = RHOB**(1.0D+0/3.0D+0)
      T43 = -1.282732D-4*T4*T7-4.7090360000000003D-5*GRADA*T3
      T44 = -1.726745666142D-3*T4*T12+T43*T10-
     #3.7345199999999995D-3*T4*T11*T10-5.60178D-3*T4*T8*T29
      T45 = -1.282732D-4*T17*T20-4.7090360000000003D-5*GRADB*T16
      T46 = -1.726745666142D-3*T17*T25+T45*T23-
     #3.7345199999999995D-3*T17*T24*T23-5.60178D-3*T17*T21*T37
      T47 = 1.0D+0*RHOA**((-1.3D+1)/3.0D+0)
      T48 = 1.4299288000000002D-3*T5*T7-2.565464D-4*GRADA*T47
      T49 = 1.6160736667715997D-2*T5*T12+T48*T10-
     #7.469039999999999D-3*T5*T11*T10-1.1203559999999999D-2*T5*T8*T29
      T50 = 1.0D+0*RHOB**((-1.3D+1)/3.0D+0)
      T51 = 1.4299288000000002D-3*T18*T20-2.565464D-4*GRADB*T50
      T52 = 1.6160736667715997D-2*T18*T25+T51*T23-
     #7.469039999999999D-3*T18*T24*T23-1.1203559999999999D-2*T18*T21*T37
      T53 = T28**2
      T54 = 1.0D+0/T9**5
      T55 = 1.0D+0*RHOA**((-1.3999999999999999D+1)/3.0D+0)
      T56 = 8.88888888888889D+0*T27*TA+9.777777777777779D+0*T55*
     #GRADA
      T57 = T36**2
      T58 = 1.0D+0/T22**5
      T59 = 1.0D+0*RHOB**((-1.3999999999999999D+1)/3.0D+0)
      T60 = 8.88888888888889D+0*T35*TB+9.777777777777779D+0*T59*
     #GRADB
      T61 = 1.0D+0*RHOA**((-1.0D+1)/3.0D+0)
      T62 = 1.0D+0*RHOB**((-1.0D+1)/3.0D+0)
      ENERGY = T14*T26+T1*T13
      DFDRA = 1.3333333333333333D+0*T13*T34+T1*T33
      DFDRB = 1.3333333333333333D+0*T26*T42+T14*T41
      DFDGA = T1*T44
      DFDGB = T14*T46
      DFDTA = T1*T49
      DFDTB = T14*T52
      D2FDRARA = T1*(T10*(7.944048888888889D-3*T3*TA**2-
     #3.4206186666666666D-3*GRADA*T30*TA-7.953038577777778D-4*T2*RHOA**
     #((-2.2000000000000003D+1)/3.0D+0)+6.355239111111112D-3*T27*TA*T7-
     #1.2542268444444443D-3*GRADA*T55*T7)+4.1839918891199995D-5*T53*T8*
     #T54-5.60178D-3*T56*T8*T29-1.1203559999999999D-2*T28*T31*T29+
     #2.0919959445599998D-5*T53*T11*T29+(5.555845333333332D-2*T27*TA-
     #3.4777482666666665D-2*GRADA*T55)*T12+1.830042333858D-3*T56*T12-
     #6.834329696639377D-6*T53*T10-7.469039999999999D-3*T28*T32*T10-
     #3.7345199999999995D-3*T56*T11*T10)+4.444444444444444D-1*T13*RHOA**
     #((-2.0D+0)/3.0D+0)+2.6666666666666666D+0*T33*T34
      D2FDRBRB = T14*(T23*(7.944048888888889D-3*T16*TB**2-
     #3.4206186666666666D-3*GRADB*T38*TB-7.953038577777778D-4*T15*RHOB**
     #((-2.2000000000000003D+1)/3.0D+0)+6.355239111111112D-3*T35*TB*T20-
     #1.2542268444444443D-3*GRADB*T59*T20)+4.1839918891199995D-5*T57*
     #T21*T58-1.1203559999999999D-2*T36*T39*T37+2.0919959445599998D-5*
     #T57*T24*T37-5.60178D-3*T60*T21*T37+(5.555845333333332D-2*T35*TB-
     #3.4777482666666665D-2*GRADB*T59)*T25+1.830042333858D-3*T60*T25-
     #6.834329696639377D-6*T57*T23-7.469039999999999D-3*T36*T40*T23-
     #3.7345199999999995D-3*T60*T24*T23)+4.444444444444444D-1*T26*RHOB**
     #((-2.0D+0)/3.0D+0)+2.6666666666666666D+0*T41*T42
      D2FDRAGA = 1.3333333333333333D+0*T34*T44+T1*
     #(4.604655109712D-3*T27*T12+(3.4206186666666666D-4*T27*T7+
     #4.275773333333333D-4*T3*TA+2.511485866666667D-4*GRADA*T30)*T10+
     #9.958719999999999D-3*T27*T11*T10-3.7345199999999995D-3*T4*T32*T10+
     #6.448566225120621D-6*T4*T28*T10+1.4938079999999998D-2*T27*T8*T29-
     #5.60178D-3*T4*T31*T29-5.60178D-3*T28*T43*T29+
     #2.0919959445599998D-5*T4*T28*T11*T29+4.1839918891199995D-5*T4*T28*
     #T8*T54)
      D2FDRBGB = 1.3333333333333333D+0*T42*T46+T14*
     #(4.604655109712D-3*T35*T25+(3.4206186666666666D-4*T35*T20+
     #4.275773333333333D-4*T16*TB+2.511485866666667D-4*GRADB*T38)*T23+
     #9.958719999999999D-3*T35*T24*T23-3.7345199999999995D-3*T17*T40*
     #T23+6.448566225120621D-6*T17*T36*T23+1.4938079999999998D-2*T35*
     #T21*T37-5.60178D-3*T17*T39*T37-5.60178D-3*T36*T45*T37+
     #2.0919959445599998D-5*T17*T36*T24*T37+4.1839918891199995D-5*T17*
     #T36*T21*T58)
      D2FDGAGA = T1*(-2.7358897853119385D-5*T3*T10-
     #1.1203559999999999D-2*T4*T43*T29+2.0919959445599998D-5*T3*T11*T29+
     #4.1839918891199995D-5*T3*T8*T54)
      D2FDGBGB = T14*(-2.7358897853119385D-5*T16*T23-
     #1.1203559999999999D-2*T17*T45*T37+2.0919959445599998D-5*T16*T24*
     #T37+4.1839918891199995D-5*T16*T21*T58)
      D2FDRATA = 1.3333333333333333D+0*T34*T49+T1*
     #(-2.6934561112859995D-2*T4*T12+(-2.383214666666667D-3*T4*T7-
     #4.766429333333334D-3*T47*TA+1.1117010666666666D-3*GRADA*T3)*T10+
     #1.24484D-2*T4*T11*T10-7.469039999999999D-3*T5*T32*T10-
     #6.035259430031875D-5*T5*T28*T10+1.86726D-2*T4*T8*T29-
     #1.1203559999999999D-2*T5*T31*T29-5.60178D-3*T28*T48*T29+
     #4.1839918891199995D-5*T5*T28*T11*T29+8.36798377824D-5*T5*T28*T8*
     #T54)
      D2FDRBTB = 1.3333333333333333D+0*T42*T52+T14*
     #(-2.6934561112859995D-2*T17*T25+(-2.383214666666667D-3*T17*T20-
     #4.766429333333334D-3*T50*TB+1.1117010666666666D-3*GRADB*T16)*T23+
     #1.24484D-2*T17*T24*T23-7.469039999999999D-3*T18*T40*T23-
     #6.035259430031875D-5*T18*T36*T23+1.86726D-2*T17*T21*T37-
     #1.1203559999999999D-2*T18*T39*T37-5.60178D-3*T36*T51*T37+
     #4.1839918891199995D-5*T18*T36*T24*T37+8.36798377824D-5*T18*T36*
     #T21*T58)
      D2FDGATA = T1*(-2.903332024567987D-4*T47*T10-5.60178D-3*
     #T4*T48*T29-1.1203559999999999D-2*T5*T43*T29+4.1839918891199995D-5*
     #T47*T11*T29+8.36798377824D-5*T47*T8*T54)
      D2FDGBTB = T14*(-2.903332024567987D-4*T50*T23-5.60178D-3*
     #T17*T51*T37-1.1203559999999999D-2*T18*T45*T37+
     #4.1839918891199995D-5*T50*T24*T37+8.36798377824D-5*T50*T21*T58)
      D2FDTATA = T1*(2.6457845415852826D-3*T61*T10-
     #2.2407119999999997D-2*T5*T48*T29+8.36798377824D-5*T61*T11*T29+
     #1.673596755648D-4*T61*T8*T54)
      D2FDTBTB = T14*(2.6457845415852826D-3*T62*T23-
     #2.2407119999999997D-2*T18*T51*T37+8.36798377824D-5*T62*T24*T37+
     #1.673596755648D-4*T62*T21*T58)
C
C     FUNCTIONAL EXCHANGE ENERGY
C
C
C     SECOND FUNCTIONAL DERIVATIVE
C
C
C     STORE FUNCTIONAL EXCHANGE ENERGY
C
            EXF             = EXF             + SCALE*ENERGY*XYZWGT(IPT)
            EX0(IIPT)       = EX0(IIPT)       + SCALE*ENERGY
C
C     STORE FIRST FUNCTIONAL DERIVATIVE
C
            EX (IIPT,KRA)   = EX (IIPT,KRA)   + SCALE*DFDRA
            EX (IIPT,KRB)   = EX (IIPT,KRB)   + SCALE*DFDRB
            EX (IIPT,KGA)   = EX (IIPT,KGA)   + SCALE*DFDGA
            EX (IIPT,KGB)   = EX (IIPT,KGB)   + SCALE*DFDGB
            EX (IIPT,KTA)   = EX (IIPT,KTA)   + SCALE*DFDTA
            EX (IIPT,KTB)   = EX (IIPT,KTB)   + SCALE*DFDTB
C
C     STORE SECOND FUNCTIONAL DERIVATIVE
C
            EX (IIPT,KRARA) = EX (IIPT,KRARA) + SCALE*D2FDRARA
            EX (IIPT,KRAGA) = EX (IIPT,KRAGA) + SCALE*D2FDRAGA
            EX (IIPT,KRATA) = EX (IIPT,KRATA) + SCALE*D2FDRATA
            EX (IIPT,KRBRB) = EX (IIPT,KRBRB) + SCALE*D2FDRBRB
            EX (IIPT,KRBGB) = EX (IIPT,KRBGB) + SCALE*D2FDRBGB
            EX (IIPT,KRBTB) = EX (IIPT,KRBTB) + SCALE*D2FDRBTB
            EX (IIPT,KGAGA) = EX (IIPT,KGAGA) + SCALE*D2FDGAGA
            EX (IIPT,KGATA) = EX (IIPT,KGATA) + SCALE*D2FDGATA
            EX (IIPT,KGBGB) = EX (IIPT,KGBGB) + SCALE*D2FDGBGB
            EX (IIPT,KGBTB) = EX (IIPT,KGBTB) + SCALE*D2FDGBTB
            EX (IIPT,KTATA) = EX (IIPT,KTATA) + SCALE*D2FDTATA
            EX (IIPT,KTBTB) = EX (IIPT,KTBTB) + SCALE*D2FDTBTB
C
C     END OF CODE GENERATION
C
        END IF
      END DO
      RETURN
      END
C*MODULE TDDXCD  *DECK TD_VS98C
      SUBROUTINE TD_VS98C(EC0,EC,DRHOI_,DTAUI_,XYZWGT,SCALE,
     *                       RHOMIN,ILENG,NPTGRD,IRU,IST,IEND)
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
C
      COMMON /CDERIX/ NCDIM(3),IRA,IRB,IGA,IGB,IGC,ITA,ITB,IRARA,IRARB,
     *                IRAGA,IRAGB,IRAGC,IRATA,IRATB,IRBRB,IRBGA,IRBGB,
     *                IRBGC,IRBTA,IRBTB,IGAGA,IGAGB,IGAGC,IGATA,IGATB,
     *                IGBGB,IGBGC,IGBTA,IGBTB,IGCGC,IGCTA,IGCTB,ITATA,
     *                ITATB,ITBTB,IRARARA,IRARARB,IRARAGA,IRARAGB,
     *                IRARAGC,IRARATA,IRARATB,IRARBRB,IRARBGA,IRARBGB,
     *                IRARBGC,IRARBTA,IRARBTB,IRAGAGA,IRAGAGB,IRAGAGC,
     *                IRAGATA,IRAGATB,IRAGBGB,IRAGBGC,IRAGBTA,IRAGBTB,
     *                IRAGCGC,IRAGCTA,IRAGCTB,IRATATA,IRATATB,IRATBTB,
     *                IRBRBRB,IRBRBGA,IRBRBGB,IRBRBGC,IRBRBTA,IRBRBTB,
     *                IRBGAGA,IRBGAGB,IRBGAGC,IRBGATA,IRBGATB,IRBGBGB,
     *                IRBGBGC,IRBGBTA,IRBGBTB,IRBGCGC,IRBGCTA,IRBGCTB,
     *                IRBTATA,IRBTATB,IRBTBTB,IGAGAGA,IGAGAGB,IGAGAGC,
     *                IGAGATA,IGAGATB,IGAGBGB,IGAGBGC,IGAGBTA,IGAGBTB,
     *                IGAGCGC,IGAGCTA,IGAGCTB,IGATATA,IGATATB,IGATBTB,
     *                IGBGBGB,IGBGBGC,IGBGBTA,IGBGBTB,IGBGCGC,IGBGCTA,
     *                IGBGCTB,IGBTATA,IGBTATB,IGBTBTB,IGCGCGC,IGCGCTA,
     *                IGCGCTB,IGCTATA,IGCTATB,IGCTBTB,ITATATA,ITATATB,
     *                ITATBTB,ITBTBTB
C
      DIMENSION EC(ILENG,*)
      DIMENSION EC0(*)
      DIMENSION DRHOI_(NPTGRD,4,IRU)
      DIMENSION DTAUI_(NPTGRD,IRU)
      DIMENSION XYZWGT(*)
      DATA ZERO/0.0D+0/
      DATA TWO /2.0D+0/
C
      ECF=ZERO
      DO IPT=IST,IEND
         IIPT=IPT-IST+1
         RHOA=DRHOI_(IPT,1,1)
         RHOB=DRHOI_(IPT,1,IRU)
         TA=DTAUI_(IPT,1)
         TB=DTAUI_(IPT,IRU)
C             IN THE CLOSED SHELL CASE RHOB =RHOA SINCE IRU=1
C             IN THE OPENED SHELL CASE RHOB!=RHOA SINCE IRU=2
         RHOT=RHOA + RHOB
         IF(RHOT/TWO.GT.RHOMIN) THEN
           DXA = DRHOI_(IPT,2,1)
           DYA = DRHOI_(IPT,3,1)
           DZA = DRHOI_(IPT,4,1)
           DXB = DRHOI_(IPT,2,IRU)
           DYB = DRHOI_(IPT,3,IRU)
           DZB = DRHOI_(IPT,4,IRU)
           GRADA  = DXA**TWO + DYA**TWO + DZA**TWO
           GRADB  = DXB**TWO + DYB**TWO + DZB**TWO
C---       GRADAB = DXA*DXB+DYA*DYB+DZA*DZB
C
C     FUNCTIONAL ENERGY
C
      T1 = SQRT(RHOA)
      T2 = 1.0D+0*RHOA**((-1.0D+0)/3.0D+0)
      T3 = 1.1120374863094687D+1*RHOA**((-1.0D+0)/6.0D+0)+
     #2.4058712912881913D-1*RHOA**((-2.0D+0)/3.0D+0)+
     #3.8447462374472113D+0*T2+1.6447337755676092D+0/T1
      T4 = 3.216395899738507D+1/T3+1.0D+0
      T5 = LOG(T4)
      T6 = 1.274696188700087D-1*T2+1.0D+0
      T7 = 1.0D+0/RHOA
      T8 = 1.0D+0/TA
      T9 = 1.0D+0-1.25D-1*T7*T8*GRADA
      T10 = GRADA**2
      T11 = 1.0D+0*RHOA**((-1.6D+1)/3.0D+0)
      T12 = 1.0D+0*RHOA**((-8.0D+0)/3.0D+0)
      T13 = 1.0D+0*RHOA**((-5.0D+0)/3.0D+0)
      T14 = 2.0D+0*T13*TA
      T15 = T14-9.11559972D+0
      T16 = 1.577575D-2*T15**2-5.451559D-3*GRADA*T12*T15+
     #2.1342219999999998D-3*T10*T11
      T17 = GRADA*T12
      T18 = 5.15088D-3*(T14+T17-9.11559972D+0)+1.0D+0
      T19 = 1.0D+0/T18**3
      T20 = -2.9424059999999996D-2*T15-3.228915D-2*GRADA*T12
      T21 = 1.0D+0/T18**2
      T22 = T20*T21+T16*T19+3.270912D-1/T18
      T23 = SQRT(RHOB)
      T24 = 1.0D+0*RHOB**((-1.0D+0)/3.0D+0)
      T25 = 1.1120374863094687D+1*RHOB**((-1.0D+0)/6.0D+0)+
     #2.4058712912881913D-1*RHOB**((-2.0D+0)/3.0D+0)+
     #3.8447462374472113D+0*T24+1.6447337755676092D+0/T23
      T26 = 3.216395899738507D+1/T25+1.0D+0
      T27 = LOG(T26)
      T28 = 1.274696188700087D-1*T24+1.0D+0
      T29 = 1.0D+0/RHOB
      T30 = 1.0D+0/TB
      T31 = 1.0D+0-1.25D-1*T29*T30*GRADB
      T32 = GRADB**2
      T33 = 1.0D+0*RHOB**((-1.6D+1)/3.0D+0)
      T34 = 1.0D+0*RHOB**((-8.0D+0)/3.0D+0)
      T35 = 1.0D+0*RHOB**((-5.0D+0)/3.0D+0)
      T36 = 2.0D+0*T35*TB
      T37 = T36-9.11559972D+0
      T38 = 1.577575D-2*T37**2-5.451559D-3*GRADB*T34*T37+
     #2.1342219999999998D-3*T32*T33
      T39 = GRADB*T34
      T40 = 5.15088D-3*(T36+T39-9.11559972D+0)+1.0D+0
      T41 = 1.0D+0/T40**3
      T42 = -2.9424059999999996D-2*T37-3.228915D-2*GRADB*T34
      T43 = 1.0D+0/T40**2
      T44 = T42*T43+T38*T41+3.270912D-1/T40
      T45 = RHOB+RHOA
      T46 = 1.0D+0*T45**((-1.0D+0)/3.0D+0)
      T47 = 1.3256889990520176D-1*T46+1.0D+0
      T48 = 1.0D+0*T45**((-2.0D+0)/3.0D+0)
      T49 = SQRT(T45)
      T50 = 1.0D+0/T49
      T51 = 1.0D+0*T45**((-1.0D+0)/6.0D+0)
      T52 = 5.982550435771079D+0*T51+2.2255694211506874D+0*T46+
     #8.004286349993636D-1*T50+1.8970043257475583D-1*T48
      T53 = 1.6081979498692536D+1/T52+1.0D+0
      T54 = LOG(T53)
      T55 = -6.21814D-2*T47*T54
      T56 = 1.923661050931536D+0
      T57 = RHOA-1.0D+0*RHOB
      T58 = T57**4
      T59 = 1.0D+0/T45**4
      T60 = 1.0D+0-1.0D+0*T58*T59
      T61 = 6.901399211255825D-2*T46+1.0D+0
      T62 = 1.0D+0/T45
      T63 = 1.0D+0-1.0D+0*T57*T62
      T64 = T57*T62+1.0D+0
      T65 = T64**(4.0D+0/3.0D+0)+T63**(4.0D+0/3.0D+0)-2.0D+0
      T66 = 8.157414703487641D+0*T51+2.247591863577616D+0*T46+
     #4.3009724712766434D-1*T50+1.9115125951273373D-1*T48
      T67 = 2.9608749977793436D+1/T66+1.0D+0
      T68 = LOG(T67)
      T69 = 1.9751672738097256D-2*T56*T60*T61*T65*T68
      T70 = 1.274696188700087D-1*T46+1.0D+0
      T71 = 1.1120374863094687D+1*T51+3.8447462374472113D+0*T46+
     #1.6447337755676092D+0*T50+2.4058712912881913D-1*T48
      T72 = 3.216395899738507D+1/T71+1.0D+0
      T73 = LOG(T72)
      T74 = 6.21814D-2*T47*T54-3.10907D-2*T70*T73
      T75 = T56*T58*T59*T65*T74
      T76 = T45*(T75+T69+T55)+3.10907D-2*T27*T28*RHOB+
     #3.10907D-2*T5*T6*RHOA
      T77 = T39+T17
      T78 = T36+T14-1.823119944D+1
      T79 = 1.296118D-3*T78**2-1.26942D-3*T77*T78+
     #3.3943080000000003D-5*T77**2
      T80 = 3.04966D-3*(T36+T14+T39+T17-1.823119944D+1)+1.0D+0
      T81 = 1.0D+0/T80**3
      T82 = 5.152765D-2*T78+7.694574D-3*T77
      T83 = 1.0D+0/T80**2
      T84 = T82*T83+T79*T81+7.03501D-1/T80
      T85 = 1.0D+0*RHOA**((-1.1000000000000001D+1)/3.0D+0)
      T86 = -3.3333333333333337D+0*T12*TA-2.6666666666666666D+0*
     #T85*GRADA
      T87 = 1.0D+0/T18**4
      T88 = 1.0D+0*RHOA**((-1.9D+1)/3.0D+0)
      T89 = -1.0517166666666668D-1*T12*TA*T15+
     #1.4537490666666666D-2*GRADA*T85*T15+1.8171863333333332D-2*GRADA*
     #T11*TA-1.1382517333333331D-2*T10*T88
      T90 = 9.80802D-2*T12*TA+8.610439999999999D-2*GRADA*T85
      T91 = T90*T21-1.684807520256D-3*T86*T21+T89*T19-
     #1.030176D-2*T86*T20*T19-1.5452639999999998D-2*T86*T16*T87
      T92 = 1.0D+0/T4
      T93 = 1.0D+0*RHOA**((-4.0D+0)/3.0D+0)
      T94 = -1.8533958105157808D+0*RHOA**((-7.0D+0)/6.0D+0)-
     #1.2815820791490704D+0*T93-1.6039141941921276D-1*T13-
     #8.223668877838046D-1/T1**3
      T95 = 1.0D+0/T3**2
      T96 = 1.0D+0/T80**4
      T97 = -8.640786666666667D-3*T12*TA*T78+3.38512D-3*GRADA*
     #T85*T78+4.2314000000000007D-3*T12*T77*TA-1.8102976D-4*GRADA*T85*
     #T77
      T98 = -1.7175883333333333D-1*T12*TA-2.0518863999999998D-2*
     #GRADA*T85
      T99 = T98*T83-2.1454388596600002D-3*T86*T83+T97*T81-
     #6.09932D-3*T86*T82*T81-9.148980000000001D-3*T86*T79*T96
      T100 = 1.0D+0*T45**((-5.0D+0)/3.0D+0)
      T101 = 1.0D+0/T49**3
      T102 = 1.0D+0*T45**((-4.0D+0)/3.0D+0)
      T103 = 1.0D+0*T45**((-7.0D+0)/6.0D+0)
      T104 = -9.970917392951799D-1*T103-7.418564737168958D-1*
     #T102-4.002143174996818D-1*T101-1.264669550498372D-1*T100
      T105 = 1.0D+0/T52**2
      T106 = 1.0D+0/T53
      T107 = 1.0D+0*T104*T47*T105*T106
      T108 = -1.3595691172479402D+0*T103-7.491972878592053D-1*
     #T102-2.1504862356383217D-1*T101-1.2743417300848914D-1*T100
      T109 = 1.0D+0/T66**2
      T110 = 1.0D+0/T67
      T111 = -5.848223397455204D-1*T56*T60*T108*T61*T109*T65*
     #T110
      T112 = 2.747773264188437D-3*T102*T54
      T113 = 1.0D+0/T45**2
      T114 = T57*T113
      T115 = -1.0D+0*T62
      T116 = T115+T114
      T117 = T63**(1.0D+0/3.0D+0)
      T118 = -1.0D+0*T113*T57
      T119 = T62+T118
      T120 = T64**(1.0D+0/3.0D+0)
      T121 = 1.3333333333333333D+0*T119*T120+
     #1.3333333333333333D+0*T116*T117
      T122 = 1.9751672738097256D-2*T56*T60*T61*T121*T68
      T123 = -4.543805955189586D-4*T56*T102*T60*T65*T68
      T124 = 1.0D+0/T45**5
      T125 = 4.0D+0*T124*T58
      T126 = T57**3
      T127 = T125-4.0D+0*T126*T59
      T128 = 1.9751672738097256D-2*T56*T127*T61*T65*T68
      T129 = -1.8533958105157808D+0*T103-1.2815820791490704D+0*
     #T102-8.223668877838046D-1*T101-1.6039141941921276D-1*T100
      T130 = 1.0D+0/T71**2
      T131 = 1.0D+0/T72
      T132 = 1.3210398931339262D-3*T102*T73-
     #2.747773264188437D-3*T102*T54+1.0D+0*T129*T70*T130*T131-1.0D+0*
     #T104*T47*T105*T106
      T133 = T56*T58*T59*T65*T132
      T134 = T56*T58*T59*T121*T74
      T135 = -4.0D+0*T124*T56*T58*T65*T74
      T136 = -1.0D+0*T92*T94*T6*T95*RHOA+T75+T45*(4.0D+0*T126*
     #T56*T59*T65*T74+T135+T134+T133+T128+T123+T122+T112+T111+T107)+T69+
     #3.10907D-2*T5*T6+T55-1.3210398931339262D-3*T5*T2
      T137 = 1.0D+0*RHOB**((-1.1000000000000001D+1)/3.0D+0)
      T138 = -3.3333333333333337D+0*T34*TB-
     #2.6666666666666666D+0*T137*GRADB
      T139 = 1.0D+0/T40**4
      T140 = 1.0D+0*RHOB**((-1.9D+1)/3.0D+0)
      T141 = -1.0517166666666668D-1*T34*TB*T37+
     #1.4537490666666666D-2*GRADB*T137*T37+1.8171863333333332D-2*GRADB*
     #T33*TB-1.1382517333333331D-2*T32*T140
      T142 = 9.80802D-2*T34*TB+8.610439999999999D-2*GRADB*T137
      T143 = T142*T43-1.684807520256D-3*T138*T43+T141*T41-
     #1.030176D-2*T138*T42*T41-1.5452639999999998D-2*T138*T38*T139
      T144 = 1.0D+0/T26
      T145 = 1.0D+0*RHOB**((-4.0D+0)/3.0D+0)
      T146 = -1.8533958105157808D+0*RHOB**((-7.0D+0)/6.0D+0)-
     #1.6039141941921276D-1*T35-8.223668877838046D-1/T23**3-
     #1.2815820791490704D+0*T145
      T147 = 1.0D+0/T25**2
      T148 = -8.640786666666667D-3*T34*TB*T78+3.38512D-3*GRADB*
     #T137*T78+4.2314000000000007D-3*T77*T34*TB-1.8102976D-4*GRADB*T77*
     #T137
      T149 = -1.7175883333333333D-1*T34*TB-
     #2.0518863999999998D-2*GRADB*T137
      T150 = T149*T83-2.1454388596600002D-3*T138*T83+T148*T81-
     #6.09932D-3*T138*T82*T81-9.148980000000001D-3*T138*T79*T96
      T151 = T62+T114
      T152 = T115+T118
      T153 = 1.3333333333333333D+0*T120*T152+
     #1.3333333333333333D+0*T117*T151
      T154 = 1.9751672738097256D-2*T56*T60*T61*T153*T68
      T155 = 4.0D+0*T126*T59+T125
      T156 = 1.9751672738097256D-2*T56*T155*T61*T65*T68
      T157 = T56*T58*T59*T153*T74
      T158 = -1.0D+0*T144*T146*T28*T147*RHOB+T75+T45*(-4.0D+0*
     #T126*T56*T59*T65*T74+T157+T156+T154+T135+T133+T123+T112+T111+
     #T107)+T69+T55+3.10907D-2*T27*T28-1.3210398931339262D-3*T27*T24
      T159 = 4.2684439999999996D-3*GRADA*T11-5.451559D-3*T12*T15
      T160 = -3.3973957520256004D-2*T12*T21+T159*T19-
     #1.030176D-2*T12*T20*T19-1.5452639999999998D-2*T12*T16*T87
      T161 = 6.788616000000001D-5*T12*T77-1.26942D-3*T12*T78
      T162 = 5.54913514034D-3*T12*T83+T161*T81-6.09932D-3*T12*
     #T82*T81-9.148980000000001D-3*T12*T79*T96
      T163 = 4.2684439999999996D-3*GRADB*T33-5.451559D-3*T34*T37
      T164 = -3.3973957520256004D-2*T34*T43+T163*T41-
     #1.030176D-2*T34*T42*T41-1.5452639999999998D-2*T34*T38*T139
      T165 = 6.788616000000001D-5*T77*T34-1.26942D-3*T34*T78
      T166 = 5.54913514034D-3*T34*T83+T165*T81-6.09932D-3*T34*
     #T82*T81-9.148980000000001D-3*T34*T79*T96
      T167 = 1.0D+0*RHOA**((-1.3D+1)/3.0D+0)
      T168 = 6.310300000000001D-2*T13*T15-1.0903117999999999D-2*
     #GRADA*T167
      T169 = -6.2217735040512D-2*T13*T21+T168*T19-2.060352D-2*
     #T13*T20*T19-3.0905279999999996D-2*T13*T16*T87
      T170 = TA**2
      T171 = 1.0D+0/T170
      T172 = 5.184472D-3*T13*T78-2.53884D-3*T13*T77
      T173 = 9.876442228068D-2*T13*T83+T172*T81-1.219864D-2*T13*
     #T82*T81-1.8297960000000002D-2*T13*T79*T96
      T174 = 1.0D+0*RHOB**((-1.3D+1)/3.0D+0)
      T175 = 6.310300000000001D-2*T35*T37-1.0903117999999999D-2*
     #GRADB*T174
      T176 = -6.2217735040512D-2*T35*T43+T175*T41-2.060352D-2*
     #T35*T42*T41-3.0905279999999996D-2*T35*T38*T139
      T177 = TB**2
      T178 = 1.0D+0/T177
      T179 = 5.184472D-3*T35*T78-2.53884D-3*T77*T35
      T180 = 9.876442228068D-2*T35*T83+T179*T81-1.219864D-2*T35*
     #T82*T81-1.8297960000000002D-2*T35*T79*T96
      T181 = 1.0D+0*RHOA**((-7.0D+0)/3.0D+0)
      T182 = 1.0D+0/T4**2
      T183 = T94**2
      T184 = 1.0D+0/T3**4
      T185 = 1.0D+0/T3**3
      T186 = 2.1622951122684114D+0*RHOA**((-1.3D+1)/6.0D+0)+
     #1.7087761055320938D+0*T181+2.673190323653546D-1*T12+
     #1.2335503316757071D+0/T1**5
      T187 = T86**2
      T188 = 1.0D+0/T18**5
      T189 = 1.0D+0*RHOA**((-1.3999999999999999D+1)/3.0D+0)
      T190 = 8.88888888888889D+0*T85*TA+9.777777777777779D+0*
     #T189*GRADA
      T191 = 1.0D+0*RHOA**((-2.2000000000000003D+1)/3.0D+0)
      T192 = 1.0D+0/T80**5
      T193 = 2.0D+0*T104*T47*T105*T106
      T194 = -1.1696446794910409D+0*T56*T60*T108*T61*T109*T65*
     #T110
      T195 = 5.495546528376875D-3*T102*T54
      T196 = -9.087611910379172D-4*T56*T102*T60*T65*T68
      T197 = 2.0D+0*T132*T56*T58*T59*T65
      T198 = -8.0D+0*T124*T56*T58*T65*T74
      T199 = T104**2
      T200 = 1.0D+0/T52**4
      T201 = 1.0D+0/T53**2
      T202 = 1.6081979498692536D+1*T199*T47*T200*T201
      T203 = 1.0D+0/T52**3
      T204 = -2.0D+0*T199*T47*T203*T106
      T205 = -8.837926660346784D-2*T102*T104*T105*T106
      T206 = 1.0D+0*T45**((-8.0D+0)/3.0D+0)
      T207 = 1.0D+0/T49**5
      T208 = 1.0D+0*T45**((-7.0D+0)/3.0D+0)
      T209 = 1.0D+0*T45**((-1.3D+1)/6.0D+0)
      T210 = 1.1632736958443765D+0*T209+9.89141964955861D-1*
     #T208+6.003214762495227D-1*T207+2.1077825841639536D-1*T206
      T211 = 1.0D+0*T210*T47*T105*T106
      T212 = T108**2
      T213 = -1.7315858438953285D+1*T212*T56*T60*T61*T65/(T66**
     #4*T67**2)
      T214 = 1.1696446794910409D+0*T110*T212*T56*T60*T61*T65/
     #T66**3
      T215 = 2.690728289496347D-2*T56*T102*T60*T108*T109*T65*
     #T110
      T216 = -5.848223397455204D-1*T56*T60*
     #(1.5861639701225969D+0*T209+9.98929717145607D-1*T208+
     #3.2257293534574827D-1*T207+2.1239028834748191D-1*T206)*T61*T109*
     #T65*T110
      T217 = -3.663697685584583D-3*T208*T54
      T218 = 1.0D+0*T63**((-2.0D+0)/3.0D+0)
      T219 = 1.0D+0/T45**3
      T220 = -2.0D+0*T219*T57
      T221 = 2.0D+0*T113
      T222 = 1.0D+0*T64**((-2.0D+0)/3.0D+0)
      T223 = 2.0D+0*T219*T57
      T224 = -2.0D+0*T113
      T225 = 1.3333333333333333D+0*T120*(T224+T223)+
     #4.444444444444444D-1*T119**2*T222+1.3333333333333333D+0*T117*
     #(T221+T220)+4.444444444444444D-1*T116**2*T218
      T226 = 6.058407940252781D-4*T56*T208*T60*T65*T68
      T227 = 1.0D+0/T45**6
      T228 = -2.0D+1*T227*T58
      T229 = T57**2
      T230 = -1.2D+1*T229*T59
      T231 = T129**2
      T232 = T56*T58*T59*T65*(-1.7613865241785684D-3*T208*T73+
     #3.216395899738507D+1*T231*T70/(T71**4*T72**2)-2.0D+0*T131*T231*
     #T70/T71**3+3.663697685584583D-3*T208*T54-1.6081979498692536D+1*
     #T199*T47*T200*T201+1.0D+0*(2.1622951122684114D+0*T209+
     #1.7087761055320938D+0*T208+1.2335503316757071D+0*T207+
     #2.673190323653546D-1*T206)*T70*T130*T131-8.497974591333913D-2*
     #T102*T129*T130*T131+2.0D+0*T199*T47*T203*T106-1.0D+0*T210*T47*
     #T105*T106+8.837926660346784D-2*T102*T104*T105*T106)
      T233 = -8.0D+0*T124*T132*T56*T58*T65
      T234 = 2.0D+1*T227*T56*T58*T65*T74
      T235 = 1.2D+1*T229*T56*T59*T65*T74
      T236 = 2.6666666666666666D+0*T120*T219*T57-
     #2.6666666666666666D+0*T117*T219*T57+4.444444444444444D-1*T119*
     #T152*T222+4.444444444444444D-1*T116*T151*T218
      T237 = 1.0D+0*RHOB**((-7.0D+0)/3.0D+0)
      T238 = 1.0D+0/T26**2
      T239 = T146**2
      T240 = 1.0D+0/T25**4
      T241 = 1.0D+0/T25**3
      T242 = 2.1622951122684114D+0*RHOB**((-1.3D+1)/6.0D+0)+
     #2.673190323653546D-1*T34+1.7087761055320938D+0*T237+
     #1.2335503316757071D+0/T23**5
      T243 = 1.3333333333333333D+0*T117*(T224+T220)+
     #4.444444444444444D-1*T152**2*T222+1.3333333333333333D+0*T120*
     #(T221+T223)+4.444444444444444D-1*T151**2*T218
      T244 = T138**2
      T245 = 1.0D+0*RHOB**((-1.3999999999999999D+1)/3.0D+0)
      T246 = 8.88888888888889D+0*T137*TB+9.777777777777779D+0*
     #T245*GRADB
      T247 = 1.0D+0*RHOB**((-2.2000000000000003D+1)/3.0D+0)
      T248 = 1.0D+0/T40**5
      T249 = 1.0D+0*RHOA**((-1.0D+1)/3.0D+0)
      T250 = 1.0D+0*RHOB**((-1.0D+1)/3.0D+0)
      ENERGY = T76*T84-3.10907D-2*T27*T28*RHOB*T31*T44-
     #3.10907D-2*T5*T6*RHOA*T9*T22
      DFDRA = T136*T84+T76*T99+1.0D+0*T92*T94*T6*T95*RHOA*T9*
     #T22+1.3210398931339262D-3*T5*T2*T9*T22-3.10907D-2*T5*T6*T9*T22-
     #3.8863375D-3*GRADA*T5*T6*T7*T8*T22-3.10907D-2*T5*T6*RHOA*T9*T91
      DFDRB = T158*T84+T76*T150+1.0D+0*T144*T146*T28*T147*RHOB*
     #T31*T44+1.3210398931339262D-3*T27*T24*T31*T44-3.10907D-2*T27*T28*
     #T31*T44-3.8863375D-3*GRADB*T27*T28*T29*T30*T44-3.10907D-2*T27*T28*
     #RHOB*T31*T143
      DFDGA = T76*T162+3.8863375D-3*T5*T6*T8*T22-3.10907D-2*T5*
     #T6*RHOA*T9*T160
      DFDGC = 0.0D+0
      DFDGB = T76*T166+3.8863375D-3*T27*T28*T30*T44-3.10907D-2*
     #T27*T28*RHOB*T31*T164
      DFDTA = T76*T173-3.8863375D-3*GRADA*T5*T6*T171*T22-
     #3.10907D-2*T5*T6*RHOA*T9*T169
      DFDTB = T76*T180-3.8863375D-3*GRADB*T27*T28*T178*T44-
     #3.10907D-2*T27*T28*RHOB*T31*T176
      D2FDRARA = T84*(-1.0D+0*T92*T186*T6*T95*RHOA+2.0D+0*T92*
     #T183*T6*T185*RHOA-3.216395899738507D+1*T182*T183*T6*T184*RHOA-
     #2.0D+0*T92*T94*T6*T95-8.806932620892842D-4*T5*T93+T45*(-3.2D+1*
     #T124*T126*T56*T65*T74+8.0D+0*T121*T126*T56*T59*T74-8.0D+0*T121*
     #T124*T56*T58*T74+T56*T58*T59*T225*T74+1.9751672738097256D-2*(T230+
     #T228+3.2D+1*T124*T126)*T56*T61*T65*T68-9.087611910379172D-4*T56*
     #T102*T127*T65*T68+1.9751672738097256D-2*T56*T60*T61*T225*T68+
     #3.950334547619451D-2*T56*T127*T61*T121*T68-9.087611910379172D-4*
     #T56*T102*T60*T121*T68+8.0D+0*T126*T132*T56*T59*T65+2.0D+0*T121*
     #T132*T56*T58*T59+T235+T234+T233+T232+T226+T217+T216+T215+T214+
     #T213+T211+T205+T204+T202-1.1696446794910409D+0*T56*T127*T108*T61*
     #T109*T65*T110-1.1696446794910409D+0*T56*T60*T108*T61*T109*T121*
     #T110)+8.0D+0*T126*T56*T59*T65*T74+2.0D+0*T121*T56*T58*T59*T74+
     #3.950334547619451D-2*T56*T127*T61*T65*T68+3.950334547619451D-2*
     #T56*T60*T61*T121*T68+8.497974591333913D-2*T92*T94*T95*T2+T198+
     #T197+T196+T195+T194+T193)+2.0D+0*T136*T99+2.0D+0*T92*T94*T6*T95*
     #RHOA*T9*T91-6.21814D-2*T5*T6*T9*T91+2.6420797862678524D-3*T5*T2*
     #T9*T91-7.772675D-3*GRADA*T5*T6*T7*T8*T91+T76*
     #(-2.1454388596600002D-3*T190*T83+(4.580235555555555D-1*T85*TA+
     #7.523583466666666D-2*GRADA*T189)*T83+(2.3042097777777776D-2*T85*
     #TA*T78-1.2412106666666667D-2*GRADA*T189*T78+2.8802622222222224D-2*
     #T11*T170-1.1283733333333333D-2*T85*T77*TA-2.2567466666666666D-2*
     #GRADA*T88*TA+6.637757866666666D-4*GRADA*T189*T77+
     #4.827460266666666D-4*T10*T191)*T81-6.09932D-3*T190*T82*T81-
     #1.219864D-2*T86*T98*T81+1.3085718145501432D-5*T187*T81-
     #9.148980000000001D-3*T190*T79*T96-1.8297960000000002D-2*T86*T97*
     #T96+5.58025566936D-5*T187*T82*T96+1.1160511338720001D-4*T187*T79*
     #T192)+1.0D+0*T92*T186*T6*T95*RHOA*T9*T22-2.0D+0*T92*T183*T6*T185*
     #RHOA*T9*T22+3.216395899738507D+1*T182*T183*T6*T184*RHOA*T9*T22+
     #2.0D+0*T92*T94*T6*T95*T9*T22+8.806932620892842D-4*T5*T93*T9*T22-
     #8.497974591333913D-2*T92*T94*T95*T2*T9*T22+2.5D-1*GRADA*T92*T94*
     #T6*T95*T7*T8*T22+3.302599732834816D-4*GRADA*T5*T181*T8*T22-
     #3.10907D-2*T5*T6*RHOA*T9*(T19*(3.505722222222223D-1*T11*T170+
     #2.804577777777778D-1*T85*TA*T15-5.330413244444444D-2*GRADA*T189*
     #T15-1.4537490666666666D-1*GRADA*T88*TA+7.208927644444443D-2*T10*
     #T191)-1.684807520256D-3*T190*T21+(-2.615472D-1*T85*TA-
     #3.157161333333333D-1*GRADA*T189)*T21-1.030176D-2*T190*T20*T19-
     #2.060352D-2*T86*T90*T19+1.7356482719872451D-5*T187*T19-
     #1.5452639999999998D-2*T190*T16*T87-3.0905279999999996D-2*T86*T89*
     #T87+1.591893886464D-4*T187*T20*T87+3.183787772928D-4*T187*T16*
     #T188)
      D2FDRARB = T158*T99+(T45*(-1.2D+1*T229*T56*T59*T65*T74+
     #4.0D+0*T126*T153*T56*T59*T74-4.0D+0*T121*T126*T56*T59*T74-4.0D+0*
     #T124*T153*T56*T58*T74-4.0D+0*T121*T124*T56*T58*T74+T56*T58*T59*
     #T236*T74+1.9751672738097256D-2*T56*(1.2D+1*T229*T59+T228)*T61*T65*
     #T68-4.543805955189586D-4*T56*T102*T155*T65*T68-
     #4.543805955189586D-4*T56*T102*T127*T65*T68+1.9751672738097256D-2*
     #T56*T60*T61*T236*T68+1.9751672738097256D-2*T56*T127*T61*T153*T68-
     #4.543805955189586D-4*T56*T102*T60*T153*T68+1.9751672738097256D-2*
     #T56*T155*T61*T121*T68-4.543805955189586D-4*T56*T102*T60*T121*T68+
     #T234+T233+T232+T226+T217+T216+T215+T214+T213+T211+T205+T204+T202+
     #T56*T58*T59*T153*T132+T56*T58*T59*T121*T132-5.848223397455204D-1*
     #T56*T155*T108*T61*T109*T65*T110-5.848223397455204D-1*T56*T127*
     #T108*T61*T109*T65*T110-5.848223397455204D-1*T56*T60*T108*T61*T109*
     #T153*T110-5.848223397455204D-1*T56*T60*T108*T61*T109*T121*T110)+
     #T198+T197+T196+T195+T194+T193+T157+T156+T154+T134+T128+T122)*T84+
     #T76*((2.8802622222222224D-2*T12*T34*TA*TB-1.1283733333333333D-2*
     #GRADA*T85*T34*TB-1.1283733333333333D-2*GRADB*T12*T137*TA+
     #4.827460266666666D-4*GRADA*GRADB*T85*T137)*T81-6.09932D-3*T86*
     #T149*T81-6.09932D-3*T98*T138*T81+1.3085718145501432D-5*T86*T138*
     #T81-9.148980000000001D-3*T86*T148*T96-9.148980000000001D-3*T138*
     #T97*T96+5.58025566936D-5*T86*T138*T82*T96+1.1160511338720001D-4*
     #T86*T138*T79*T192)+T136*T150
      D2FDRBRB = T84*(2.0D+0*T144*T239*T28*T241*RHOB-
     #3.216395899738507D+1*T238*T239*T28*T240*RHOB-1.0D+0*T144*T242*T28*
     #T147*RHOB+T45*(3.2D+1*T124*T126*T56*T65*T74-8.0D+0*T126*T153*T56*
     #T59*T74-8.0D+0*T124*T153*T56*T58*T74+T56*T58*T59*T243*T74+
     #1.9751672738097256D-2*(T230+T228-3.2D+1*T124*T126)*T56*T61*T65*
     #T68-9.087611910379172D-4*T56*T102*T155*T65*T68+
     #1.9751672738097256D-2*T56*T60*T61*T243*T68+3.950334547619451D-2*
     #T56*T155*T61*T153*T68-9.087611910379172D-4*T56*T102*T60*T153*T68-
     #8.0D+0*T126*T132*T56*T59*T65+2.0D+0*T132*T153*T56*T58*T59+T235+
     #T234+T233+T232+T226+T217+T216+T215+T214+T213+T211+T205+T204+T202-
     #1.1696446794910409D+0*T56*T155*T108*T61*T109*T65*T110-
     #1.1696446794910409D+0*T56*T60*T108*T61*T109*T153*T110)-8.0D+0*
     #T126*T56*T59*T65*T74+2.0D+0*T153*T56*T58*T59*T74+
     #3.950334547619451D-2*T56*T155*T61*T65*T68+3.950334547619451D-2*
     #T56*T60*T61*T153*T68+8.497974591333913D-2*T144*T146*T147*T24+T198+
     #T197+T196+T195+T194+T193-2.0D+0*T144*T146*T28*T147-
     #8.806932620892842D-4*T27*T145)-2.0D+0*T144*T239*T28*T241*RHOB*T31*
     #T44+3.216395899738507D+1*T238*T239*T28*T240*RHOB*T31*T44+1.0D+0*
     #T144*T242*T28*T147*RHOB*T31*T44-8.497974591333913D-2*T144*T146*
     #T147*T24*T31*T44+2.0D+0*T144*T146*T28*T147*T31*T44+
     #8.806932620892842D-4*T27*T145*T31*T44+2.5D-1*GRADB*T144*T146*T28*
     #T147*T29*T30*T44+3.302599732834816D-4*GRADB*T27*T237*T30*T44-
     #3.10907D-2*T27*T28*RHOB*T31*(T41*(3.505722222222223D-1*T33*T177+
     #2.804577777777778D-1*T137*TB*T37-5.330413244444444D-2*GRADB*T245*
     #T37-1.4537490666666666D-1*GRADB*T140*TB+7.208927644444443D-2*T32*
     #T247)-1.684807520256D-3*T246*T43+(-2.615472D-1*T137*TB-
     #3.157161333333333D-1*GRADB*T245)*T43-1.030176D-2*T246*T42*T41-
     #2.060352D-2*T138*T142*T41+1.7356482719872451D-5*T244*T41-
     #1.5452639999999998D-2*T246*T38*T139-3.0905279999999996D-2*T138*
     #T141*T139+1.591893886464D-4*T244*T42*T139+3.183787772928D-4*T244*
     #T38*T248)+T76*(T81*(2.8802622222222224D-2*T33*T177+
     #2.3042097777777776D-2*T137*TB*T78-1.2412106666666667D-2*GRADB*
     #T245*T78-1.1283733333333333D-2*T77*T137*TB-2.2567466666666666D-2*
     #GRADB*T140*TB+6.637757866666666D-4*GRADB*T77*T245+
     #4.827460266666666D-4*T32*T247)-2.1454388596600002D-3*T246*T83+
     #(4.580235555555555D-1*T137*TB+7.523583466666666D-2*GRADB*T245)*
     #T83-6.09932D-3*T246*T82*T81-1.219864D-2*T138*T149*T81+
     #1.3085718145501432D-5*T244*T81-9.148980000000001D-3*T246*T79*T96-
     #1.8297960000000002D-2*T138*T148*T96+5.58025566936D-5*T244*T82*T96+
     #1.1160511338720001D-4*T244*T79*T192)+2.0D+0*T150*T158+2.0D+0*T144*
     #T146*T28*T147*RHOB*T31*T143-6.21814D-2*T27*T28*T31*T143+
     #2.6420797862678524D-3*T27*T24*T31*T143-7.772675D-3*GRADB*T27*T28*
     #T29*T30*T143
      D2FDRAGA = T136*T162+T76*(-1.4797693707573328D-2*T85*T83+
     #(3.38512D-3*T85*T78+4.2314000000000007D-3*T11*TA-1.8102976D-4*T85*
     #T77-1.8102976D-4*GRADA*T88)*T81+1.6264853333333332D-2*T85*T82*T81-
     #6.09932D-3*T12*T98*T81-3.384595094417856D-5*T12*T86*T81+
     #2.439728D-2*T85*T79*T96-9.148980000000001D-3*T12*T97*T96-
     #9.148980000000001D-3*T86*T161*T96+5.58025566936D-5*T12*T86*T82*
     #T96+1.1160511338720001D-4*T12*T86*T79*T192)-1.651299866417408D-4*
     #T5*T93*T8*T22-1.25D-1*T92*T94*T6*T95*T8*T22+3.8863375D-3*T5*T6*T8*
     #T91+1.0D+0*T92*T94*T6*T95*RHOA*T9*T160+1.3210398931339262D-3*T5*
     #T2*T9*T160-3.10907D-2*T5*T6*T9*T160-3.8863375D-3*GRADA*T5*T6*T7*
     #T8*T160-3.10907D-2*T5*T6*RHOA*T9*(9.059722005401599D-2*T85*T21+
     #(1.4537490666666666D-2*T85*T15+1.8171863333333332D-2*T11*TA-
     #2.2765034666666661D-2*GRADA*T88)*T19+2.747136D-2*T85*T20*T19-
     #1.030176D-2*T12*T90*T19+3.4999155662387244D-4*T12*T86*T19+
     #4.120704D-2*T85*T16*T87-1.5452639999999998D-2*T12*T89*T87-
     #1.5452639999999998D-2*T86*T159*T87+1.591893886464D-4*T12*T86*T20*
     #T87+3.183787772928D-4*T12*T86*T16*T188)
      D2FDRAGC = 0.0D+0
      D2FDRAGB = T136*T166+T76*((4.2314000000000007D-3*T12*T34*
     #TA-1.8102976D-4*GRADA*T85*T34)*T81-6.09932D-3*T34*T98*T81-
     #3.384595094417856D-5*T34*T86*T81-9.148980000000001D-3*T34*T97*T96-
     #9.148980000000001D-3*T86*T165*T96+5.58025566936D-5*T34*T86*T82*
     #T96+1.1160511338720001D-4*T34*T86*T79*T192)
      D2FDRBGA = T158*T162+T76*((4.2314000000000007D-3*T12*T34*
     #TB-1.8102976D-4*GRADB*T12*T137)*T81-6.09932D-3*T12*T149*T81-
     #3.384595094417856D-5*T12*T138*T81-9.148980000000001D-3*T12*T148*
     #T96-9.148980000000001D-3*T138*T161*T96+5.58025566936D-5*T12*T138*
     #T82*T96+1.1160511338720001D-4*T12*T138*T79*T192)
      D2FDRBGC = 0.0D+0
      D2FDRBGB = T158*T166+T76*(-1.4797693707573328D-2*T137*T83+
     #(3.38512D-3*T137*T78+4.2314000000000007D-3*T33*TB-1.8102976D-4*
     #T77*T137-1.8102976D-4*GRADB*T140)*T81+1.6264853333333332D-2*T137*
     #T82*T81-6.09932D-3*T34*T149*T81-3.384595094417856D-5*T34*T138*T81+
     #2.439728D-2*T137*T79*T96-9.148980000000001D-3*T34*T148*T96-
     #9.148980000000001D-3*T138*T165*T96+5.58025566936D-5*T34*T138*T82*
     #T96+1.1160511338720001D-4*T34*T138*T79*T192)-1.651299866417408D-4*
     #T27*T145*T30*T44-1.25D-1*T144*T146*T28*T147*T30*T44+3.8863375D-3*
     #T27*T28*T30*T143+1.0D+0*T144*T146*T28*T147*RHOB*T31*T164+
     #1.3210398931339262D-3*T27*T24*T31*T164-3.10907D-2*T27*T28*T31*
     #T164-3.8863375D-3*GRADB*T27*T28*T29*T30*T164-3.10907D-2*T27*T28*
     #RHOB*T31*(9.059722005401599D-2*T137*T43+(1.4537490666666666D-2*
     #T137*T37+1.8171863333333332D-2*T33*TB-2.2765034666666661D-2*GRADB*
     #T140)*T41+2.747136D-2*T137*T42*T41-1.030176D-2*T34*T142*T41+
     #3.4999155662387244D-4*T34*T138*T41+4.120704D-2*T137*T38*T139-
     #1.5452639999999998D-2*T34*T141*T139-1.5452639999999998D-2*T138*
     #T163*T139+1.591893886464D-4*T34*T138*T42*T139+3.183787772928D-4*
     #T34*T138*T38*T248)
      D2FDGAGA = T76*(-1.2891460033858562D-5*T11*T81-
     #1.8297960000000002D-2*T12*T161*T96+5.58025566936D-5*T11*T82*T96+
     #1.1160511338720001D-4*T11*T79*T192)+7.772675D-3*T5*T6*T8*T160-
     #3.10907D-2*T5*T6*RHOA*T9*(4.9510706305278723D-3*T11*T19-
     #3.0905279999999996D-2*T12*T159*T87+1.591893886464D-4*T11*T20*T87+
     #3.183787772928D-4*T11*T16*T188)
      D2FDGAGC = 0.0D+0
      D2FDGAGB = T76*(-1.2891460033858562D-5*T12*T34*T81-
     #9.148980000000001D-3*T12*T165*T96-9.148980000000001D-3*T34*T161*
     #T96+5.58025566936D-5*T12*T34*T82*T96+1.1160511338720001D-4*T12*
     #T34*T79*T192)
      D2FDGCGC = 0.0D+0
      D2FDGBGC = 0.0D+0
      D2FDGBGB = T76*(-1.2891460033858562D-5*T33*T81-
     #1.8297960000000002D-2*T34*T165*T96+5.58025566936D-5*T33*T82*T96+
     #1.1160511338720001D-4*T33*T79*T192)+7.772675D-3*T27*T28*T30*T164-
     #3.10907D-2*T27*T28*RHOB*T31*(4.9510706305278723D-3*T33*T41-
     #3.0905279999999996D-2*T34*T163*T139+1.591893886464D-4*T33*T42*
     #T139+3.183787772928D-4*T33*T38*T248)
      D2FDRATA = T136*T173+T76*(-1.646073704678D-1*T12*T83+
     #(-8.640786666666667D-3*T12*T78-1.7281573333333333D-2*T167*TA+
     #4.2314000000000007D-3*T12*T77+6.77024D-3*GRADA*T11)*T81+
     #2.0331066666666667D-2*T12*T82*T81-1.219864D-2*T13*T98*T81-
     #6.023958161049972D-4*T13*T86*T81+3.04966D-2*T12*T79*T96-
     #1.8297960000000002D-2*T13*T97*T96-9.148980000000001D-3*T86*T172*
     #T96+1.1160511338720001D-4*T13*T86*T82*T96+2.2321022677440003D-4*
     #T13*T86*T79*T192)+1.651299866417408D-4*GRADA*T5*T93*T171*T22+
     #1.25D-1*GRADA*T92*T94*T6*T95*T171*T22-3.8863375D-3*GRADA*T5*T6*
     #T171*T91+1.0D+0*T92*T94*T6*T95*RHOA*T9*T169+1.3210398931339262D-3*
     #T5*T2*T9*T169-3.10907D-2*T5*T6*T9*T169-3.8863375D-3*GRADA*T5*T6*
     #T7*T8*T169-3.10907D-2*T5*T6*RHOA*T9*(1.0369622506751999D-1*T12*
     #T21+(-1.0517166666666668D-1*T12*T15-2.1034333333333335D-1*T167*TA+
     #4.724684466666666D-2*GRADA*T11)*T19+3.43392D-2*T12*T20*T19-
     #2.060352D-2*T13*T90*T19+6.409521741309449D-4*T13*T86*T19+
     #5.15088D-2*T12*T16*T87-3.0905279999999996D-2*T13*T89*T87-
     #1.5452639999999998D-2*T86*T168*T87+3.183787772928D-4*T13*T86*T20*
     #T87+6.367575545856D-4*T13*T86*T16*T188)
      D2FDRBTA = T158*T173+T76*((6.77024D-3*GRADB*T13*T137-
     #1.7281573333333333D-2*T13*T34*TB)*T81-1.219864D-2*T13*T149*T81-
     #6.023958161049972D-4*T13*T138*T81-1.8297960000000002D-2*T13*T148*
     #T96-9.148980000000001D-3*T138*T172*T96+1.1160511338720001D-4*T13*
     #T138*T82*T96+2.2321022677440003D-4*T13*T138*T79*T192)
      D2FDRATB = T136*T180+T76*((6.77024D-3*GRADA*T85*T35-
     #1.7281573333333333D-2*T12*T35*TA)*T81-1.219864D-2*T35*T98*T81-
     #6.023958161049972D-4*T35*T86*T81-1.8297960000000002D-2*T35*T97*
     #T96-9.148980000000001D-3*T86*T179*T96+1.1160511338720001D-4*T35*
     #T86*T82*T96+2.2321022677440003D-4*T35*T86*T79*T192)
      D2FDRBTB = T158*T180+T76*(-1.646073704678D-1*T34*T83+
     #(-8.640786666666667D-3*T34*T78-1.7281573333333333D-2*T174*TB+
     #4.2314000000000007D-3*T77*T34+6.77024D-3*GRADB*T33)*T81+
     #2.0331066666666667D-2*T34*T82*T81-1.219864D-2*T35*T149*T81-
     #6.023958161049972D-4*T35*T138*T81+3.04966D-2*T34*T79*T96-
     #1.8297960000000002D-2*T35*T148*T96-9.148980000000001D-3*T138*T179*
     #T96+1.1160511338720001D-4*T35*T138*T82*T96+2.2321022677440003D-4*
     #T35*T138*T79*T192)+1.651299866417408D-4*GRADB*T27*T145*T178*T44+
     #1.25D-1*GRADB*T144*T146*T28*T147*T178*T44-3.8863375D-3*GRADB*T27*
     #T28*T178*T143+1.0D+0*T144*T146*T28*T147*RHOB*T31*T176+
     #1.3210398931339262D-3*T27*T24*T31*T176-3.10907D-2*T27*T28*T31*
     #T176-3.8863375D-3*GRADB*T27*T28*T29*T30*T176-3.10907D-2*T27*T28*
     #RHOB*T31*(1.0369622506751999D-1*T34*T43+(-1.0517166666666668D-1*
     #T34*T37-2.1034333333333335D-1*T174*TB+4.724684466666666D-2*GRADB*
     #T33)*T41+3.43392D-2*T34*T42*T41-2.060352D-2*T35*T142*T41+
     #6.409521741309449D-4*T35*T138*T41+5.15088D-2*T34*T38*T139-
     #3.0905279999999996D-2*T35*T141*T139-1.5452639999999998D-2*T138*
     #T175*T139+3.183787772928D-4*T35*T138*T42*T139+6.367575545856D-4*
     #T35*T138*T38*T248)
      D2FDGATA = T76*(-3.235099154284357D-3*T167*T81-
     #9.148980000000001D-3*T12*T172*T96-1.8297960000000002D-2*T13*T161*
     #T96+1.1160511338720001D-4*T167*T82*T96+2.2321022677440003D-4*T167*
     #T79*T192)-3.8863375D-3*T5*T6*T171*T22+3.8863375D-3*T5*T6*T8*T169-
     #3.8863375D-3*GRADA*T5*T6*T171*T160-3.10907D-2*T5*T6*RHOA*T9*
     #(-9.596895678061055D-3*T167*T19-1.5452639999999998D-2*T12*T168*
     #T87-3.0905279999999996D-2*T13*T159*T87+3.183787772928D-4*T167*T20*
     #T87+6.367575545856D-4*T167*T16*T188)
      D2FDGCTA = 0.0D+0
      D2FDGBTA = T76*(-3.235099154284357D-3*T13*T34*T81-
     #1.8297960000000002D-2*T13*T165*T96-9.148980000000001D-3*T34*T172*
     #T96+1.1160511338720001D-4*T13*T34*T82*T96+2.2321022677440003D-4*
     #T13*T34*T79*T192)
      D2FDGATB = T76*(-3.235099154284357D-3*T12*T35*T81-
     #9.148980000000001D-3*T12*T179*T96-1.8297960000000002D-2*T35*T161*
     #T96+1.1160511338720001D-4*T12*T35*T82*T96+2.2321022677440003D-4*
     #T12*T35*T79*T192)
      D2FDGCTB = 0.0D+0
      D2FDGBTB = T76*(-3.235099154284357D-3*T174*T81-
     #9.148980000000001D-3*T34*T179*T96-1.8297960000000002D-2*T35*T165*
     #T96+1.1160511338720001D-4*T174*T82*T96+2.2321022677440003D-4*T174*
     #T79*T192)-3.8863375D-3*T27*T28*T178*T44+3.8863375D-3*T27*T28*T30*
     #T176-3.8863375D-3*GRADB*T27*T28*T178*T164-3.10907D-2*T27*T28*RHOB*
     #T31*(-9.596895678061055D-3*T174*T41-1.5452639999999998D-2*T34*
     #T175*T139-3.0905279999999996D-2*T35*T163*T139+3.183787772928D-4*
     #T174*T42*T139+6.367575545856D-4*T174*T38*T248)
      D2FDTATA = 7.772675D-3*T22*T5*T6*GRADA/TA**3+T76*
     #(7.907017862998005D-3*T249*T81-3.6595920000000004D-2*T13*T172*T96+
     #2.2321022677440003D-4*T249*T82*T96+4.4642045354880006D-4*T249*T79*
     #T192)-3.10907D-2*T5*T6*RHOA*T9*(1.287003827656443D-1*T249*T19-
     #6.181055999999999D-2*T13*T168*T87+6.367575545856D-4*T249*T20*T87+
     #1.2735151091712002D-3*T249*T16*T188)-7.772675D-3*GRADA*T5*T6*T171*
     #T169
      D2FDTATB = T76*(7.907017862998005D-3*T13*T35*T81-
     #1.8297960000000002D-2*T13*T179*T96-1.8297960000000002D-2*T35*T172*
     #T96+2.2321022677440003D-4*T13*T35*T82*T96+4.4642045354880006D-4*
     #T13*T35*T79*T192)
      D2FDTBTB = 7.772675D-3*T27*T28*T44*GRADB/TB**3+T76*
     #(7.907017862998005D-3*T250*T81-3.6595920000000004D-2*T35*T179*T96+
     #2.2321022677440003D-4*T250*T82*T96+4.4642045354880006D-4*T250*T79*
     #T192)-3.10907D-2*T27*T28*RHOB*T31*(1.287003827656443D-1*T250*T41-
     #6.181055999999999D-2*T35*T175*T139+6.367575545856D-4*T250*T42*
     #T139+1.2735151091712002D-3*T250*T38*T248)-7.772675D-3*GRADB*T27*
     #T28*T178*T176
C
C     STORE FUNCTIONAL ENERGY
C
            ECF             = ECF             + SCALE*ENERGY*XYZWGT(IPT)
            EC0(IIPT)       = EC0(IIPT)       + SCALE*ENERGY
C
C     STORE FIRST FUNCTIONAL DERIVATIVE
C
            EC (IIPT,IRA)   = EC (IIPT,IRA)   + SCALE*DFDRA
            EC (IIPT,IRB)   = EC (IIPT,IRB)   + SCALE*DFDRB
            EC (IIPT,IGA)   = EC (IIPT,IGA)   + SCALE*DFDGA
            EC (IIPT,IGB)   = EC (IIPT,IGB)   + SCALE*DFDGB
            EC (IIPT,IGC)   = EC (IIPT,IGC)   + SCALE*DFDGC
            EC (IIPT,ITA)   = EC (IIPT,ITA)   + SCALE*DFDTA
            EC (IIPT,ITB)   = EC (IIPT,ITB)   + SCALE*DFDTB
C
C     STORE SECOND FUNCTIONAL DERIVATIVE
C
            EC (IIPT,IRARA) = EC (IIPT,IRARA) + SCALE*D2FDRARA
            EC (IIPT,IRARB) = EC (IIPT,IRARB) + SCALE*D2FDRARB
            EC (IIPT,IRAGA) = EC (IIPT,IRAGA) + SCALE*D2FDRAGA
            EC (IIPT,IRAGB) = EC (IIPT,IRAGB) + SCALE*D2FDRAGB
            EC (IIPT,IRAGC) = EC (IIPT,IRAGC) + SCALE*D2FDRAGC
            EC (IIPT,IRATA) = EC (IIPT,IRATA) + SCALE*D2FDRATA
            EC (IIPT,IRATB) = EC (IIPT,IRATB) + SCALE*D2FDRATB
            EC (IIPT,IRBRB) = EC (IIPT,IRBRB) + SCALE*D2FDRBRB
            EC (IIPT,IRBGA) = EC (IIPT,IRBGA) + SCALE*D2FDRBGA
            EC (IIPT,IRBGB) = EC (IIPT,IRBGB) + SCALE*D2FDRBGB
            EC (IIPT,IRBGC) = EC (IIPT,IRBGC) + SCALE*D2FDRBGC
            EC (IIPT,IRBTA) = EC (IIPT,IRBTA) + SCALE*D2FDRBTA
            EC (IIPT,IRBTB) = EC (IIPT,IRBTB) + SCALE*D2FDRBTB
            EC (IIPT,IGAGA) = EC (IIPT,IGAGA) + SCALE*D2FDGAGA
            EC (IIPT,IGAGB) = EC (IIPT,IGAGB) + SCALE*D2FDGAGB
            EC (IIPT,IGAGC) = EC (IIPT,IGAGC) + SCALE*D2FDGAGC
            EC (IIPT,IGATA) = EC (IIPT,IGATA) + SCALE*D2FDGATA
            EC (IIPT,IGATB) = EC (IIPT,IGATB) + SCALE*D2FDGATB
            EC (IIPT,IGBGB) = EC (IIPT,IGBGB) + SCALE*D2FDGBGB
            EC (IIPT,IGBGC) = EC (IIPT,IGBGC) + SCALE*D2FDGBGC
            EC (IIPT,IGBTA) = EC (IIPT,IGBTA) + SCALE*D2FDGBTA
            EC (IIPT,IGBTB) = EC (IIPT,IGBTB) + SCALE*D2FDGBTB
            EC (IIPT,IGCGC) = EC (IIPT,IGCGC) + SCALE*D2FDGCGC
            EC (IIPT,IGCTA) = EC (IIPT,IGCTA) + SCALE*D2FDGCTA
            EC (IIPT,IGCTB) = EC (IIPT,IGCTB) + SCALE*D2FDGCTB
            EC (IIPT,ITATA) = EC (IIPT,ITATA) + SCALE*D2FDTATA
            EC (IIPT,ITATB) = EC (IIPT,ITATB) + SCALE*D2FDTATB
            EC (IIPT,ITBTB) = EC (IIPT,ITBTB) + SCALE*D2FDTBTB
C
C     END OF CODE GENERATION
C
        END IF
      END DO
      RETURN
      END
